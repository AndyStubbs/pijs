/**
 * Pi.js - Graphics and Sound Library
 * @version 2.0.0-alpha.1
 * @author Andy Stubbs
 * @license Apache-2.0
 * @preserve
 */
var pi=(()=>{var L=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var $=(e,t)=>{for(var n in t)L(e,n,{get:t[n],enumerable:!0})},J=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Y(t))!G.call(e,o)&&o!==n&&L(e,o,{get:()=>t[o],enumerable:!(r=B(t,o))||r.enumerable});return e};var Q=e=>J(L({},"__esModule",{value:!0}),e);var ve={};$(ve,{default:()=>Me,pi:()=>g});var i={nextScreenId:0,screens:{},activeScreen:null,images:{},imageCount:0,defaultPrompt:"\xDB",defaultFont:{},nextFontId:0,fonts:{},defaultPalette:[],defaultColor:7,commands:{},screenCommands:{},defaultPenDraw:null,pens:{},penList:[],blendCommands:{},blendCommandsList:[],defaultBlendCmd:null,settings:{},settingsList:[],volume:.75,isTouchScreen:!1,defaultInputFocus:typeof window<"u"?window:null},y=[];var b={};$(b,{binarySearch:()=>Ce,cToHex:()=>I,canAddEventListeners:()=>X,checkColor:()=>ne,clamp:()=>V,colorStringToColor:()=>N,colorStringToHex:()=>Z,compareColors:()=>re,convertToArray:()=>me,convertToColor:()=>te,copyProperties:()=>pe,dataToHex:()=>ae,degreesToRadian:()=>ue,deleteProperties:()=>ge,getInt:()=>xe,getWindowSize:()=>he,hexToColor:()=>_,hexToData:()=>oe,inRange:()=>se,inRange2:()=>ie,isArray:()=>S,isDomElement:()=>O,isFunction:()=>A,isInteger:()=>m,math:()=>Ie,pad:()=>ce,padL:()=>k,padR:()=>de,queueMicrotask:()=>Pe,radiansToDegrees:()=>fe,rgbToColor:()=>P,rgbToHex:()=>H,rndRange:()=>le});var A=e=>typeof e=="function",O=e=>e instanceof Element,S=Array.isArray,m=Number.isInteger,X=e=>typeof e.addEventListener=="function"&&typeof e.removeEventListener=="function";function _(e){let t,n,r,o,s;return s=e,e.length===4?(t=parseInt(e.slice(1,2),16)*16-1,n=parseInt(e.slice(2,3),16)*16-1,r=parseInt(e.slice(3,4),16)*16-1):(t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16)),e.length===9?(s=e.slice(0,7),o=parseInt(e.slice(7,9),16)):o=255,{r:t,g:n,b:r,a:o,s:`rgba(${t},${n},${r},${Math.round(o/255*1e3)/1e3})`,s2:s}}function I(e){m(e)||(e=Math.round(e)),e=V(e,0,255);let t=Number(e).toString(16);return t.length<2?"0"+t:t.toUpperCase()}function H(e,t,n,r){return isNaN(r)&&(r=255),"#"+I(e)+I(t)+I(n)+I(r)}function P(e,t,n,r){return _(H(e,t,n,r))}function N(e){let n=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});n.fillStyle=e,n.fillRect(0,0,1,1);let r=n.getImageData(0,0,1,1).data;return P(r[0],r[1],r[2],r[3])}function Z(e){return N(e).s2}function ee(e){e=e.slice(e.indexOf("(")+1,e.indexOf(")"));let t=e.split(","),n=[];for(let r=0;r<t.length;r++){let o;r===3?o=parseFloat(t[r].trim())*255:o=parseInt(t[r].trim()),n.push(o)}return n}function te(e){if(e===void 0)return null;if(S(e)&&e.length>2)return P(e[0],e[1],e[2],e[3]);if(m(e?.r)&&m(e?.g)&&m(e?.b))return P(e.r,e.g,e.b,e.a);if(typeof e!="string")return null;if(/(^#[0-9A-F]{8}$)|(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e))return _(e);if(e.indexOf("rgb")===0){let n=ee(e);return n.length<3?null:P(n[0],n[1],n[2],n[3])}return N(e)}function ne(e){let t=new Option().style;return t.color=e,t.color!==""}function re(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function oe(e,t,n){e=e.toUpperCase();let r=[],o=0,s="",d=0;for(let h=0;h<n;h++){r.push([]);for(let C=0;C<t;C++){if(d>=s.length){let x=parseInt(e[o],16);isNaN(x)&&(x=0),s=k(x.toString(2),4,"0"),o+=1,d=0}r[h].push(parseInt(s[d])),d+=1}}return r}function ae(e){let t="",n="";for(let r=0;r<e.length;r++)for(let o=0;o<e[r].length;o++)n+=e[r][o],n.length===4&&(t+=parseInt(n,2).toString(16),n="");return t}function V(e,t,n){return Math.min(Math.max(e,t),n)}function se(e,t){return e.x>=t.x&&e.x<t.x+t.width&&e.y>=t.y&&e.y<t.y+t.height}function ie(e,t,n,r,o,s){return e>=n&&e<n+o&&t>=r&&t<r+s}function le(e,t){return Math.random()*(t-e)+e}function ue(e){return e*(Math.PI/180)}function fe(e){return e*(180/Math.PI)}function k(e,t,n){typeof n!="string"&&(n=" ");let r="";e=e+"";for(let o=e.length;o<t;o++)r+=n;return r+e}function de(e,t,n){typeof n!="string"&&(n=" "),e=e+"";for(let r=e.length;r<t;r++)e+=n;return e}function ce(e,t,n){for((typeof n!="string"||n.length===0)&&(n=" "),e=e+"";e.length<t;)e=n+e+n;return e.length>t&&(e=e.substr(0,t)),e}function pe(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function me(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function ge(e){for(let t in e)e.hasOwnProperty(t)&&delete e[t]}function he(){let e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:e,height:t}}function Ce(e,t,n){let r=0,o=e.length-1;for(;r<=o;){let s=o+r>>1,d=n(t,e[s],s);if(d>0)r=s+1;else if(d<0)o=s-1;else return s}return-r-1}function xe(e,t){return e=parseInt(e),isNaN(e)&&(e=t),e}var Ie=Object.freeze({deg30:Math.PI/6,deg45:Math.PI/4,deg60:Math.PI/3,deg90:Math.PI/2,deg120:2*Math.PI/3,deg135:3*Math.PI/4,deg150:5*Math.PI/6,deg180:Math.PI,deg210:7*Math.PI/6,deg225:5*Math.PI/4,deg240:4*Math.PI/3,deg270:3*Math.PI/2,deg300:5*Math.PI/3,deg315:7*Math.PI/4,deg330:11*Math.PI/6,deg360:Math.PI*2}),Pe=window.queueMicrotask||(e=>setTimeout(e,0));function E(e,t,n,r,o,s){i.commands[e]=t,n||y.push({name:e,fn:t,isScreen:r,parameters:o||[],isSet:s,noParse:s})}function W(e,t,n,r){E(e,function(o,s){o.pixelMode?t(o,s):n(o,s)},!1,!0,r)}function j(e,t,n,r){i.settings[e]={name:e,fn:t,isScreen:n,parameters:r||[]},i.settingsList.push(e)}function w(e,t){if(e.noParse)return t;if(t.length>0&&typeof t[0]=="object"&&t[0]!==null&&!t[0].hasOwnProperty("screen")&&!S(t[0])&&!O(t[0])){let n=t[0],r=[],o=!1;for(let s=0;s<e.parameters.length;s++)n.hasOwnProperty(e.parameters[s])?(r.push(n[e.parameters[s]]),o=!0):r.push(null);if(o)return r}return t}function U(e,t,n){i.penList.push(e),i.pens[e]={cmd:t,cap:n}}function q(e,t){i.blendCommandsList.push(e),i.blendCommands[e]=t}function z(e){y.sort((t,n)=>{let r=t.name.toUpperCase(),o=n.name.toUpperCase();return r<o?-1:r>o?1:0});for(let t of y)we(e,t)}function we(e,t){if(t.isSet){i.screenCommands[t.name]=t,e[t.name]=function(...n){let r=w(t,n);return i.commands[t.name](null,r)};return}t.isScreen?(i.screenCommands[t.name]=t,e[t.name]=function(...n){let r=w(t,n),o=T(void 0,t.name);if(o!==!1)return i.commands[t.name](o,r)}):e[t.name]=function(...n){let r=w(t,n);return i.commands[t.name](r)}}function T(e,t){if(i.activeScreen===null){if(t==="set")return!1;let n=new Error(`${t}: No screens available for command.`);throw n.code="NO_SCREEN",n}if(e==null&&(e=i.activeScreen.id),m(e)&&!i.screens[e]){let n=new Error(`${t}: Invalid screen id.`);throw n.code="INVALID_SCREEN_ID",n}return i.screens[e]}function K(e){let t=e._.data;e._.addCommand("setScreen",n,!1,!1,["screen"]),e._.addSetting("screen",n,!1,["screen"]);function n(l){let a=l[0],u;if(e.util.isInteger(a)?u=a:a&&e.util.isInteger(a.id)&&(u=a.id),!t.screens[u]){let f=new Error("screen: Invalid screen.");throw f.code="INVALID_SCREEN",f}t.activeScreen=t.screens[u]}e._.addCommand("removeAllScreens",r,!1,!1,[]);function r(){for(let l in t.screens)t.screens[l].screenObj.removeScreen();t.nextScreenId=0}e._.addCommand("getScreen",o,!1,!1,["screenId"]);function o(l){let a=l[0];return T(a,"getScreen").screenObj}e._.addCommand("setDefaultColor",s,!1,!1,["color"]),e._.addSetting("defaultColor",s,!1,["color"]);function s(l){let a=l[0];if(!isNaN(Number(a))&&t.defaultPalette.length>a)t.defaultColor=a;else{if(a=e.util.convertToColor(a),a===null){let u=new TypeError("setDefaultColor: invalid color value for parameter color.");throw u.code="INVALID_COLOR",u}t.defaultColor=a}}e._.addCommand("setDefaultPal",d,!1,!1,["pal"]),e._.addSetting("defaultPal",d,!1,["pal"]);function d(l){let a=l[0];if(!e.util.isArray(a)){let f=new TypeError("setDefaultPal: parameter pal is not an array.");throw f.code="INVALID_PARAMETER",f}if(a.length<1){let f=new RangeError("setDefaultPal: parameter pal must have at least one color value.");throw f.code="EMPTY_PALETTE",f}t.defaultPalette=[],a.length>1?t.defaultColor=1:t.defaultColor=0;for(let f=0;f<a.length;f++){let c=e.util.convertToColor(a[f]);c===null?(console.warn("setDefaultPal: invalid color value inside array pal."),t.defaultPalette.push(e.util.convertToColor("#000000"))):t.defaultPalette.push(c)}let u=t.defaultPalette[0];t.defaultPalette[0]=e.util.convertToColor([u.r,u.g,u.b,0])}e._.addCommand("getDefaultPal",h,!1,!1,[]);function h(){let l=[];for(let a of t.defaultPalette)l.push(a);return l}e._.addCommand("setDefaultInputFocus",C,!1,!1,["element"]),e._.addSetting("defaultInputFocus",C,!1,["element"]);function C(l){let a=l[0];if(typeof a=="string"&&(a=document.getElementById(a)),!a||!e.util.canAddEventListeners(a)){let u=new TypeError("setDefaultInputFocus: Invalid argument element. Element must be a DOM element or string id of a DOM element.");throw u.code="INVALID_ELEMENT",u}a.tabIndex>=0||(a.tabIndex=0),t.defaultInputFocus=a,t.commands.reinitKeyboard&&t.commands.reinitKeyboard()}e._.addCommand("set",x,!1,!0,t.settingsList,!0);function x(l,a){let u=a[0];for(let f in u)if(t.settings[f]){let c=t.settings[f],p=u[f];!e.util.isArray(p)&&typeof p=="object"?p=e._.parseOptions(c,[p]):p=[p],c.isScreen?(l||(l=T(void 0,`set ${c.name}`)),c.fn(l,p)):c.fn(p)}}}var be="2.0.0-alpha.1",D=0,R=!1,M=[],v=0;function Ee(){D++,R=!0}function Te(){D--,D===0&&F()}function F(){if(document.readyState!=="loading"&&D===0){R=!1;let e=M.slice();M.length=0;for(let t of e)t()}else clearTimeout(v),v=setTimeout(F,10)}var g={version:be,_:{data:i,addCommand:E,addCommands:W,addSetting:j,addPen:U,addBlendCommand:q,parseOptions:w,wait:Ee,resume:Te},util:b};E("ready",De,!1,!1,["fn"]);function De(e){let t=e[0];A(t)&&(R?M.push(t):document.readyState==="loading"?(M.push(t),clearTimeout(v),v=setTimeout(F,10)):t())}K(g);z(g);typeof window<"u"&&(window.pi=g,window.$===void 0&&(window.$=g));var Me=g;return Q(ve);})();
/**
 * Pi.js - Main Entry Point
 * 
 * Graphics and sound library for retro-style games and demos.
 * Modernized architecture with legacy API compatibility.
 * 
 * @module pi.js
 * @author Andy Stubbs
 * @license Apache-2.0
 */
//# sourceMappingURL=pi.min.js.map
