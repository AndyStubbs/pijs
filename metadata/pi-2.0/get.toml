title = "get"
category = "pixels"
isScreen = true
isBlocking = true
summary = "Reads a region of pixels as indices (default) or color values."
description = """
Returns a 2D array [height][width] for the region. By default returns palette indices. Set
asIndex=false to return color value objects. Tolerance controls color-to-index matching. If a color
that doesn't match is not found the index 0 for black/transparent will be set.

Note: if asIndex is set to false then the 2D array cannot be used with the put command.
"""
example = """
$.screen( "300x200" );
$.circle( 150, 110, 50, 4 );

// Get indices
const indices = $.get( 105, 85, 5, 5 );
$.print( "indices = [" );
for( let i = 0; i < indices.length; i++ ) {
	$.print( "    [ " + indices[ i ].join( ", " ) + " ]," );
}
$.print( "]" );

// Get color values
const colorNames = {
	"rgba(0, 0, 0, 0)": "black",
	"rgba(170, 170, 170, 255)": "gray",
	"rgba(170, 0, 0, 255)": "red",
};
const mapColors = c => colorNames[ `rgba(${c.array.join( ", " )})` ];
const colors = $.get( 105, 85, 5, 5, 1, false );
$.setPos( 0, 15 );
$.print( "colors = [" );
for( let i = 0; i < colors.length; i++ ) {
	$.print( "    [ " +
		colors[ i ].map( mapColors ).join( ", " ) + " ],"
	);
}
$.print( "]" );
$.put( indices, 20, 80 );
"""

[[parameters]]
name = "x"
type = "number"
description = "Left coordinate."

[[parameters]]
name = "y"
type = "number"
description = "Top coordinate."

[[parameters]]
name = "width"
type = "number"
description = "Region width."

[[parameters]]
name = "height"
type = "number"
description = "Region height."

[[parameters]]
name = "tolerance"
type = "number"
description = "Color matching tolerance [0.0-1.0] for index conversion (default 1)."
optional = true

[[parameters]]
name = "asIndex"
type = "boolean"
description = "If false (default true), return color value objects instead of indices."
optional = true

[[returns]]
type = "Array<Array<number | PiColor>>"
typeDesc = "*Array"
description = "2D array [height][width] of palette indices (default) or color values."

