/**
 * Pi.js - Graphics and Sound Library
 * @version 2.0.0-alpha.0
 * @author Andy Stubbs
 * @license Apache-2.0
 * @preserve
 */
"use strict";var ie=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var nt=Object.prototype.hasOwnProperty;var f=(t,c)=>ie(t,"name",{value:c,configurable:!0});var xe=(t,c)=>{for(var E in c)ie(t,E,{get:c[E],enumerable:!0})},rt=(t,c,E,C)=>{if(c&&typeof c=="object"||typeof c=="function")for(let b of ot(c))!nt.call(t,b)&&b!==E&&ie(t,b,{get:()=>c[b],enumerable:!(C=tt(c,b))||C.enumerable});return t};var it=t=>rt(ie({},"__esModule",{value:!0}),t);var eo={};xe(eo,{default:()=>Dt,pi:()=>G});module.exports=it(eo);var be=["#000000","#0000AA","#00AA00","#00AAAA","#AA0000","#AA00AA","#AA5500","#AAAAAA","#555555","#5555FF","#55FF55","#55FFFF","#FF5555","#FF55FF","#FFFF55","#FFFFFF","#000000","#141414","#202020","#2D2D2D","#393939","#454545","#515151","#616161","#717171","#828282","#929292","#A2A2A2","#B6B6B6","#CACACA","#E3E3E3","#FFFFFF","#0000FF","#4100FF","#7D00FF","#BE00FF","#FF00FF","#FF00BE","#FF007D","#FF0041","#FF0000","#FF4100","#FF7D00","#FFBE00","#FFFF00","#BEFF00","#7DFF00","#41FF00","#00FF00","#00FF41","#00FF7D","#00FFBE","#00FFFF","#00BEFF","#007DFF","#0041FF","#7D7DFF","#9E7DFF","#BE7DFF","#DF7DFF","#FF7DFF","#FF7DDF","#FF7DBE","#FF7D9E","#FF7D7D","#FF9E7D","#FFBE7D","#FFDF7D","#FFFF7D","#DFFF7D","#BEFF7D","#9EFF7D","#7DFF7D","#7DFF9E","#7DFFBE","#7DFFDF","#7DFFFF","#7DDFFF","#7DBEFF","#7D9EFF","#B6B6FF","#C6B6FF","#DBB6FF","#EBB6FF","#FFB6FF","#FFB6EB","#FFB6DB","#FFB6C6","#FFB6B6","#FFC6B6","#FFDBB6","#FFEBB6","#FFFFB6","#EBFFB6","#DBFFB6","#C6FFB6","#B6FFB6","#B6FFC6","#B6FFDB","#B6FFEB","#B6FFFF","#B6EBFF","#B6DBFF","#B6C6FF","#000071","#1C0071","#390071","#550071","#710071","#710055","#710039","#71001C","#710000","#711C00","#713900","#715500","#717100","#557100","#397100","#1C7100","#007100","#00711C","#007139","#007155","#007171","#005571","#003971","#001C71","#393971","#453971","#553971","#613971","#713971","#713961","#713955","#713945","#713939","#714539","#715539","#716139","#717139","#617139","#557139","#457139","#397139","#397145","#397155","#397161","#397171","#396171","#395571","#394571","#515171","#595171","#615171","#695171","#715171","#715169","#715161","#715159","#715151","#715951","#716151","#716951","#717151","#697151","#617151","#597151","#517151","#517159","#517161","#517169","#517171","#516971","#516171","#515971","#000041","#100041","#200041","#310041","#410041","#410031","#410020","#410010","#410000","#411000","#412000","#413100","#414100","#314100","#204100","#104100","#004100","#004110","#004120","#004131","#004141","#003141","#002041","#001041","#202041","#282041","#312041","#392041","#412041","#412039","#412031","#412028","#412020","#412820","#413120","#413920","#414120","#394120","#314120","#284120","#204120","#204128","#204131","#204139","#204141","#203941","#203141","#202841","#2D2D41","#312D41","#352D41","#3D2D41","#412D41","#412D3D","#412D35","#412D31","#412D2D","#41312D","#41352D","#413D2D","#41412D","#3D412D","#35412D","#31412D","#2D412D","#2D4131","#2D4135","#2D413D","#2D4141","#2D3D41","#2D3541","#2D3141","#000000","#000000","#000000","#000000","#000000","#000000","#000000"],U={nextScreenId:0,screens:{},activeScreen:null,images:{},imageCount:0,defaultPrompt:"\xDB",defaultFont:{},nextFontId:0,fonts:{},defaultPalette:[],defaultColor:7,commands:{},screenCommands:{},defaultPenDraw:null,pens:{},penList:[],blendCommands:{},blendCommandsList:[],defaultBlendCmd:null,settings:{},settingsList:[],volume:.75,isTouchScreen:!1,defaultInputFocus:typeof window<"u"?window:null},se=[];var le={};xe(le,{binarySearch:()=>At,cToHex:()=>te,canAddEventListeners:()=>st,checkColor:()=>ut,clamp:()=>Ne,colorStringToColor:()=>Ce,colorStringToHex:()=>ct,compareColors:()=>at,convertToArray:()=>Et,convertToColor:()=>dt,copyProperties:()=>It,dataToHex:()=>gt,degreesToRadian:()=>pt,deleteProperties:()=>xt,getInt:()=>Nt,getWindowSize:()=>bt,hexToColor:()=>ye,hexToData:()=>ft,inRange:()=>mt,inRange2:()=>ht,isArray:()=>ce,isDomElement:()=>we,isFunction:()=>pe,isInteger:()=>ee,math:()=>_t,pad:()=>Ct,padL:()=>_e,padR:()=>yt,queueMicrotask:()=>jt,radiansToDegrees:()=>wt,rgbToColor:()=>oe,rgbToHex:()=>Ae,rndRange:()=>vt});var pe=f(t=>typeof t=="function","isFunction"),we=f(t=>t instanceof Element,"isDomElement"),ce=Array.isArray,ee=Number.isInteger,st=f(t=>typeof t.addEventListener=="function"&&typeof t.removeEventListener=="function","canAddEventListeners");function ye(t){let c,E,C,b,T;return T=t,t.length===4?(c=parseInt(t.slice(1,2),16)*16-1,E=parseInt(t.slice(2,3),16)*16-1,C=parseInt(t.slice(3,4),16)*16-1):(c=parseInt(t.slice(1,3),16),E=parseInt(t.slice(3,5),16),C=parseInt(t.slice(5,7),16)),t.length===9?(T=t.slice(0,7),b=parseInt(t.slice(7,9),16)):b=255,{r:c,g:E,b:C,a:b,s:`rgba(${c},${E},${C},${Math.round(b/255*1e3)/1e3})`,s2:T}}f(ye,"hexToColor");function te(t){ee(t)||(t=Math.round(t)),t=Ne(t,0,255);let c=Number(t).toString(16);return c.length<2?"0"+c:c.toUpperCase()}f(te,"cToHex");function Ae(t,c,E,C){return isNaN(C)&&(C=255),"#"+te(t)+te(c)+te(E)+te(C)}f(Ae,"rgbToHex");function oe(t,c,E,C){return ye(Ae(t,c,E,C))}f(oe,"rgbToColor");function Ce(t){let E=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});E.fillStyle=t,E.fillRect(0,0,1,1);let C=E.getImageData(0,0,1,1).data;return oe(C[0],C[1],C[2],C[3])}f(Ce,"colorStringToColor");function ct(t){return Ce(t).s2}f(ct,"colorStringToHex");function lt(t){t=t.slice(t.indexOf("(")+1,t.indexOf(")"));let c=t.split(","),E=[];for(let C=0;C<c.length;C++){let b;C===3?b=parseFloat(c[C].trim())*255:b=parseInt(c[C].trim()),E.push(b)}return E}f(lt,"splitRgb");function dt(t){if(t===void 0)return null;if(ce(t)&&t.length>2)return oe(t[0],t[1],t[2],t[3]);if(ee(t?.r)&&ee(t?.g)&&ee(t?.b))return oe(t.r,t.g,t.b,t.a);if(typeof t!="string")return null;if(/(^#[0-9A-F]{8}$)|(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t))return ye(t);if(t.indexOf("rgb")===0){let E=lt(t);return E.length<3?null:oe(E[0],E[1],E[2],E[3])}return Ce(t)}f(dt,"convertToColor");function ut(t){let c=new Option().style;return c.color=t,c.color!==""}f(ut,"checkColor");function at(t,c){return t.r===c.r&&t.g===c.g&&t.b===c.b&&t.a===c.a}f(at,"compareColors");function ft(t,c,E){t=t.toUpperCase();let C=[],b=0,T="",M=0;for(let j=0;j<E;j++){C.push([]);for(let S=0;S<c;S++){if(M>=T.length){let P=parseInt(t[b],16);isNaN(P)&&(P=0),T=_e(P.toString(2),4,"0"),b+=1,M=0}C[j].push(parseInt(T[M])),M+=1}}return C}f(ft,"hexToData");function gt(t){let c="",E="";for(let C=0;C<t.length;C++)for(let b=0;b<t[C].length;b++)E+=t[C][b],E.length===4&&(c+=parseInt(E,2).toString(16),E="");return c}f(gt,"dataToHex");function Ne(t,c,E){return Math.min(Math.max(t,c),E)}f(Ne,"clamp");function mt(t,c){return t.x>=c.x&&t.x<c.x+c.width&&t.y>=c.y&&t.y<c.y+c.height}f(mt,"inRange");function ht(t,c,E,C,b,T){return t>=E&&t<E+b&&c>=C&&c<C+T}f(ht,"inRange2");function vt(t,c){return Math.random()*(c-t)+t}f(vt,"rndRange");function pt(t){return t*(Math.PI/180)}f(pt,"degreesToRadian");function wt(t){return t*(180/Math.PI)}f(wt,"radiansToDegrees");function _e(t,c,E){typeof E!="string"&&(E=" ");let C="";t=t+"";for(let b=t.length;b<c;b++)C+=E;return C+t}f(_e,"padL");function yt(t,c,E){typeof E!="string"&&(E=" "),t=t+"";for(let C=t.length;C<c;C++)t+=E;return t}f(yt,"padR");function Ct(t,c,E){for((typeof E!="string"||E.length===0)&&(E=" "),t=t+"";t.length<c;)t=E+t+E;return t.length>c&&(t=t.substr(0,c)),t}f(Ct,"pad");function It(t,c){for(let E in c)c.hasOwnProperty(E)&&(t[E]=c[E])}f(It,"copyProperties");function Et(t){let c=[];for(let E in t)t.hasOwnProperty(E)&&c.push(t[E]);return c}f(Et,"convertToArray");function xt(t){for(let c in t)t.hasOwnProperty(c)&&delete t[c]}f(xt,"deleteProperties");function bt(){let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:t,height:c}}f(bt,"getWindowSize");function At(t,c,E){let C=0,b=t.length-1;for(;C<=b;){let T=b+C>>1,M=E(c,t[T],T);if(M>0)C=T+1;else if(M<0)b=T-1;else return T}return-C-1}f(At,"binarySearch");function Nt(t,c){return t=parseInt(t),isNaN(t)&&(t=c),t}f(Nt,"getInt");var _t=Object.freeze({deg30:Math.PI/6,deg45:Math.PI/4,deg60:Math.PI/3,deg90:Math.PI/2,deg120:2*Math.PI/3,deg135:3*Math.PI/4,deg150:5*Math.PI/6,deg180:Math.PI,deg210:7*Math.PI/6,deg225:5*Math.PI/4,deg240:4*Math.PI/3,deg270:3*Math.PI/2,deg300:5*Math.PI/3,deg315:7*Math.PI/4,deg330:11*Math.PI/6,deg360:Math.PI*2}),jt=f(t=>{window.queueMicrotask?window.queueMicrotask(t):setTimeout(t,0)},"queueMicrotask");function de(t,c,E,C,b,T){U.commands[t]=c,E||se.push({name:t,fn:c,isScreen:C,parameters:b||[],isSet:T,noParse:T})}f(de,"addCommand");function je(t,c,E,C){de(t,function(b,T){b.pixelMode?c(b,T):E(b,T)},!1,!0,C)}f(je,"addCommands");function Le(t,c,E,C){U.settings[t]={name:t,fn:c,isScreen:E,parameters:C||[]},U.settingsList.push(t)}f(Le,"addSetting");function ne(t,c){if(t.noParse)return c;if(c.length>0&&typeof c[0]=="object"&&c[0]!==null&&!c[0].hasOwnProperty("screen")&&!ce(c[0])&&!we(c[0])){let E=c[0],C=[],b=!1;for(let T=0;T<t.parameters.length;T++)E.hasOwnProperty(t.parameters[T])?(C.push(E[t.parameters[T]]),b=!0):C.push(null);if(b)return C}return c}f(ne,"parseOptions");function Te(t,c,E){U.penList.push(t),U.pens[t]={cmd:c,cap:E}}f(Te,"addPen");function ke(t,c){U.blendCommandsList.push(t),U.blendCommands[t]=c}f(ke,"addBlendCommand");function Fe(t){se.sort((c,E)=>{let C=c.name.toUpperCase(),b=E.name.toUpperCase();return C<b?-1:C>b?1:0});for(let c of se)Lt(t,c)}f(Fe,"processCommands");function Lt(t,c){if(c.isSet){U.screenCommands[c.name]=c,t[c.name]=function(...E){let C=ne(c,E);return U.commands[c.name](null,C)};return}c.isScreen?(U.screenCommands[c.name]=c,t[c.name]=function(...E){let C=ne(c,E),b=ue(void 0,c.name);if(b!==!1)return U.commands[c.name](b,C)}):t[c.name]=function(...E){let C=ne(c,E);return U.commands[c.name](C)}}f(Lt,"processCommand");function ue(t,c){if(U.activeScreen===null){if(c==="set")return!1;let E=new Error(`${c}: No screens available for command.`);throw E.code="NO_SCREEN",E}if(t==null&&(t=U.activeScreen.id),ee(t)&&!U.screens[t]){let E=new Error(`${c}: Invalid screen id.`);throw E.code="INVALID_SCREEN_ID",E}return U.screens[t]}f(ue,"getScreenData");function Me(t){let c=t._.data;t._.addCommand("setScreen",E,!1,!1,["screen"]),t._.addSetting("screen",E,!1,["screen"]);function E(A){let h=A[0],I;if(t.util.isInteger(h)?I=h:h&&t.util.isInteger(h.id)&&(I=h.id),!c.screens[I]){let v=new Error("screen: Invalid screen.");throw v.code="INVALID_SCREEN",v}c.activeScreen=c.screens[I]}f(E,"setScreen"),t._.addCommand("removeAllScreens",C,!1,!1,[]);function C(){for(let A in c.screens)c.screens[A].screenObj.removeScreen();c.nextScreenId=0}f(C,"removeAllScreens"),t._.addCommand("getScreen",b,!1,!1,["screenId"]);function b(A){let h=A[0];return ue(h,"getScreen").screenObj}f(b,"getScreen"),t._.addCommand("setDefaultColor",T,!1,!1,["color"]),t._.addSetting("defaultColor",T,!1,["color"]);function T(A){let h=A[0];if(!isNaN(Number(h))&&c.defaultPalette.length>h)c.defaultColor=h;else{if(h=t.util.convertToColor(h),h===null){let I=new TypeError("setDefaultColor: invalid color value for parameter color.");throw I.code="INVALID_COLOR",I}c.defaultColor=h}}f(T,"setDefaultColor"),t._.addCommand("setDefaultPal",M,!1,!1,["pal"]),t._.addSetting("defaultPal",M,!1,["pal"]);function M(A){let h=A[0];if(!t.util.isArray(h)){let v=new TypeError("setDefaultPal: parameter pal is not an array.");throw v.code="INVALID_PARAMETER",v}if(h.length<1){let v=new RangeError("setDefaultPal: parameter pal must have at least one color value.");throw v.code="EMPTY_PALETTE",v}c.defaultPalette=[],h.length>1?c.defaultColor=1:c.defaultColor=0;for(let v=0;v<h.length;v++){let g=t.util.convertToColor(h[v]);g===null?(console.warn("setDefaultPal: invalid color value inside array pal."),c.defaultPalette.push(t.util.convertToColor("#000000"))):c.defaultPalette.push(g)}let I=c.defaultPalette[0];c.defaultPalette[0]=t.util.convertToColor([I.r,I.g,I.b,0])}f(M,"setDefaultPal"),t._.addCommand("getDefaultPal",j,!1,!1,[]);function j(){let A=[];for(let h of c.defaultPalette)A.push(h);return A}f(j,"getDefaultPal"),t._.addCommand("setDefaultInputFocus",S,!1,!1,["element"]),t._.addSetting("defaultInputFocus",S,!1,["element"]);function S(A){let h=A[0];if(typeof h=="string"&&(h=document.getElementById(h)),!h||!t.util.canAddEventListeners(h)){let I=new TypeError("setDefaultInputFocus: Invalid argument element. Element must be a DOM element or string id of a DOM element.");throw I.code="INVALID_ELEMENT",I}h.tabIndex>=0||(h.tabIndex=0),c.defaultInputFocus=h,c.commands.reinitKeyboard&&c.commands.reinitKeyboard()}f(S,"setDefaultInputFocus"),t._.addCommand("set",P,!1,!0,c.settingsList,!0);function P(A,h){let I=h[0];for(let v in I)if(c.settings[v]){let g=c.settings[v],o=I[v];!t.util.isArray(o)&&typeof o=="object"?o=t._.parseOptions(g,[o]):o=[o],g.isScreen?(A||(A=ue(void 0,`set ${g.name}`)),g.fn(A,o)):g.fn(o)}}f(P,"set")}f(Me,"init");function Se(t){let c=t._.data;t._.addBlendCommand("normal",E);function E(s,r,i,e){let n=s.imageData.data,d=(s.width*i+r)*4;n[d]=e.r,n[d+1]=e.g,n[d+2]=e.b,n[d+3]=e.a}f(E,"normalBlend"),t._.addBlendCommand("blend",C);function C(s,r,i,e){let n=s.imageData.data,d=(s.width*i+r)*4,u=e.a/255,a=(255-e.a)/255;n[d]=e.r*u+n[d]*a,n[d+1]=e.g*u+n[d+1]*a,n[d+2]=e.b*u+n[d+2]*a,n[d+3]=e.a+n[d+3]*a}f(C,"blendPixel"),t._.addCommand("getImageData",b,!0,!1);function b(s){(s.dirty===!1||s.imageData===null)&&(s.imageData=s.context.getImageData(0,0,s.width,s.height))}f(b,"getImageData"),t._.addCommand("resetImageData",T,!0,!1);function T(s){s.imageData=null}f(T,"resetImageData"),t._.addCommand("setImageDirty",M,!0,!1);function M(s){s.dirty===!1&&(s.dirty=!0,s.isAutoRender&&!s.autoRenderMicrotaskScheduled&&(s.autoRenderMicrotaskScheduled=!0,t.util.queueMicrotask(function(){s.screenObj&&s.isAutoRender&&s.screenObj.render(),s.autoRenderMicrotaskScheduled=!1})))}f(M,"setImageDirty"),t._.addCommand("setPixel",j,!0,!1);function j(s,r,i,e){s.blendPixelCmd(s,r,i,e)}f(j,"setPixel"),t._.addCommand("setPixelSafe",S,!0,!1),t._.addPen("pixel",S,"square");function S(s,r,i,e){r<0||r>=s.width||i<0||i>=s.height||(c.commands.getImageData(s),e=P(s,e),s.blendPixelCmd(s,r,i,e),c.commands.setImageDirty(s))}f(S,"setPixelSafe"),t._.addCommand("getPixelColor",P,!0,!1);function P(s,r){let i=s.pen.noise;if(!i)return r;let e={r:r.r,g:r.g,b:r.b,a:r.a},n=i/2;if(t.util.isArray(i))e.r=t.util.clamp(Math.round(e.r+t.util.rndRange(-i[0],i[0])),0,255),e.g=t.util.clamp(Math.round(e.g+t.util.rndRange(-i[1],i[1])),0,255),e.b=t.util.clamp(Math.round(e.b+t.util.rndRange(-i[2],i[2])),0,255),e.a=t.util.clamp(e.a+t.util.rndRange(-i[3],i[3]),0,255);else{let d=Math.round(Math.random()*i-n);e.r=t.util.clamp(e.r+d,0,255),e.g=t.util.clamp(e.g+d,0,255),e.b=t.util.clamp(e.b+d,0,255)}return e}f(P,"getPixelColor"),t._.addCommand("drawSquarePen",A,!0,!1),t._.addPen("square",A,"square");function A(s,r,i,e){let n=s.pen.size*2-1,d=Math.round(n/2)-1;for(let u=0;u<n;u++)for(let a=0;a<n;a++)c.commands.setPixelSafe(s,a+r-d,u+i-d,e);c.commands.setImageDirty(s)}f(A,"drawSquarePen"),t._.addCommand("drawCirclePen",h,!0,!1),t._.addPen("circle",h,"round");function h(s,r,i,e){if(s.pen.size===2){c.commands.setPixelSafe(s,r,i,e),c.commands.setPixelSafe(s,r+1,i,e),c.commands.setPixelSafe(s,r-1,i,e),c.commands.setPixelSafe(s,r,i+1,e),c.commands.setPixelSafe(s,r,i-1,e),c.commands.setImageDirty(s);return}let n=s.pen.size*2,d=s.pen.size,u=d-1;for(let a=0;a<n;a++)for(let m=0;m<n;m++){let l=m-u,p=a-u;Math.round(Math.sqrt(l*l+p*p))<d&&c.commands.setPixelSafe(s,l+r,p+i,e)}c.commands.setImageDirty(s)}f(h,"drawCirclePen"),t._.addCommand("getPixelInternal",I,!0,!1);function I(s,r,i){let e=s.imageData.data,n=(s.width*i+r)*4;return{r:e[n],g:e[n+1],b:e[n+2],a:e[n+3]}}f(I,"getPixelInternal"),t._.addCommand("getPixelSafe",v,!0,!1);function v(s,r,i){return c.commands.getImageData(s),I(s,r,i)}f(v,"getPixelSafe"),t._.addCommand("findColorValue",g,!0,!1);function g(s,r,i){let e;if(t.util.isInteger(r)){if(r>s.pal.length){let n=new RangeError(`${i}: parameter color is not a color in the palette.`);throw n.code="COLOR_OUT_OF_RANGE",n}e=s.pal[r]}else if(e=t.util.convertToColor(r),e===null){let n=new TypeError(`${i}: parameter color is not a valid color format.`);throw n.code="INVALID_COLOR",n}return e}f(g,"findColorValue"),t._.addCommand("put",o,!1,!0,["data","x","y","includeZero"]);function o(s,r){let i=r[0],e=Math.round(r[1]),n=Math.round(r[2]),d=!!r[3];if(!i||i.length<1)return;if(isNaN(e)||isNaN(n)){let p=new TypeError("put: parameters x and y must be integers.");throw p.code="INVALID_COORDINATES",p}let u;e<0?u=e*-1:u=0;let a;n<0?a=n*-1:a=0;let m=i[0].length-u,l=i.length-a;if(e+u+m>=s.width&&(m=s.width-e-u),n+a+l>=s.height&&(l=s.height-n-a),!(m<=0||l<=0)){c.commands.getImageData(s);for(let p=a;p<a+l;p++)for(let w=u;w<u+m;w++){let y=s.pal[i[p][w]],x=(s.width*(n+p)+(e+w))*4;y&&(y.a>0||d)&&(s.imageData.data[x]=y.r,s.imageData.data[x+1]=y.g,s.imageData.data[x+2]=y.b,s.imageData.data[x+3]=y.a)}c.commands.setImageDirty(s)}}f(o,"put"),c.defaultPenDraw=S,c.defaultBlendCmd=E}f(Se,"init");function Pe(t){let c=t._.data;t._.addCommand("screen",E,!1,!1,["aspect","container","isOffscreen","willReadFrequently","noStyles","isMultiple","resizeCallback"]);function E(h){let I=h[0],v=h[1],g=h[2],o=!!h[3],s=h[4],r=h[5],i=h[6],e;if(i!=null&&!t.util.isFunction(i)){let u=new TypeError("screen: resizeCallback must be a function.");throw u.code="INVALID_CALLBACK",u}if(typeof I=="string"&&I!==""){if(e=b(I.toLowerCase()),!e){let u=new Error("screen: invalid value for aspect.");throw u.code="INVALID_ASPECT",u}e.isMultiple=!!r}let n;if(g){if(!e){let u=new Error("screen: You must supply an aspect ratio with exact dimensions for offscreen screens.");throw u.code="NO_ASPECT_OFFSCREEN",u}if(e.splitter!=="x"){let u=new Error("screen: You must use aspect ratio with e(x)act pixel dimensions such as 320x200 for offscreen screens.");throw u.code="INVALID_OFFSCREEN_ASPECT",u}n=T(e,o)}else{let u=v;if(typeof v=="string"&&(u=document.getElementById(v)),u&&!t.util.isDomElement(u)){let a=new TypeError("screen: Invalid argument container. Container must be a DOM element or a string id of a DOM element.");throw a.code="INVALID_CONTAINER",a}s?n=j(e,u,o):n=M(e,u,i,o)}n.cache={findColor:{}};let d={};n.commands={};for(let u in c.screenCommands){let a=c.screenCommands[u];n.commands[u]=a.fn,C(d,u,n,a)}return n.screenObj=d,d.id=n.id,d.screen=!0,d}f(E,"screen");function C(h,I,v,g){h[I]=function(...o){let s=t._.parseOptions(g,o);return v.commands[I](v,s)}}f(C,"setupApiCommand");function b(h){let I,v,g,o;if(h.indexOf(":")>-1)o=":";else if(h.indexOf("x")>-1)o="x";else if(h.indexOf("e")>-1)o="e";else return null;return g=h.split(o),I=Number(g[0]),isNaN(I)||I===0||(v=Number(g[1]),isNaN(v)||v===0)?null:{width:I,height:v,splitter:o}}f(b,"parseAspect");function T(h,I){let v=document.createElement("canvas");v.width=h.width,v.height=h.height;let g=document.createElement("canvas");return g.width=h.width,g.height=h.height,S(v,g,null,h,!0,!1,null,I)}f(T,"createOffscreenScreen");function M(h,I,v,g){let o=document.createElement("canvas"),s=document.createElement("canvas");o.style.backgroundColor="black",o.style.position="absolute",o.style.imageRendering="pixelated",o.style.imageRendering="crisp-edges";let r=!0;if(t.util.isDomElement(I)||(r=!1,document.documentElement.style.height="100%",document.documentElement.style.margin="0",document.body.style.height="100%",document.body.style.margin="0",document.body.style.overflow="hidden",o.style.left="0",o.style.top="0",I=document.body),I.offsetHeight===0&&(I.style.height="200px"),I.appendChild(o),h){let i=A(I);P(h,o,i.width,i.height),s.width=o.width,s.height=o.height}else{r&&(o.style.position="static"),o.style.width="100%",o.style.height="100%";let i=A(o);o.width=i.width,o.height=i.height,s.width=i.width,s.height=i.height}return S(o,s,I,h,!1,!1,v,g)}f(M,"createScreen");function j(h,I,v){let g=document.createElement("canvas"),o=document.createElement("canvas");if(t.util.isDomElement(I)||(I=document.body),I.appendChild(g),h&&h.splitter==="x")g.width=h.width,g.height=h.height,o.width=g.width,o.height=g.height;else{let s=A(g);o.width=s.width,o.height=s.height}return S(g,o,I,h,!1,!0,null,v)}f(j,"createNoStyleScreen");function S(h,I,v,g,o,s,r,i){let e={};return e.id=c.nextScreenId,c.nextScreenId+=1,c.activeScreen=e,h.dataset.screenId=e.id,i?e.contextAttributes={willReadFrequently:!0}:e.contextAttributes={},e.canvas=h,e.width=h.width,e.height=h.height,e.container=v,e.aspectData=g,e.isOffscreen=o,e.isNoStyles=s,e.context=h.getContext("2d",e.contextAttributes),e.bufferCanvas=I,e.bufferContext=I.getContext("2d",e.contextAttributes),e.dirty=!1,e.isAutoRender=!0,e.autoRenderMicrotaskScheduled=!1,e.imageData=null,e.x=0,e.y=0,e.angle=0,e.pal=c.defaultPalette.slice(),e.fColor=e.pal[c.defaultColor]||t.util.convertToColor("#FFFFFF"),e.bColor=e.pal[0]||t.util.convertToColor("#000000"),e.context.fillStyle=e.fColor.s,e.context.strokeStyle=e.fColor.s,e.mouseStarted=!1,e.touchStarted=!1,e.printCursor={x:0,y:0,font:c.defaultFont,rows:Math.floor(h.height/(c.defaultFont.height||14)),cols:Math.floor(h.width/(c.defaultFont.width||8)),prompt:c.defaultPrompt,breakWord:!0},e.clientRect=h.getBoundingClientRect(),e.mouse={x:-1,y:-1,offsetX:0,offsetY:0,button:0,buttons:0,lastX:-1,lastY:-1,eventType:""},e.touch={x:-1,y:-1,count:0,touches:[],eventType:""},e.touches={},e.lastTouches={},e.pixelMode=!0,e.pen={draw:c.defaultPenDraw,size:1,noise:null},e.blendPixelCmd=c.defaultBlendCmd,e.context.imageSmoothingEnabled=!1,e.onMouseEventListeners={},e.onTouchEventListeners={},e.onPressEventListeners={},e.onClickEventListeners={},e.mouseEventListenersActive=0,e.touchEventListenersActive=0,e.pressEventListenersActive=0,e.clickEventListenersActive=0,e.lastEvent=null,e.isContextMenuEnabled=!0,e.resizeCallback=r,c.screens[e.id]=e,e}f(S,"createScreenData");function P(h,I,v,g){let o=h.width,s=h.height,r=h.splitter,i,e;if(h.isMultiple&&r!==":"){let n=Math.floor(v/o),d=Math.floor(g/s),u=n>d?d:n;u<1&&(u=1),i=o*u,e=s*u,r==="e"&&(o=Math.floor(v/u),s=Math.floor(g/u),i=o*u,e=s*u)}else{let n=s/o,d=o/s;i=g*d,e=v*n,i>v?(i=v,e=i*n):e=g,r==="e"&&(o+=Math.round((v-i)*(o/i)),s+=Math.round((g-e)*(s/e)),i=v,e=g)}I.style.width=Math.floor(i)+"px",I.style.height=Math.floor(e)+"px",I.style.marginLeft=Math.floor((v-i)/2)+"px",I.style.marginTop=Math.floor((g-e)/2)+"px",r==="x"||r==="e"?(I.width=o,I.height=s):(I.width=Math.floor(i),I.height=Math.floor(e))}f(P,"setCanvasSize");function A(h){return{width:h.offsetWidth||h.clientWidth||h.width,height:h.offsetHeight||h.clientHeight||h.height}}f(A,"getSize")}f(Pe,"init");function Re(t){let c=t._.data;t._.addCommand("onevent",E,!0,!0,[]);function E(l,p,w,y,x,_,k,R,O,Y){let H=!1;for(let q=0;q<x.length;q++)if(l===x[q]){H=!0;break}if(!H){let q=new TypeError(`${_}: mode needs to be one of the following ${x.join(", ")}`);throw q.code="INVALID_MODE",q}if(w=!!w,!t.util.isFunction(p)){let q=new TypeError(`${_}: fn is not a valid function`);throw q.code="INVALID_CALLBACK",q}if(y&&(!t.util.isInteger(y.x)||!t.util.isInteger(y.y)||!t.util.isInteger(y.width)||!t.util.isInteger(y.height))){let q=new TypeError(`${_}: hitbox must have properties x, y, width, and height whose values are integers`);throw q.code="INVALID_HITBOX",q}return setTimeout(function(){let q=p,$;typeof R=="string"?$=l+R:$=l,w&&(p=f(function(X,Z){C(l,q,x,_,k,R),q(X,Z)},"fn")),k[$]||(k[$]=[]),k[$].push({fn:p,hitBox:y,extraData:O,clickDown:!1,originalFn:q,customData:Y})},1),!0}f(E,"onevent"),t._.addCommand("offevent",C,!0,!0,[]);function C(l,p,w,y,x,_){let k=!1;for(let O=0;O<w.length;O++)if(l===w[O]){k=!0;break}if(!k){let O=new TypeError(`${y}: mode needs to be one of the following ${w.join(", ")}`);throw O.code="INVALID_MODE",O}typeof _=="string"&&(l+=_);let R=p==null;if(!R&&!t.util.isFunction(p)){let O=new TypeError(`${y}: fn is not a valid function`);throw O.code="INVALID_CALLBACK",O}if(x[l]){if(R)delete x[l];else for(let O=x[l].length-1;O>=0;O--)x[l][O].originalFn===p&&x[l].splice(O,1),x[l].length===0&&delete x[l];return!0}return!1}f(C,"offevent"),t._.addCommand("clearEvents",b,!1,!0,[]);function b(l){l.onMouseEventListeners={},l.onTouchEventListeners={},l.onPressEventListeners={},l.onClickEventListeners={},l.mouseEventListenersActive=0,l.touchEventListenersActive=0,l.pressEventListenersActive=0,l.clickEventListenersActive=0,l.lastEvent=null}f(b,"clearEvents"),t._.addCommand("setAutoRender",T,!1,!0,["isAutoRender"]),t._.addSetting("autoRender",T,!0,["isAutoRender"]);function T(l,p){l.isAutoRender=!!p[0],l.isAutoRender&&l.screenObj.render()}f(T,"setAutoRender"),t._.addCommand("removeScreen",M,!1,!0,[]);function M(l){let p=l.id;if(l===c.activeScreen){for(let w in c.screens)if(c.screens[w]!==l){c.activeScreen=c.screens[w];break}}l.screenObj.cancelInput&&l.screenObj.cancelInput();for(let w in l.screenObj)delete l.screenObj[w];l.canvas.parentElement&&l.canvas.parentElement.removeChild(l.canvas),l.canvas=null,l.bufferCanvas=null,l.pal=null,l.commands=null,l.context=null,l.imageData=null,l.screenObj=null,delete c.screens[p]}f(M,"removeScreen"),t._.addCommand("render",j,!1,!0,[]);function j(l){l.dirty===!0&&(l.context.putImageData(l.imageData,0,0),l.dirty=!1)}f(j,"render"),t._.addCommand("width",S,!1,!0,[]);function S(l){return l.width}f(S,"getWidth"),t._.addCommand("height",P,!1,!0,[]);function P(l){return l.height}f(P,"getHeight"),t._.addCommand("canvas",A,!1,!0,[]);function A(l){return l.canvas}f(A,"getCanvas"),t._.addCommand("setBgColor",h,!1,!0,["color"]),t._.addSetting("bgColor",h,!0,["color"]);function h(l,p){let w=p[0],y;if(t.util.isInteger(w)?y=l.pal[w]:y=t.util.convertToColor(w),y&&typeof y.s=="string")l.canvas.style.backgroundColor=y.s;else{let x=new TypeError("bgColor: invalid color value for parameter c.");throw x.code="INVALID_COLOR",x}}f(h,"setBgColor"),t._.addCommand("setContainerBgColor",I,!1,!0,["color"]),t._.addSetting("containerBgColor",I,!0,["color"]);function I(l,p){let w=p[0],y;if(l.container)if(t.util.isInteger(w)?y=l.pal[w]:y=t.util.convertToColor(w),y&&typeof y.s=="string")l.container.style.backgroundColor=y.s;else{let x=new TypeError("containerBgColor: invalid color value for parameter c.");throw x.code="INVALID_COLOR",x}}f(I,"setContainerBgColor"),t._.addCommand("findColor",v,!1,!0,["color","tolerance","isAddToPalette"]);function v(l,p){let w=p[0],y=p[1],x=!!p[2],_=65025*3.25;if(y==null)y=1;else if(isNaN(y)||y<0||y>1){let R=new RangeError("findColor: parameter tolerance must be a number between 0 and 1");throw R.code="INVALID_TOLERANCE",R}y=y*(2-y)*_;let k=l.pal;if(w&&w.s&&l.cache.findColor[w.s]!==void 0)return l.cache.findColor[w.s];w=c.commands.findColorValue(l,w,"findColor");for(let R=0;R<k.length;R++){if(k[R].s===w.s)return l.cache.findColor[w.s]=R,R;{let O=k[R].r-w.r,Y=k[R].g-w.g,H=k[R].b-w.b,q=k[R].a-w.a,$=O*O+Y*Y+H*H+q*q*.25;if(_-$>=y)return l.cache.findColor[w.s]=R,R}}return x?(k.push(w),l.cache.findColor[w.s]=k.length-1,k.length-1):0}f(v,"findColor"),t._.addCommand("setColor",g,!1,!0,["color","isAddToPalette"]),t._.addSetting("color",g,!0,["color","isAddToPalette"]);function g(l,p){let w=p[0],y=!!p[1],x=c.commands.findColorValue(l,w,"setColor");if(x!==void 0){if(y){let _=c.commands.findColor(l,[x,1,y]);l.fColor=l.pal[_]}else l.fColor=x;l.context.fillStyle=l.fColor.s,l.context.strokeStyle=l.fColor.s}}f(g,"setColor"),t._.addCommand("setPenSize",o,!1,!0,["size"]),t._.addSetting("penSize",o,!0,["size"]);function o(l,p){let w=p[0];if(w===void 0&&(w=1),!t.util.isInteger(w)||w<1){let y=new TypeError("setPenSize: size must be an integer >= 1.");throw y.code="INVALID_PEN_SIZE",y}l.pen.size=w,l.context.lineWidth=w}f(o,"setPenSize"),t._.addCommand("getPal",s,!1,!0,[]);function s(l){let p=[];for(let w=0;w<l.pal.length;w++){let y={r:l.pal[w].r,g:l.pal[w].g,b:l.pal[w].b,a:l.pal[w].a,s:l.pal[w].s};p.push(y)}return p}f(s,"getPal"),t._.addCommand("setPalColor",r,!1,!0,["index","color"]),t._.addSetting("palColor",r,!0,["index","color"]);function r(l,p){let w=p[0],y=p[1];if(!t.util.isInteger(w)||w<0||w>l.pal.length){let _=new RangeError("setPalColor: index is not a valid integer value");throw _.code="INVALID_INDEX",_}let x=t.util.convertToColor(y);if(x===null){let _=new TypeError("setPalColor: parameter color is not a valid color format");throw _.code="INVALID_COLOR",_}l.fColor.s===l.pal[w].s&&(l.fColor=x),l.cache.findColor[y.s]&&(l.cache.findColor[y.s]=w),l.pal[w]=x}f(r,"setPalColor"),t._.addCommand("swapColor",i,!1,!0,["oldColor","newColor"]);function i(l,p){let w=p[0],y=p[1];if(!t.util.isInteger(w)){let k=new TypeError("swapColor: parameter oldColor must be an integer");throw k.code="INVALID_OLD_COLOR",k}if(w<0||w>=l.pal.length){let k=new RangeError("swapColor: parameter oldColor is an invalid integer");throw k.code="INVALID_OLD_COLOR_INDEX",k}if(l.pal[w]===void 0){let k=new Error("swapColor: parameter oldColor is not in the screen color palette");throw k.code="COLOR_NOT_IN_PALETTE",k}let x=w;if(w=l.pal[x],y=t.util.convertToColor(y),y===null){let k=new TypeError("swapColor: parameter newColor is not a valid color format");throw k.code="INVALID_NEW_COLOR",k}c.commands.getImageData(l);let _=l.imageData.data;for(let k=0;k<l.height;k++)for(let R=0;R<l.width;R++){let O=(l.width*k+R)*4;_[O]===w.r&&_[O+1]===w.g&&_[O+2]===w.b&&_[O+3]===w.a&&(_[O]=y.r,_[O+1]=y.g,_[O+2]=y.b,_[O+3]=y.a)}c.commands.setImageDirty(l),l.pal[x]=y}f(i,"swapColor"),t._.addCommand("setPixelMode",e,!1,!0,["isEnabled"]),t._.addSetting("pixelMode",e,!0,["isEnabled"]);function e(l,p){p[0]?(l.context.imageSmoothingEnabled=!1,l.pixelMode=!0):(l.context.imageSmoothingEnabled=!0,l.pixelMode=!1)}f(e,"setPixelMode"),t._.addCommand("setPen",n,!1,!0,["pen","size","noise"]),t._.addSetting("pen",n,!0,["pen","size","noise"]);function n(l,p){let w=p[0],y=Math.round(p[1]),x=p[2];if(!c.pens[w]){let _=new TypeError(`setPen: parameter pen is not a valid pen. Valid pens: ${c.penList.join(", ")}`);throw _.code="INVALID_PEN",_}if(!t.util.isInteger(y)){let _=new TypeError("setPen: parameter size must be an integer");throw _.code="INVALID_SIZE",_}if(x&&!t.util.isArray(x)&&isNaN(x)){let _=new TypeError("setPen: parameter noise is not an array or number");throw _.code="INVALID_NOISE",_}if(t.util.isArray(x)){x=x.slice();for(let _=0;_<x.length;_++)if(isNaN(x[_])){let k=new TypeError("setPen: parameter noise array contains an invalid value");throw k.code="INVALID_NOISE_VALUE",k}}w==="pixel"&&(y=1),y<1&&(y=1),y===1?(l.pen.draw=c.pens.pixel.cmd,l.context.lineWidth=1):(l.pen.draw=c.pens[w].cmd,l.context.lineWidth=y*2-1),l.pen.noise=x,l.pen.size=y,l.context.lineCap=c.pens[w].cap}f(n,"setPen"),t._.addCommand("setBlendMode",d,!1,!0,["mode"]),t._.addSetting("blendMode",d,!0,["mode"]);function d(l,p){let w=p[0];if(!c.blendCommands[w]){let y=new TypeError(`setBlendMode: Argument blend is not a valid blend mode. Valid modes: ${c.blendCommandsList.join(", ")}`);throw y.code="INVALID_BLEND_MODE",y}l.blendPixelCmd=c.blendCommands[w]}f(d,"setBlendMode"),t._.addCommand("getPixel",u,!1,!0,["x","y"]);function u(l,p){let w=Math.round(p[0]),y=Math.round(p[1]);if(!t.util.isInteger(w)||!t.util.isInteger(y)){let k=new TypeError("getPixel: x and y must be integers");throw k.code="INVALID_COORDINATES",k}c.commands.getImageData(l);let x=l.imageData.data,_=(l.width*y+w)*4;return t.util.convertToColor({r:x[_],g:x[_+1],b:x[_+2],a:x[_+3]})}f(u,"getPixel"),t._.addCommand("filterImg",a,!1,!0,["filter"]);function a(l,p){let w=p[0];if(!t.util.isFunction(w)){let x=new TypeError("filterImg: filter must be a callback function");throw x.code="INVALID_FILTER",x}c.commands.getImageData(l);let y=l.imageData.data;for(let x=0;x<l.height;x++)for(let _=0;_<l.width;_++){let k=(l.width*x+_)*4,R=w({r:y[k],g:y[k+1],b:y[k+2],a:y[k+3]},_,x);R&&t.util.isInteger(R.r)&&t.util.isInteger(R.g)&&t.util.isInteger(R.b)&&t.util.isInteger(R.a)&&(y[k]=t.util.clamp(R.r,0,255),y[k+1]=t.util.clamp(R.g,0,255),y[k+2]=t.util.clamp(R.b,0,255),y[k+3]=t.util.clamp(R.a,0,255))}c.commands.setImageDirty(l)}f(a,"filterImg"),t._.addCommand("get",m,!1,!0,["x1","y1","x2","y2","tolerance","isAddToPalette"]);function m(l,p){let w=Math.round(p[0]),y=Math.round(p[1]),x=Math.round(p[2]),_=Math.round(p[3]),k=p[4]!=null?p[4]:1,R=!!p[5];if(isNaN(w)||isNaN(y)||isNaN(x)||isNaN(_)){let q=new TypeError("get: parameters x1, x2, y1, y2 must be integers.");throw q.code="INVALID_COORDINATES",q}if(isNaN(k)){let q=new TypeError("get: parameter tolerance must be a number.");throw q.code="INVALID_TOLERANCE",q}if(w=t.util.clamp(w,0,l.width-1),x=t.util.clamp(x,0,l.width-1),y=t.util.clamp(y,0,l.height-1),_=t.util.clamp(_,0,l.height-1),w>x){let q=w;w=x,x=q}if(y>_){let q=y;y=_,_=q}c.commands.getImageData(l);let O=l.imageData,Y=[],H=0;for(let q=y;q<=_;q++){Y.push([]);for(let $=w;$<=x;$++){let X=(l.width*q+$)*4,Z=O.data[X],Q=O.data[X+1],me=O.data[X+2],he=O.data[X+3],ve=t.util.rgbToColor(Z,Q,me,he),re=c.commands.findColor(l,[ve,k,R]);Y[H].push(re)}H+=1}return Y}f(m,"get")}f(Re,"init");function Oe(t){let c=t._.data;t._.addCommand("cls",E,!1,!0,["x","y","width","height"]);function E(o,s){let r=t.util.getInt(Math.round(s[0]),0),i=t.util.getInt(Math.round(s[1]),0),e=t.util.getInt(Math.round(s[2]),o.width),n=t.util.getInt(Math.round(s[3]),o.height);r!==0||i!==0||e!==o.width||n!==o.height?(o.screenObj.render(),o.context.clearRect(r,i,e,n)):(o.context.clearRect(r,i,e,n),o.imageData=null,o.printCursor.x=0,o.printCursor.y=0,o.x=0,o.y=0,o.dirty=!1),c.commands.resetImageData(o)}f(E,"cls"),t._.addCommands("pset",C,b,["x","y"]);function C(o,s){let r=Math.round(s[0]),i=Math.round(s[1]);if(!t.util.isInteger(r)||!t.util.isInteger(i)){let n=new TypeError("pset: Arguments x and y must be integers.");throw n.code="INVALID_COORDINATES",n}if(o.x=r,o.y=i,!t.util.inRange2(r,i,0,0,o.width,o.height))return;let e=o.fColor;c.commands.getImageData(o),o.pen.draw(o,r,i,e),c.commands.setImageDirty(o)}f(C,"pset");function b(o,s){let r=s[0],i=s[1];if(isNaN(r)||isNaN(i)){let e=new TypeError("pset: Arguments x and y must be numbers.");throw e.code="INVALID_COORDINATES",e}o.context.fillRect(r,i,1,1)}f(b,"aaPset"),t._.addCommands("line",T,M,["x1","y1","x2","y2"]);function T(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]);if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)||!t.util.isInteger(n)){let w=new TypeError("line: Arguments x1, y1, x2, and y2 must be integers.");throw w.code="INVALID_COORDINATES",w}let d=o.fColor,u=Math.abs(e-r),a=Math.abs(n-i),m=r<e?1:-1,l=i<n?1:-1,p=u-a;for(c.commands.getImageData(o),o.pen.draw(o,r,i,d);!(r===e&&i===n);){let w=p<<1;w>-a&&(p-=a,r+=m),w<u&&(p+=u,i+=l),o.pen.draw(o,r,i,d)}c.commands.setImageDirty(o)}f(T,"pxLine");function M(o,s){let r=s[0],i=s[1],e=s[2],n=s[3];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let u=new TypeError("line: parameters x1, y1, x2, y2 must be numbers.");throw u.code="INVALID_COORDINATES",u}o.screenObj.render();let d=o.context;d.beginPath(),d.moveTo(r,i),d.lineTo(e,n),d.stroke()}f(M,"aaLine"),t._.addCommands("circle",j,S,["x","y","radius","fillColor"]);function j(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=!1;if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)){let w=new TypeError("circle: x, y, radius must be integers.");throw w.code="INVALID_COORDINATES",w}if(n!=null){if(n=c.commands.findColorValue(o,n,"circle"),n===void 0)return;d=!0}c.commands.getImageData(o);let u=o.fColor;if(d){let w=e-1,y=w*w;for(let x=-w;x<=w;x++){let _=i+x;if(_<0||_>=o.height)continue;let k=Math.floor(Math.sqrt(y-x*x));for(let R=r-k;R<=r+k;R++)R<0||R>=o.width||c.commands.setPixelSafe(o,R,_,n)}}let a=e-1,m=a,l=0;a>1?(o.pen.draw(o,m+r,l+i,u),o.pen.draw(o,-m+r,l+i,u),o.pen.draw(o,r,m+i,u),o.pen.draw(o,r,-m+i,u)):a===1?(o.pen.draw(o,r+1,i,u),o.pen.draw(o,r-1,i,u),o.pen.draw(o,r,i+1,u),o.pen.draw(o,r,i-1,u),l=m+1):a===0&&(o.pen.draw(o,r,i,u),l=m+1);let p=1-a;for(;m>l;)l+=1,p<=0?p=p+2*l+1:(m-=1,p=p+2*l-2*m+1),o.pen.draw(o,m+r,l+i,u),o.pen.draw(o,-m+r,l+i,u),o.pen.draw(o,m+r,-l+i,u),o.pen.draw(o,-m+r,-l+i,u),m!==l&&(o.pen.draw(o,l+r,m+i,u),o.pen.draw(o,-l+r,m+i,u),o.pen.draw(o,l+r,-m+i,u),o.pen.draw(o,-l+r,-m+i,u));c.commands.setImageDirty(o)}f(j,"pxCircle");function S(o,s){let r=s[0]+.5,i=s[1]+.5,e=s[2]-.9,n=s[3];if(isNaN(r)||isNaN(i)||isNaN(e)){let m=new TypeError("circle: parameters x, y, r must be numbers.");throw m.code="INVALID_COORDINATES",m}e<0&&(e=0);let d=!1;if(n!=null){if(n=c.commands.findColorValue(o,n,"circle"),n===void 0)return;d=!0}o.screenObj.render();let u=o.context,a=o.fColor.s;u.beginPath(),u.arc(r,i,e,0,Math.PI*2),d&&(u.fillStyle=n.s,u.fill()),u.strokeStyle=a,u.stroke()}f(S,"aaCircle"),t._.addCommands("rect",P,A,["x","y","width","height","fillColor"]);function P(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]),d=s[4];if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)||!t.util.isInteger(n)){let m=new TypeError("rect: x, y, width, height must be integers.");throw m.code="INVALID_COORDINATES",m}let u=o.fColor,a=d!=null;if(!(a&&(d=c.commands.findColorValue(o,d,"rect"),d===void 0))){c.commands.getImageData(o);for(let m=0;m<e;m++)o.pen.draw(o,r+m,i,u),o.pen.draw(o,r+m,i+n-1,u);for(let m=1;m<n-1;m++)o.pen.draw(o,r,i+m,u),o.pen.draw(o,r+e-1,i+m,u);if(a)for(let m=1;m<n-1;m++)for(let l=1;l<e-1;l++)c.commands.setPixel(o,r+l,i+m,d);c.commands.setImageDirty(o)}}f(P,"pxRect");function A(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let m=new TypeError("rect: parameters must be numbers.");throw m.code="INVALID_COORDINATES",m}let u=d!=null;if(u&&(d=c.commands.findColorValue(o,d,"rect"),d===void 0))return;o.screenObj.render();let a=o.context;u?(a.fillStyle=d.s,a.fillRect(r,i,e,n)):a.strokeRect(r,i,e,n)}f(A,"aaRect"),t._.addCommands("ellipse",h,I,["x","y","radiusX","radiusY","fillColor"]);function h(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]),d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let _=new TypeError("ellipse: parameters x, y, radiusX, radiusY must be integers.");throw _.code="INVALID_COORDINATES",_}let u=!1;if(d!=null){if(d=c.commands.findColorValue(o,d,"ellipse"),d===void 0)return;u=!0}c.commands.getImageData(o);let a=o.fColor;if(e===0&&n===0){o.pen.draw(o,Math.floor(r),Math.floor(i),a),c.commands.setImageDirty(o);return}if(u){let _=e*e,k=n*n;for(let R=-n;R<=n;R++){let O=i+R;if(O<0||O>=o.height)continue;let Y=Math.floor(e*Math.sqrt(1-R*R/k));for(let H=r-Y;H<=r+Y;H++)H<0||H>=o.width||c.commands.setPixelSafe(o,H,O,d)}}let m=0,l=n,p=n*n-e*e*n+.25*e*e,w=2*n*n*m,y=2*e*e*l;for(;w<y;)o.pen.draw(o,Math.floor(m+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(-m+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(m+r),Math.floor(-l+i),a),o.pen.draw(o,Math.floor(-m+r),Math.floor(-l+i),a),p<0?(m++,w=w+2*n*n,p=p+w+n*n):(m++,l--,w=w+2*n*n,y=y-2*e*e,p=p+w-y+n*n);let x=n*n*((m+.5)*(m+.5))+e*e*((l-1)*(l-1))-e*e*n*n;for(;l>=0;)o.pen.draw(o,Math.floor(m+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(-m+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(m+r),Math.floor(-l+i),a),o.pen.draw(o,Math.floor(-m+r),Math.floor(-l+i),a),x>0?(l--,y=y-2*e*e,x=x+e*e-y):(l--,m++,w=w+2*n*n,y=y-2*e*e,x=x+w-y+e*e);c.commands.setImageDirty(o)}f(h,"pxEllipse");function I(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let m=new TypeError("ellipse: parameters x, y, radiusX, radiusY must be numbers.");throw m.code="INVALID_COORDINATES",m}let u=!1;if(d!=null){if(d=c.commands.findColorValue(o,d,"ellipse"),d===void 0)return;u=!0}o.screenObj.render();let a=o.context;a.beginPath(),a.strokeStyle=o.fColor.s,a.moveTo(r+e,i),a.ellipse(r,i,e,n,0,t.util.math.deg360,!1),u&&(a.fillStyle=d.s,a.fill()),a.stroke(),c.commands.resetImageData(o)}f(I,"aaEllipse"),t._.addCommands("arc",v,g,["x","y","radius","angle1","angle2"]);function v(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=s[4];n=(n+360)%360,d=(d+360)%360;let u=n>d;if(isNaN(r)||isNaN(i)||isNaN(e)){let y=new TypeError("arc: x, y, radius must be integers.");throw y.code="INVALID_COORDINATES",y}c.commands.getImageData(o);let a=o.fColor;function m(y,x){let _=t.util.radiansToDegrees(Math.atan2(x-i,y-r));return _=(_+360)%360,u?_>=n||_<=d:_>=n&&_<=d}f(m,"shouldDrawPixel"),e-=1,e<0&&(e=0);let l=e,p=0;if(e>1)m(l+r,p+i)&&o.pen.draw(o,l+r,p+i,a),m(-l+r,p+i)&&o.pen.draw(o,-l+r,p+i,a),m(r,l+i)&&o.pen.draw(o,r,l+i,a),m(r,-l+i)&&o.pen.draw(o,r,-l+i,a);else if(e===1){m(r+1,i)&&o.pen.draw(o,r+1,i,a),m(r-1,i)&&o.pen.draw(o,r-1,i,a),m(r,i+1)&&o.pen.draw(o,r,i+1,a),m(r,i-1)&&o.pen.draw(o,r,i-1,a),c.commands.setImageDirty(o);return}else if(e===0){o.pen.draw(o,r,i,a),c.commands.setImageDirty(o);return}let w=1-e;for(;l>p;)p+=1,w<=0?w=w+2*p+1:(l-=1,w=w+2*p-2*l+1),m(l+r,p+i)&&o.pen.draw(o,l+r,p+i,a),m(-l+r,p+i)&&o.pen.draw(o,-l+r,p+i,a),m(l+r,-p+i)&&o.pen.draw(o,l+r,-p+i,a),m(-l+r,-p+i)&&o.pen.draw(o,-l+r,-p+i,a),l!==p&&(m(p+r,l+i)&&o.pen.draw(o,p+r,l+i,a),m(-p+r,l+i)&&o.pen.draw(o,-p+r,l+i,a),m(p+r,-l+i)&&o.pen.draw(o,p+r,-l+i,a),m(-p+r,-l+i)&&o.pen.draw(o,-p+r,-l+i,a));c.commands.setImageDirty(o)}f(v,"pxArc");function g(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)||isNaN(d)){let a=new TypeError("arc: parameters must be numbers.");throw a.code="INVALID_COORDINATES",a}r=r+.5,i=i+.5,e=e-.9,e<0&&(e=0),o.screenObj.render(),n=t.util.degreesToRadian(n),d=t.util.degreesToRadian(d);let u=o.context;u.beginPath(),u.strokeStyle=o.fColor.s,u.moveTo(r+Math.cos(n)*e,i+Math.sin(n)*e),u.arc(r,i,e,n,d),u.stroke(),c.commands.resetImageData(o)}f(g,"aaArc")}f(Oe,"init");function Ve(t){let c=t._.data,E=65025*3.25,C,b;t._.addCommand("paint",T,!1,!0,["x","y","fillColor","tolerance"]);function T(A,h){let I=Math.round(h[0]),v=Math.round(h[1]),g=h[2],o=h[3];if(!t.util.isInteger(I)||!t.util.isInteger(v)){let i=new TypeError("paint: parameters x and y must be integers");throw i.code="INVALID_COORDINATES",i}if((o==null||o===!1)&&(o=1),isNaN(o)||o<0||o>1){let i=new RangeError("paint: parameter tolerance must be a number between 0 and 1.");throw i.code="INVALID_TOLERANCE",i}o=o*(2-o)*E,navigator.brave&&o===E&&(o-=1);let s=[{x:I,y:v}];if(A.pen.noise?C=M:C=c.commands.setPixel,t.util.isInteger(g)){if(g>A.pal.length){let i=new RangeError("paint: Argument fillColor is not a color in the palette.");throw i.code="COLOR_OUT_OF_RANGE",i}g=A.pal[g]}else if(g=t.util.convertToColor(g),g===null){let i=new TypeError("paint: Argument fillColor is not a valid color format.");throw i.code="INVALID_COLOR",i}b={},c.commands.getImageData(A);let r=c.commands.getPixelInternal(A,I,v);for(;s.length>0;){let i=s.pop();C(A,i.x,i.y,g),S(A,i.x+1,i.y,s,g,r,o),S(A,i.x-1,i.y,s,g,r,o),S(A,i.x,i.y+1,s,g,r,o),S(A,i.x,i.y-1,s,g,r,o)}b=null,c.commands.setImageDirty(A)}f(T,"paint");function M(A,h,I,v){v=c.commands.getPixelColor(A,v),c.commands.setPixel(A,h,I,v)}f(M,"setPixelNoise");function j(A,h){let I=A+" "+h;return b[I]?!0:(b[I]=!0,!1)}f(j,"checkPixel");function S(A,h,I,v,g,o,s){if(P(A,h,I,g,o,s)){C(A,h,I,g);let r={x:h,y:I};v.push(r)}}f(S,"addFill");function P(A,h,I,v,g,o){if(h<0||h>=A.width||I<0||I>=A.height)return!1;let s=c.commands.getPixelInternal(A,h,I);if(!j(h,I)){let r=s.r-g.r,i=s.g-g.g,e=s.b-g.b,n=s.a-g.a,d=r*r+i*i+e*e+n*n*.25;return E-d>=o}return!1}f(P,"floodCheck")}f(Ve,"init");function Be(t){let c=t._.data;t._.addCommands("bezier",E,C,["xStart","yStart","x1","y1","x2","y2","xEnd","yEnd"]);function E(M,j){let S=Math.round(j[0]),P=Math.round(j[1]),A=Math.round(j[2]),h=Math.round(j[3]),I=Math.round(j[4]),v=Math.round(j[5]),g=Math.round(j[6]),o=Math.round(j[7]);if(isNaN(S)||isNaN(P)||isNaN(A)||isNaN(h)||isNaN(I)||isNaN(v)||isNaN(g)||isNaN(o)){let a=new TypeError("bezier: parameters xStart, yStart, x1, y1, x2, y2, xEnd, and yEnd must be numbers.");throw a.code="INVALID_COORDINATES",a}let s=M.fColor;c.commands.getImageData(M);let r=M.pen.size,i=[{x:S,y:P},{x:A,y:h},{x:I,y:v},{x:g,y:o}],e=T(0,i);M.pen.draw(M,e.x,e.y,s);let n=.1,d=.1;for(;n<1;){let a=T(n,i);b(a,e)>r&&d>1e-5?(n-=d,d=d*.75):(M.pen.draw(M,a.x,a.y,s),e=a),n+=d}let u=T(1,i);M.pen.draw(M,u.x,u.y,s),c.commands.setImageDirty(M)}f(E,"pxBezier");function C(M,j){let S=j[0]+.5,P=j[1]+.5,A=j[2]+.5,h=j[3]+.5,I=j[4]+.5,v=j[5]+.5,g=j[6]+.5,o=j[7]+.5;if(isNaN(S)||isNaN(P)||isNaN(A)||isNaN(h)||isNaN(I)||isNaN(v)||isNaN(g)||isNaN(o)){let r=new TypeError("bezier: parameters xStart, yStart, x1, y1, x2, y2, xEnd, and yEnd must be numbers.");throw r.code="INVALID_COORDINATES",r}M.screenObj.render();let s=M.context;s.strokeStyle=M.fColor.s,s.beginPath(),s.moveTo(S,P),s.bezierCurveTo(A,h,I,v,g,o),s.stroke(),c.commands.resetImageData(M)}f(C,"aaBezier");function b(M,j){let S=M.x-j.x,P=M.y-j.y;return S*S+P*P}f(b,"calcDistance");function T(M,j){let S=1-M,P=S*S,A=S*S*S,h=M*M,I=M*M*M;return{x:Math.round(A*j[0].x+3*P*M*j[1].x+3*S*h*j[2].x+I*j[3].x),y:Math.round(A*j[0].y+3*P*M*j[1].y+3*S*h*j[2].y+I*j[3].y)}}f(T,"calcStep")}f(Be,"init");function qe(t){let c=t._.data,E=t._.wait,C=t._.resume,b=null;t._.addCommand("loadImage",T,!1,!1,["src","name"]);function T(v){let g=v[0],o=v[1],s,r,i;if(typeof g=="string")s=new Image,s.src=g;else{if(!g||g.tagName!=="IMG"&&g.tagName!=="CANVAS"){let e=new TypeError("loadImage: src must be a string, image element, or canvas.");throw e.code="INVALID_IMAGE_SOURCE",e}s=g}return typeof o!="string"&&(o=""+c.imageCount,c.imageCount+=1),c.images[o]={image:null,type:"image"},r=b,b=null,s.complete?(c.images[o].image=s,t.util.isFunction(r)&&r()):(E(),t.util.isFunction(s.onload)&&(i=s.onload),s.onload=function(){i&&i(),c.images[o].image=s,t.util.isFunction(r)&&r(),C()}),o}f(T,"loadImage"),t._.addCommand("loadSpritesheet",M,!1,!1,["src","name","width","height","margin"]);function M(v){let g=v[0],o=v[1],s=v[2],r=v[3],i=v[4];i==null&&(i=0);let e=!1;if(s==null&&r==null&&(e=!0,s=0,r=0,i=0),s=Math.round(s),r=Math.round(r),i=Math.round(i),!e&&(!t.util.isInteger(s)||!t.util.isInteger(r))){let n=new TypeError("loadSpriteSheet: width, and height must be integers.");throw n.code="INVALID_SPRITE_SIZE",n}if(!e&&(s<1||r<1)){let n=new RangeError("loadSpriteSheet: width, and height must be greater than 0.");throw n.code="INVALID_SPRITE_SIZE",n}if(!t.util.isInteger(i)){let n=new TypeError("loadSpriteSheet: margin must be an integer.");throw n.code="INVALID_MARGIN",n}return typeof o!="string"&&(o=""+c.imageCount,c.imageCount+=1),b=f(function(){let n=c.images[o];n.type="spritesheet",n.spriteWidth=s,n.spriteHeight=r,n.margin=i,n.frames=[],n.isAuto=e;let d=n.image.width,u=n.image.height;if(n.isAuto){let y=function(x,_,k){let R=x+"_"+_;if(a[R]||x<0||x>=d||_<0||_>=u)return;let O=[];for(O.push([x,_,R]);O.length>0;){let Y=O.pop();x=Y[0],_=Y[1];let H=Y[2];a[H]=!0;let q=(x+_*d)*4;if(w[q+3]>0){k.x=Math.min(k.x,x),k.y=Math.min(k.y,_),k.right=Math.max(k.right,x),k.bottom=Math.max(k.bottom,_),k.width=k.right-k.x+1,k.height=k.bottom-k.y+1;for(let $=0;$<p.length;$++){let X=x+p[$][0],Z=_+p[$][1],Q=X+"_"+Z;a[Q]||X<0||X>=d||Z<0||Z>=u||O.push([X,Z,Q])}}}};f(y,"getCluster");let a={},m=document.createElement("canvas");m.width=d,m.height=u;let l=m.getContext("2d",{willReadFrequently:!0});l.drawImage(n.image,0,0);let p=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]],w=l.getImageData(0,0,d,u).data;for(let x=3;x<w.length;x+=4)if(w[x]>0){let _=(x-3)/4,k=_%d,R=Math.floor(_/d),O={x:d,y:u,width:0,height:0,right:0,bottom:0};y(k,R,O),O.width+O.height>4&&n.frames.push(O)}}else{let a=n.margin,m=n.margin,l=a+n.spriteWidth,p=m+n.spriteHeight;for(;p<=u-n.margin;){for(;l<=d-n.margin;)n.frames.push({x:a,y:m,width:n.spriteWidth,height:n.spriteHeight,right:a+n.spriteWidth-1,bottom:m+n.spriteHeight-1}),a+=n.spriteWidth+n.margin,l=a+n.spriteWidth;a=n.margin,l=a+n.spriteWidth,m+=n.spriteHeight+n.margin,p=m+n.spriteHeight}}},"m_callback"),T([g,o]),o}f(M,"loadSpritesheet"),t._.addCommand("getSpritesheetData",j,!1,!0,["name"]);function j(v,g){let o=g[0];if(!c.images[o]){let i=new Error("getSpritesheetData: invalid sprite name");throw i.code="INVALID_SPRITE_NAME",i}let s=c.images[o];if(s.type!=="spritesheet"){let i=new Error("getSpritesheetData: image is not a sprite");throw i.code="NOT_A_SPRITESHEET",i}let r={frameCount:s.frames.length,frames:[]};for(let i=0;i<s.frames.length;i++)r.frames.push({index:i,x:s.frames[i].x,y:s.frames[i].y,width:s.frames[i].width,height:s.frames[i].height,left:s.frames[i].x,top:s.frames[i].y,right:s.frames[i].right,bottom:s.frames[i].bottom});return r}f(j,"getSpritesheetData"),t._.addCommand("getImage",S,!1,!0,["name","x1","y1","x2","y2"]);function S(v,g){let o=g[0],s=Math.round(g[1]),r=Math.round(g[2]),i=Math.round(g[3]),e=Math.round(g[4]);if(isNaN(s)||isNaN(r)||isNaN(i)||isNaN(e)){let m=new TypeError("getImage: parameters x1, x2, y1, y2 must be integers.");throw m.code="INVALID_COORDINATES",m}if(typeof o!="string")o=""+c.imageCount,c.imageCount+=1;else if(c.images[o]){let m=new Error(`getImage: name ${o} is already used; name must be unique.`);throw m.code="DUPLICATE_IMAGE_NAME",m}let n=document.createElement("canvas"),d=n.getContext("2d"),u=Math.abs(s-i),a=Math.abs(r-e);return n.width=u,n.height=a,v.screenObj.render(),d.drawImage(v.screenObj.canvas(),s,r,u,a,0,0,u,a),c.images[o]={image:n,type:"image"},o}f(S,"getImage"),t._.addCommand("removeImage",P,!1,!1,["name"]);function P(v){let g=v[0];if(typeof g!="string"){let o=new TypeError("removeImage: name must be a string.");throw o.code="INVALID_NAME",o}delete c.images[g]}f(P,"removeImage"),t._.addCommand("drawImage",A,!1,!0,["name","x","y","angle","anchorX","anchorY","alpha","scaleX","scaleY"]);function A(v,g){let o=g[0],s=g[1],r=g[2],i=g[3],e=g[4],n=g[5],d=g[6],u=g[7],a=g[8],m;if(typeof o=="string"){if(!c.images[o]){let l=new Error("drawImage: invalid image name");throw l.code="INVALID_IMAGE_NAME",l}m=c.images[o].image}else{if(!o||!o.canvas&&!o.getContext){let l=new TypeError("drawImage: image source object type must be an image already loaded by the loadImage command or a screen.");throw l.code="INVALID_IMAGE_SOURCE",l}t.util.isFunction(o.canvas)?m=o.canvas():m=o}if(isNaN(s)||isNaN(r)){let l=new TypeError("drawImage: parameters x and y must be numbers");throw l.code="INVALID_COORDINATES",l}I(v,m,s,r,i,e,n,d,null,u,a)}f(A,"drawImage"),t._.addCommand("drawSprite",h,!1,!0,["name","frame","x","y","angle","anchorX","anchorY","alpha","scaleX","scaleY"]);function h(v,g){let o=g[0],s=g[1],r=g[2],i=g[3],e=g[4],n=g[5],d=g[6],u=g[7],a=g[8],m=g[9];if(!c.images[o]){let p=new Error("drawSprite: invalid sprite name");throw p.code="INVALID_SPRITE_NAME",p}if(!t.util.isInteger(s)||s>=c.images[o].frames.length||s<0){let p=new RangeError("drawSprite: frame number is not valid");throw p.code="INVALID_FRAME",p}if(isNaN(r)||isNaN(i)){let p=new TypeError("drawSprite: parameters x and y must be numbers");throw p.code="INVALID_COORDINATES",p}let l=c.images[o].image;I(v,l,r,i,e,n,d,u,c.images[o].frames[s],a,m)}f(h,"drawSprite");function I(v,g,o,s,r,i,e,n,d,u,a){(u==null||isNaN(Number(u)))&&(u=1),(a==null||isNaN(Number(a)))&&(a=1),r==null&&(r=0),r=t.util.degreesToRadian(r),i||(i=0),e||(e=0),!n&&n!==0&&(n=255),d?(i=Math.round(d.width*i),e=Math.round(d.height*e)):(i=Math.round(g.width*i),e=Math.round(g.height*e));let m=v.context,l=m.globalAlpha;m.globalAlpha=n/255,v.screenObj.render(),m.translate(o,s),m.rotate(r),m.scale(u,a),d==null?m.drawImage(g,-i,-e):m.drawImage(g,d.x,d.y,d.width,d.height,-i,-e,d.width,d.height),m.scale(1/u,1/a),m.rotate(-r),m.translate(-o,-s),m.globalAlpha=l,c.commands.resetImageData(v)}f(I,"drawItem")}f(qe,"init");function ze(t){let c=t._.data,E=t._.wait,C=t._.resume;t._.addCommand("loadFont",b,!1,!1,["fontSrc","width","height","charSet","isEncoded"]);function b(s){let r=s[0],i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=!!s[4];if(isNaN(i)||isNaN(e)){let m=new TypeError("loadFont: width and height must be integers.");throw m.code="INVALID_FONT_SIZE",m}if(!n){n=[];for(let m=0;m<256;m+=1)n.push(m)}if(!(t.util.isArray(n)||typeof n=="string")){let m=new TypeError("loadFont: charSet must be an array or a string.");throw m.code="INVALID_CHARSET",m}if(typeof n=="string"){let m=[];for(let l=0;l<n.length;l+=1)m.push(n.charCodeAt(l));n=m}let u={};for(let m=0;m<n.length;m+=1)u[n[m]]=m;let a={id:c.nextFontId,width:i,height:e,data:[],chars:u,charSet:n,colorCount:2,mode:"pixel",printFunction:c.commands.piPrint,calcWidth:c.commands.piCalcWidth,image:null,sWidth:i,sHeight:e};return d||(a.mode="bitmap",a.printFunction=c.commands.bitmapPrint),c.fonts[a.id]=a,c.nextFontId+=1,d?T(r,i,e,a):j(r,a),a.id}f(b,"loadFont");function T(s,r,i,e){e.data=M(s,r,i)}f(T,"loadFontFromBase32Encoded");function M(s,r,i){let d="",u=[];s=""+s;let a=s.split(",");for(let l=0;l<a.length;l++){let p=parseInt(a[l],32).toString(2);for(let w=p.length;w<32;w++)p="0"+p;d+=p}let m=0;if(d.length%32>0)return console.warn("loadFont: Invalid font data."),u;for(;m<d.length;){u.push([]);let l=u.length-1;for(let p=0;p<i;p+=1){u[l].push([]);for(let w=0;w<r;w+=1){let y;m>=d.length?y=0:(y=parseInt(d[m]),isNaN(y)&&(y=0)),u[l][p].push(y),m+=1}}}return u}f(M,"decompressFont");function j(s,r){let i;if(typeof s=="string")i=new Image,i.src=s;else if(s instanceof HTMLImageElement)i=s;else{let e=new TypeError("loadFont: fontSrc must be a string, image or canvas.");throw e.code="INVALID_FONT_SOURCE",e}i.complete?r.image=i:(E(),i.onload=function(){r.image=i,C()},i.onerror=function(e){console.warn("loadFont: unable to load image for font."),C()})}f(j,"loadFontFromImg"),t._.addCommand("setDefaultFont",S,!1,!1,["fontId"]),t._.addSetting("defaultFont",S,!1,["fontId"]);function S(s){let r=parseInt(s[0]);if(isNaN(r)||r<0||!c.fonts[r]){let i=new Error("setDefaultFont: invalid fontId");throw i.code="INVALID_FONT_ID",i}c.defaultFont=c.fonts[r]}f(S,"setDefaultFont"),t._.addCommand("setFont",P,!1,!0,["fontId"]),t._.addSetting("font",P,!0,["fontId"]);function P(s,r){let i=r[0];if(c.fonts[i]){let e=c.fonts[i];s.printCursor.font=e,s.printCursor.cols=Math.floor(s.width/e.width),s.printCursor.rows=Math.floor(s.height/e.height)}else if(typeof i=="string"){s.context.font=i,s.context.textBaseline="top";let e=A(s.context);s.printCursor.font={name:s.context.font,width:e.width,height:e.height,mode:"canvas",printFunction:c.commands.canvasPrint,calcWidth:c.commands.canvasCalcWidth},s.printCursor.cols=Math.floor(s.width/e.width),s.printCursor.rows=Math.floor(s.height/e.height)}}f(P,"setFont");function A(s){let r=s.measureText("M").width;r=Math.round(r*1.5);let i=document.createElement("canvas");i.width=r,i.height=r;let e=i.getContext("2d",{willReadFrequently:!0});e.font=s.font,e.textBaseline="top",e.fillStyle="#FF0000";let n={height:0,width:0};e.fillText("M",0,0);let d=e.getImageData(0,0,r,r).data;for(let u=0;u<r;u++)for(let a=0;a<r;a++){let m=(u*r+a)*4;d[m+3]>0&&(a>n.width&&(n.width=a),u>n.height&&(n.height=u))}return n.width+=1,n.height+=1,n}f(A,"calcFontSize"),t._.addCommand("canvasPrint",h,!0,!1);function h(s,r,i,e){s.context.fillStyle=s.fColor.s,s.context.fillText(r,i,e)}f(h,"canvasPrint"),t._.addCommand("bitmapPrint",I,!0,!1);function I(s,r,i,e){s.screenObj.render();let n=s.printCursor.font,d=n.image.width,u=Math.floor(d/n.sWidth);for(let a=0;a<r.length;a++){let m=n.chars[r.charCodeAt(a)],l=m%u*n.sWidth,p=Math.floor(m/u)*n.sHeight;s.context.drawImage(n.image,l,p,n.sWidth,n.sHeight,i+n.width*a,e,n.width,n.height)}}f(I,"bitmapPrint"),t._.addCommand("getAvailableFonts",v,!1,!1,[]);function v(){let s=[];for(let r in c.fonts)s.push({id:c.fonts[r].id,width:c.fonts[r].width,height:c.fonts[r].height});return s}f(v,"getAvailableFonts"),t._.addCommand("setFontSize",g,!1,!0,["width","height"]),t._.addSetting("fontSize",g,!0,["width","height"]);function g(s,r){let i=r[0],e=r[1];if(isNaN(i)){let n=new TypeError("setFontSize: width must be a number");throw n.code="INVALID_WIDTH",n}if(isNaN(e)){let n=new TypeError("setFontSize: height must be a number");throw n.code="INVALID_HEIGHT",n}if(s.printCursor.font.mode!=="bitmap"){console.warn("setFontSize: only bitmap fonts can change sizes");return}s.printCursor.font.width=i,s.printCursor.font.height=e,s.printCursor.cols=Math.floor(s.width/i),s.printCursor.rows=Math.floor(s.height/e)}f(g,"setFontSize"),t._.addCommand("setChar",o,!1,!0,["code","data"]),t._.addSetting("char",o,!0,["code","data"]);function o(s,r){let i=r[0],e=r[1];if(s.printCursor.font.mode!=="pixel"){console.warn("setChar: only pixel fonts can change characters");return}if(typeof i=="string"?i=i.charCodeAt(0):i=Math.round(i),isNaN(i)){let n=new TypeError("setChar: code must be an integer or a string");throw n.code="INVALID_CODE",n}if(typeof e=="string")e=t.util.hexToData(e,s.printCursor.font.width,s.printCursor.font.height);else if(t.util.isArray(e)){if(e.length!==s.printCursor.font.height){let n=new RangeError("setChar: data array is the wrong length");throw n.code="INVALID_DATA_LENGTH",n}for(let n=0;n<e.length;n++){if(e[n].length!==s.printCursor.font.width){let d=new RangeError("setChar: data array row is the wrong length");throw d.code="INVALID_DATA_WIDTH",d}for(let d=0;d<e[n].length;d++)if(!t.util.isInteger(e[n][d])){let u=new TypeError("setChar: data array contains invalid data");throw u.code="INVALID_DATA_VALUE",u}}}else{let n=new TypeError("setChar: data must be a string or an array");throw n.code="INVALID_DATA_TYPE",n}s.printCursor.font.data[i]=e}f(o,"setChar")}f(ze,"init");function We(t){let c=t._.data;t._.addCommand("print",E,!1,!0,["msg","inLine","isCentered"]);function E(o,s){let r=s[0],i=s[1],e=s[2];if(o.printCursor.font.height>o.height)return;r===void 0?r="":typeof r!="string"&&(r=""+r),r=r.replace(/\t/g,"    ");let n=r.split(/\n/);for(let d=0;d<n.length;d++)C(o,n[d],i,e)}f(E,"print");function C(o,s,r,i){let e=o.printCursor,n=e.font.calcWidth(o,s);if(i&&(e.x=Math.floor((e.cols-s.length)/2)*o.printCursor.font.width),!r&&!i&&n+e.x>o.width&&s.length>1){let d=n+e.x-o.width,a=(n-d)/n,m=Math.floor(s.length*a),l=s.substring(0,m),p=s.substring(m,s.length);if(e.breakWord){let w=l.lastIndexOf(" ");w>-1&&(p=l.substring(w).trim()+p,l=l.substring(0,w))}C(o,l,r,i),C(o,p,r,i);return}e.y+e.font.height>o.height&&(e.font.mode==="canvas"&&o.screenObj.render(),b(o,e.font.height),e.y-=e.font.height),e.font.printFunction(o,s,e.x,e.y),r?(e.x+=e.font.width*s.length,e.x>o.width-e.font.width&&(e.x=0,e.y+=e.font.height)):(e.y+=e.font.height,e.x=0)}f(C,"startPrint");function b(o,s){if(s<=0)return;c.commands.getImageData(o);let r=s;for(;r<o.height;r++)for(let i=0;i<o.width;i++){let e=(o.width*r+i)*4,n=(o.width*(r-s)+i)*4,d=o.imageData.data;o.imageData.data[n]=d[e],o.imageData.data[n+1]=d[e+1],o.imageData.data[n+2]=d[e+2],o.imageData.data[n+3]=d[e+3]}for(r=o.height-s;r<o.height;r++)for(let i=0;i<o.width;i++){let e=(o.width*r+i)*4;o.imageData.data[e]=0,o.imageData.data[e+1]=0,o.imageData.data[e+2]=0,o.imageData.data[e+3]=0}c.commands.setImageDirty(o)}f(b,"shiftImageUp"),t._.addCommand("piCalcWidth",T,!0,!1);function T(o,s){return o.printCursor.font.width*s.length}f(T,"piCalcWidth"),t._.addCommand("canvasCalcWidth",M,!0,!1);function M(o,s){return o.context.measureText(s).width}f(M,"canvasCalcWidth"),t._.addCommand("setWordBreak",j,!1,!0,["isEnabled"]),t._.addSetting("wordBreak",j,!0,["isEnabled"]);function j(o,s){o.printCursor.breakWord=!!s[0]}f(j,"setWordBreak"),t._.addCommand("piPrint",S,!0,!1);function S(o,s,r,i){let e=o.printCursor,n=o.pal;o.pal=[o.pal[0],o.fColor];for(let d=0;d<s.length;d++){let u=e.font.chars[s.charCodeAt(d)];u!==void 0&&e.font.data[u]&&o.screenObj.put(e.font.data[u],r+d*e.font.width,i,!1)}o.pal=n}f(S,"piPrint"),t._.addCommand("setPos",P,!1,!0,["col","row"]),t._.addSetting("pos",P,!0,["col","row"]);function P(o,s){let r=s[0],i=s[1];if(r!=null){if(isNaN(r)){let n=new TypeError("setPos: parameter col must be a number");throw n.code="INVALID_COL",n}let e=Math.floor(r*o.printCursor.font.width);e>o.width&&(e=o.width-o.printCursor.font.width),o.printCursor.x=e}if(i!=null){if(isNaN(i)){let n=new TypeError("setPos: parameter row must be a number");throw n.code="INVALID_ROW",n}let e=Math.floor(i*o.printCursor.font.height);e>o.height&&(e=o.height-o.printCursor.font.height),o.printCursor.y=e}}f(P,"setPos"),t._.addCommand("setPosPx",A,!1,!0,["x","y"]),t._.addSetting("posPx",A,!0,["x","y"]);function A(o,s){let r=s[0],i=s[1];if(r!=null){if(isNaN(r)){let e=new TypeError("setPosPx: parameter x must be an integer");throw e.code="INVALID_X",e}o.printCursor.x=Math.round(r)}if(i!=null){if(isNaN(i)){let e=new TypeError("setPosPx: parameter y must be an integer");throw e.code="INVALID_Y",e}o.printCursor.y=Math.round(i)}}f(A,"setPosPx"),t._.addCommand("getPos",h,!1,!0,[]);function h(o){return{col:Math.floor(o.printCursor.x/o.printCursor.font.width),row:Math.floor(o.printCursor.y/o.printCursor.font.height)}}f(h,"getPos"),t._.addCommand("getCols",I,!1,!0,[]);function I(o){return o.printCursor.cols}f(I,"getCols"),t._.addCommand("getRows",v,!1,!0,[]);function v(o){return o.printCursor.rows}f(v,"getRows"),t._.addCommand("getPosPx",g,!1,!0,[]);function g(o){return{x:o.printCursor.x,y:o.printCursor.y}}f(g,"getPosPx")}f(We,"init");function Ke(t){let c=t._.data,E={single:[[218,196,194,191],[195,196,197,180],[192,196,193,217],[179,32,179]],double:[[201,205,203,187],[204,205,206,185],[200,205,202,188],[186,32,186]],singleDouble:[[213,205,209,184],[198,205,216,181],[212,205,207,190],[179,32,179]],doubleSingle:[[214,196,210,183],[199,196,215,182],[211,196,208,189],[186,32,186]],thick:[[219,223,219,219],[219,223,219,219],[223,223,223,223],[219,32,219]]};t._.addCommand("printTable",C,!1,!0,["items","tableFormat","borderStyle","isCentered"]);function C(A,h){let I=h[0],v=h[1],g=h[2],o=!!h[3];if(!t.util.isArray(I)){let r=new TypeError("printTable: items must be an array");throw r.code="INVALID_ITEMS",r}g||(g=E.single);let s;if(v==null)s=!1;else if(t.util.isArray(v)){for(let r=0;r<v.length;r++)if(typeof v[r]!="string"){let i=new TypeError("printTable: tableFormat must be an array of strings");throw i.code="INVALID_FORMAT",i}s=!0}else{let r=new TypeError("printTable: tableFormat must be an array");throw r.code="INVALID_FORMAT",r}if(typeof g=="string"&&E[g])g=E[g];else if(!t.util.isArray(g)){let r=new TypeError("printTable: borderStyle must be an integer or array");throw r.code="INVALID_BORDER_STYLE",r}if(s)return T(A,I,g,v,o);{let r=c.commands.getCols(A);return b(A,I,r,g)}}f(C,"printTable");function b(A,h,I,v){let g="",o=[],s=A.printCursor.font,r=c.commands.getPos(A),i=2;for(let e=0;e<h.length;e+=1){let n=Math.floor(I/h[e].length);n<3&&(n=3);let d=(n-2)*h[e].length+h[e].length+1,u=Math.round((I-d)/2),a=t.util.padL("",u," "),m=a,l=a;for(let p=0;p<h[e].length;p+=1){j(p*(n-1)+u,e*2+r.row,o,s);let w=o[o.length-1];w.pos.width=n-1,w.pos.height=2,w.pixels.width=w.pos.width*s.width,w.pixels.height=w.pos.height*s.height,p===h[e].length-1&&(w.pixels.width+=1),e===h.length-1&&(w.pixels.height+=1),m+=String.fromCharCode(v[3][0])+t.util.pad(h[e][p],n-2,String.fromCharCode(v[3][1])),p===h[e].length-1&&(m+=String.fromCharCode(v[3][2])),e===0&&(p===0?a+=String.fromCharCode(v[0][0]):a+=String.fromCharCode(v[0][2]),a+=t.util.pad("",n-2,String.fromCharCode(v[0][1])),p===h[e].length-1&&(a+=String.fromCharCode(v[0][3])));let y;e===h.length-1?y=2:y=1,p===0?l+=String.fromCharCode(v[y][0]):l+=String.fromCharCode(v[y][2]),l+=t.util.pad("",n-2,String.fromCharCode(v[y][1])),p===h[e].length-1&&(l+=String.fromCharCode(v[y][3]))}e===0&&(g+=a+`
`),g+=m+`
`,g+=l+`
`}return g=g.substr(0,g.length-1),c.commands.print(A,[g]),o}f(b,"buildStandardTable");function T(A,h,I,v,g){let o="",s=[],r=c.commands.getPos(A),i=A.printCursor.font;g&&(r.col=Math.floor((c.commands.getCols(A)-v[0].length)/2));let e=t.util.pad("",r.col," ");c.commands.setPos(A,[0,r.row]);for(let u=0;u<v.length;u+=1){o+=e;for(let a=0;a<v[u].length;a+=1){let m=v[u].charAt(a);if(m==="*"){let l=""+P(a,u,"left",v)+P(a,u,"right",v)+P(a,u,"up",v)+P(a,u,"down",v);l===" - |"?(o+=String.fromCharCode(I[0][0]),j(r.col+a,r.row+u,s,i)):l==="-- |"?(o+=String.fromCharCode(I[0][2]),j(r.col+a,r.row+u,s,i)):l==="-  |"?o+=String.fromCharCode(I[0][3]):l===" -||"?(o+=String.fromCharCode(I[1][0]),j(r.col+a,r.row+u,s,i)):l==="--||"?(o+=String.fromCharCode(I[1][2]),j(r.col+a,r.row+u,s,i)):l==="- ||"?o+=String.fromCharCode(I[1][3]):l===" -| "?o+=String.fromCharCode(I[2][0]):l==="--| "?o+=String.fromCharCode(I[2][2]):l==="- | "&&(o+=String.fromCharCode(I[2][3]))}else m==="-"?o+=String.fromCharCode(I[0][1]):m==="|"?o+=String.fromCharCode(I[3][0]):o+=" "}o+=`
`}let n=c.commands.getPos(A);S(s,v,i,r),o=o.substr(0,o.length-1),c.commands.print(A,[o]);let d=0;for(let u=0;u<h.length;u+=1)if(t.util.isArray(h[u]))for(let a=0;a<h[u].length;a+=1)d<s.length&&(M(A,s[d],h[u][a],r.col),d+=1);else M(A,s[d],h[u],r.col),d+=1;return c.commands.setPos(A,[0,n.row+v.length]),s}f(T,"buildFormatedTable");function M(A,h,I){if(!h)return;I=""+I;let v=h.pos.width,g=h.pos.height,o=h.format.toLowerCase()==="v";o?I.length>g&&(I=I.substr(0,g)):I.length>v&&(I=I.substr(0,v));let s=c.commands.getPos(A);if(o){let r=0,i=h.pos.col+Math.round(v/2),e=h.pos.row+1+Math.floor((g-I.length)/2);for(let n=e;n<=g+e;n+=1)c.commands.setPos(A,[i,n]),c.commands.print(A,[I.charAt(r),!0]),r+=1}else{let r=h.pos.col+1+Math.floor((v-I.length)/2),i=h.pos.row+Math.round(g/2);c.commands.setPos(A,[r,i]),c.commands.print(A,[I,!0])}c.commands.setPos(A,[s.col,s.row])}f(M,"printItem");function j(A,h,I,v){I.push({pos:{col:A,row:h,width:null,height:null},pixels:{x:A*v.width+Math.round(v.width/2)-1,y:h*v.height+Math.round(v.height/2),width:null,height:null},format:" "})}f(j,"createBox");function S(A,h,I,v){for(let g=0;g<A.length;g+=1){let o=A[g],s=o.pos.col+1-v.col,r=o.pos.row+1-v.row;for(r<h.length&&s<h[r].length&&(o.format=h[r].charAt(s)),s=o.pos.col-v.col,r=o.pos.row-v.row;s<h[r].length-1;)if(s+=1,h[r].charAt(s)==="*"&&P(s,r,"down",h)==="|"){o.pos.width=v.col+(s-1)-o.pos.col,o.pixels.width=(o.pos.width+1)*I.width;break}for(o.pos.width===null&&(o.pos.width=v.col+(s-1)-o.pos.col,o.pixels.width=(o.pos.width+1)*I.width+1);r<h.length-1;)if(r+=1,h[r].charAt(s)==="*"&&P(s,r,"left",h)==="-"){o.pos.height=v.row+(r-1)-o.pos.row,o.pixels.height=(o.pos.height+1)*I.height;break}o.pos.height===null&&(o.pos.height=v.row+(r-1)-o.pos.row,o.pixels.height=(o.pos.height+1)*I.height+1)}}f(S,"completeBoxes");function P(A,h,I,v){return I==="left"?A-=1:I==="right"?A+=1:I==="up"?h-=1:I==="down"&&(h+=1),h>=v.length||h<0||A<0||A>=v[h].length?" ":v[h].charAt(A)==="*"&&(I==="left"||I==="right")?"-":v[h].charAt(A)==="*"&&(I==="up"||I==="down")?"|":v[h].charAt(A)}f(P,"lookCell")}f(Ke,"init");function Ge(t){let c=t._.data,E={},C={},b={},T=[],M=0,j={},S={},P={},A=!1,h=null,I={},v=[],g=0,o=null,s=!1,r=0,i=null,e=0,n=!1;t._.addCommand("startKeyboard",d,!1,!1,[]);function d(){if(n)return;let N=h||c.defaultInputFocus||window;N&&(N.addEventListener("keydown",a),N.addEventListener("keyup",m),N.addEventListener("blur",l),n=!0)}f(d,"startKeyboard"),t._.addCommand("stopKeyboard",u,!1,!1,[]);function u(){if(E={},C={},b={},T=[],m_onkeyListeners={},P={},!n)return;let N=h||c.defaultInputFocus||window;N&&(N.removeEventListener("keydown",a),N.removeEventListener("keyup",m),N.removeEventListener("blur",l)),n=!1}f(u,"stopKeyboard");function a(N){let L=N.key,F=N.code,V=N.keyCode,B={key:N.key,location:N.location,code:N.code,keyCode:N.keyCode};E[L]=B,C[V]=B,b[F]=B,T.push(B),(I[L]||I[F]||I[V])&&N.preventDefault(),A&&p("down",L,F)}f(a,"onKeyDown");function m(N){let L=N.key,F=N.code,V=N.keyCode;E[L]=!1,b[F]=!1,C[V]=!1,A&&p("up",L,F)}f(m,"onKeyUp");function l(){for(let N in E)E[N]=!1;for(let N in C)C[N]=!1;for(let N in b)b[N]=!1}f(l,"clearPressedKeys");function p(N,L,F){let V=j[L];if(V&&V[N])for(let B=V[N].length-1;B>=0;B--){let z=V[N][B];z.fn({key:L,code:F,mode:N}),z.once&&V[N].splice(B,1)}if(F&&F!==L){let B=j[F];if(B&&B[N])for(let z=B[N].length-1;z>=0;z--){let W=B[N][z];W.fn({key:L,code:F,mode:N}),W.once&&B[N].splice(z,1)}}if(S[N])for(let B=S[N].length-1;B>=0;B--){let z=S[N][B];z.fn({key:L,code:F,mode:N}),z.once&&S[N].splice(B,1)}}f(p,"triggerKeyEventListeners"),t._.addCommand("inkey",w,!1,!1,["key"]);function w(N){let L=N[0];if(d(),L!=null)return E[L]?E[L]:C[L]?C[L]:b[L]||!1;let F={};for(let V in b)b[V]&&(F[V]=b[V]);return F}f(w,"inkey"),t._.addCommand("onkey",y,!1,!1,["key","mode","fn","once"]);function y(N){let L=N[0],F=N[1]||"down",V=N[2],B=!!N[3];if(d(),A=!0,!t.util.isFunction(V)){let z=new TypeError("onkey: fn must be a function");throw z.code="INVALID_CALLBACK",z}if(L==null||L==="*"){S[F]||(S[F]=[]),S[F].push({fn:V,once:B});return}j[L]||(j[L]={}),j[L][F]||(j[L][F]=[]),j[L][F].push({fn:V,once:B})}f(y,"onkey"),t._.addCommand("offkey",x,!1,!1,["key","mode","fn"]);function x(N){let L=N[0],F=N[1]||"down",V=N[2];if(L==null||L==="*"){S[F]&&(V?S[F]=S[F].filter(B=>B.fn!==V):S[F]=[]);return}j[L]&&j[L][F]&&(V?j[L][F]=j[L][F].filter(B=>B.fn!==V):j[L][F]=[])}f(x,"offkey"),t._.addCommand("preventKey",_,!1,!1,["key","isPrevent"]);function _(N){let L=N[0];N[1]!==!1?I[L]=!0:delete I[L]}f(_,"preventKey"),t._.addCommand("clearKeys",k,!1,!1,[]);function k(){E={},C={},b={},T=[],M=0}f(k,"clearKeys"),t._.addCommand("reinitKeyboard",R,!0,!1);function R(){n&&(u(),h=c.defaultInputFocus,d())}f(R,"reinitKeyboard"),t._.addCommand("setInputFocus",O,!1,!0,["element"]);function O(N,L){let F=L[0];if(typeof F=="string"&&(F=document.getElementById(F)),!F||!t.util.canAddEventListeners(F)){let V=new TypeError("setInputFocus: Invalid element.");throw V.code="INVALID_ELEMENT",V}h=F,n&&(u(),d())}f(O,"setInputFocus"),t._.addCommand("onkeyCombo",Y,!1,!1,["keys","fn","once"]);function Y(N){let L=N[0],F=N[1],V=!!N[2];if(!t.util.isArray(L)||L.length===0){let K=new TypeError("onkeyCombo: keys must be a non-empty array");throw K.code="INVALID_KEYS",K}if(!t.util.isFunction(F)){let K=new TypeError("onkeyCombo: fn must be a function");throw K.code="INVALID_CALLBACK",K}let B=L.join("+"),z=[],W={keys:L.slice(),keyData:[],fn:F,allKeys:z,once:V};P[B]||(P[B]=[]),P[B].push(W);for(let K=0;K<L.length;K++)H(L[K],K,z,F,V,W)}f(Y,"onkeyCombo");function H(N,L,F,V,B,z){z.keyData.push({key:N,keyComboDown:W,keyComboUp:K}),F.push(!1),y([N,"down",W,!1]),y([N,"up",K,!1]);function W(J){F[L]=!0,F.indexOf(!1)===-1&&(B&&(x([N,"down",W]),x([N,"up",K])),V(J))}f(W,"keyComboDown");function K(J){F[L]=!1}f(K,"keyComboUp")}f(H,"addKeyCombo"),t._.addCommand("offkeyCombo",q,!1,!1,["keys","fn"]);function q(N){let L=N[0],F=N[1];if(!t.util.isArray(L))return;let V=L.join("+");if(P[V]){for(let B=P[V].length-1;B>=0;B--){let z=P[V][B];if(!F||z.fn===F){for(let W=0;W<z.keyData.length;W++){let K=z.keyData[W];x([K.key,"down",K.keyComboDown]),x([K.key,"up",K.keyComboUp])}P[V].splice(B,1)}}P[V].length===0&&delete P[V]}}f(q,"offkeyCombo"),t._.addCommand("input",$,!1,!0,["prompt","callback","isNumber","isInteger","allowNegative"]);function $(N,L){let F=L[0]||"",V=L[1],B=!!L[2],z=!!L[3],W=L[4]!==!1;if(typeof F!="string"){let D=new TypeError("input: prompt must be a string");throw D.code="INVALID_PROMPT",D}if(V!=null&&!t.util.isFunction(V)){let D=new TypeError("input: callback must be a function");throw D.code="INVALID_CALLBACK",D}let K,J,Je=new Promise((D,et)=>{K=D,J=et}),De={prompt:F,isNumber:B,isInteger:z,allowNegative:W,val:"",callback:V,resolve:K,reject:J,screenData:N};return v.push(De),v.length===1&&X(),Je}f($,"input");function X(){d(),v[g]&&(r=Date.now(),i=null,e=0,o||(o=setInterval(Q,100)),y([null,"down",Z,!1]))}f(X,"startInputCollection");function Z(N){let L=v[g];if(!L)return;let F=!1;if(N.key==="Enter")me(L);else if(N.key==="Backspace")L.val.length>0&&(L.val=L.val.substring(0,L.val.length-1));else if(N.key&&N.key.length===1){if(L.isNumber&&L.allowNegative){if(N.key==="-"&&L.val.length===0){L.val="-";return}else if(N.key==="+"&&L.val.charAt(0)==="-"){L.val=L.val.substring(1);return}}L.val+=N.key,L.isNumber&&(isNaN(Number(L.val))||L.isInteger&&N.key===".")&&(F=!0)}F&&(L.val=L.val.substring(0,L.val.length-1)),Q()}f(Z,"collectInput");function Q(N){if(v.length===0||g>=v.length)return;let L=v[g],F=L.screenData,V=L.prompt+L.val,B=Date.now();B-r>500&&(s=!s,r=B),s&&!N&&(V+=F.printCursor.prompt);let z=c.commands.getPos(F);z.row>=c.commands.getRows(F)&&(c.commands.print(F,["",!1]),c.commands.setPos(F,[z.col,z.row-1]),z=c.commands.getPos(F));let W=c.commands.getPosPx(F),K=(V.length+1)*F.printCursor.font.width,J=F.printCursor.font.height;i?e<K?(c.commands.put(F,[i,W.x,W.y,!0]),i=c.commands.get(F,[W.x,W.y,W.x+K,W.y+J])):c.commands.put(F,[i,W.x,W.y,!0]):i=c.commands.get(F,[W.x,W.y,W.x+K,W.y+J]),e=K,c.commands.print(F,[V,!0]),c.commands.setPos(F,[z.col,z.row]),c.commands.render(F)}f(Q,"showPrompt");function me(N){Q(!0),o&&(clearInterval(o),o=null),i=null,e=0,x([null,"down",Z]),he(N),c.commands.print(N.screenData,[""]),N.callback&&N.callback(N.val),N.resolve(N.val),g++,g>=v.length?(v=[],g=0):X()}f(me,"finishInput");function he(N){N.isNumber&&(N.val===""||N.val==="-"?N.val=0:(N.val=Number(N.val),N.isInteger&&(N.val=Math.floor(N.val))))}f(he,"processInputValue"),t._.addCommand("cancelInput",ve,!1,!0,[]);function ve(N){for(let L=v.length-1;L>=0;L--)v[L].screenData===N&&(v[L].reject(new Error("Input cancelled")),v.splice(L,1));o&&(clearInterval(o),o=null),x([null,"down",Z]),g=0}f(ve,"cancelInput"),t._.addCommand("setInputCursor",re,!1,!0,["cursor"]),t._.addSetting("inputCursor",re,!0,["cursor"]);function re(N,L){let F=L[0];if(t.util.isInteger(F)&&(F=String.fromCharCode(F)),typeof F!="string"){let B=new TypeError("setInputCursor: cursor must be a string or integer");throw B.code="INVALID_CURSOR",B}let V=N.printCursor.font;if(V.mode==="pixel"&&V.charset){let B=!0;for(let z=0;z<V.charset.length;z++)if(V.charset.charAt(z)===F){B=!1;break}if(B){console.warn(`setInputCursor: cursor "${F}" not found in current font charset`);return}}N.printCursor.prompt=F}f(re,"setInputCursor")}f(Ge,"init");function Ue(t){let c=t._.data;t._.addCommand("startMouse",E,!1,!0,[]);function E(n){n.mouseStarted||(n.canvas.addEventListener("mousemove",b),n.canvas.addEventListener("mousedown",T),n.canvas.addEventListener("mouseup",M),n.canvas.addEventListener("contextmenu",j),n.mouseStarted=!0)}f(E,"startMouse"),t._.addCommand("stopMouse",C,!1,!0,[]);function C(n){n.mouseStarted&&(n.canvas.removeEventListener("mousemove",b),n.canvas.removeEventListener("mousedown",T),n.canvas.removeEventListener("mouseup",M),n.canvas.removeEventListener("contextmenu",j),n.mouseStarted=!1)}f(C,"stopMouse");function b(n){let d=c.screens[n.target.dataset.screenId];d&&(S(d,n,"move"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("move",v(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("move",v(d),d.onPressEventListeners))}f(b,"mouseMove");function T(n){let d=c.screens[n.target.dataset.screenId];d&&(S(d,n,"down"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("down",v(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("down",v(d),d.onPressEventListeners),d.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",v(d),d.onClickEventListeners,"down"))}f(T,"mouseDown");function M(n){let d=c.screens[n.target.dataset.screenId];d&&(S(d,n,"up"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("up",v(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("up",v(d),d.onPressEventListeners),d.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",v(d),d.onClickEventListeners,"up"))}f(M,"mouseUp");function j(n){return n.preventDefault(),!1}f(j,"onContextMenu");function S(n,d,u){let a=n.canvas.getBoundingClientRect(),m=n.width/a.width,l=n.height/a.height;n.mouse.x=Math.floor((d.clientX-a.left)*m),n.mouse.y=Math.floor((d.clientY-a.top)*l),n.mouse.offsetX=d.offsetX,n.mouse.offsetY=d.offsetY,n.mouse.button=d.button,n.mouse.buttons=d.buttons,n.mouse.eventType=u,n.lastEvent="mouse"}f(S,"updateMouse"),t._.addCommand("inmouse",P,!1,!0,[]);function P(n){return c.commands.startMouse(n),v(n)}f(P,"inmouse"),t._.addCommand("onmouse",A,!1,!0,["mode","fn","once"]);function A(n,d){let u=d[0]||"down",a=d[1],m=!!d[2];if(c.commands.startMouse(n),!t.util.isFunction(a)){let l=new TypeError("onmouse: fn must be a function");throw l.code="INVALID_CALLBACK",l}n.onMouseEventListeners||(n.onMouseEventListeners={},n.mouseEventListenersActive=0),n.onMouseEventListeners[u]||(n.onMouseEventListeners[u]=[]),n.onMouseEventListeners[u].push({fn:a,once:m}),n.mouseEventListenersActive++}f(A,"onmouse"),t._.addCommand("offmouse",h,!1,!0,["mode","fn"]);function h(n,d){let u=d[0]||"down",a=d[1];if(n.onMouseEventListeners&&n.onMouseEventListeners[u])if(a){let m=n.onMouseEventListeners[u].length;n.onMouseEventListeners[u]=n.onMouseEventListeners[u].filter(l=>l.fn!==a),n.mouseEventListenersActive-=m-n.onMouseEventListeners[u].length}else n.mouseEventListenersActive-=n.onMouseEventListeners[u].length,n.onMouseEventListeners[u]=[]}f(h,"offmouse"),t._.addCommand("triggerEventListeners",I,!0,!1);function I(n,d,u,a){if(!(!u||!u[n]))for(let m=u[n].length-1;m>=0;m--){let l=u[n][m];l.fn(d,a),l.once&&u[n].splice(m,1)}}f(I,"triggerEventListeners"),t._.addCommand("getMouse",v,!0,!0,[]);function v(n){return{x:n.mouse.x,y:n.mouse.y,lastX:n.mouse.lastX,lastY:n.mouse.lastY,buttons:n.mouse.buttons,action:n.mouse.eventType,type:"mouse"}}f(v,"getMouse"),t._.addCommand("inpress",g,!1,!0,[]);function g(n){return c.commands.startMouse(n),c.commands.startTouch(n),n.lastEvent==="touch"?c.commands.getTouchPress(n):c.commands.getMouse(n)}f(g,"inpress"),t._.addCommand("onpress",o,!1,!0,["mode","fn","once","hitBox","customData"]);function o(n,d){let u=d[0],a=d[1],m=d[2],l=d[3],p=d[4];c.commands.onevent(u,a,m,l,["down","up","move"],"onpress",n.onPressEventListeners,null,null,p)&&(c.commands.startMouse(n),c.commands.startTouch(n),n.pressEventListenersActive+=1)}f(o,"onpress"),t._.addCommand("offpress",s,!1,!0,["mode","fn"]);function s(n,d){let u=d[0],a=d[1];c.commands.offevent(u,a,["down","up","move"],"offpress",n.onPressEventListeners)&&(a==null?n.pressEventListenersActive=0:(n.pressEventListenersActive-=1,n.pressEventListenersActive<0&&(n.pressEventListenersActive=0)))}f(s,"offpress"),t._.addCommand("onclick",r,!1,!0,["fn","once","hitBox","customData"]);function r(n,d){let u=d[0],a=d[1],m=d[2],l=d[3];m==null&&(m={x:0,y:0,width:c.commands.width(n),height:c.commands.height(n)}),c.commands.onevent("click",u,a,m,["click"],"onclick",n.onClickEventListeners,null,null,l)&&(c.commands.startMouse(n),c.commands.startTouch(n),n.clickEventListenersActive+=1)}f(r,"onclick"),t._.addCommand("offclick",i,!1,!0,["fn"]);function i(n,d){let u=d[0];c.commands.offevent("click",u,["click"],"offclick",n.onClickEventListeners)&&(u==null?n.clickEventListenersActive=0:(n.clickEventListenersActive-=1,n.clickEventListenersActive<0&&(n.clickEventListenersActive=0)))}f(i,"offclick"),t._.addCommand("setEnableContextMenu",e,!1,!0,["isEnabled"]),t._.addSetting("enableContextMenu",e,!0,["isEnabled"]);function e(n,d){n.isContextMenuEnabled=!!d[0],E(n)}f(e,"setEnableContextMenu")}f(Ue,"init");function He(t){let c=t._.data;t._.addCommand("startTouch",E,!1,!0,[]);function E(g){g.touchStarted||(g.canvas.addEventListener("touchstart",b),g.canvas.addEventListener("touchmove",T),g.canvas.addEventListener("touchend",M),g.canvas.addEventListener("touchcancel",M),g.touchStarted=!0)}f(E,"startTouch"),t._.addCommand("stopTouch",C,!1,!0,[]);function C(g){g.touchStarted&&(g.canvas.removeEventListener("touchstart",b),g.canvas.removeEventListener("touchmove",T),g.canvas.removeEventListener("touchend",M),g.canvas.removeEventListener("touchcancel",M),g.touchStarted=!1)}f(C,"stopTouch");function b(g){c.isTouchScreen=!0;let o=c.screens[g.target.dataset.screenId];o&&(j(o,g,"start"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("start",S(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&(c.commands.triggerEventListeners("down",I(o),o.onPressEventListeners),g.preventDefault()),o.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",I(o),o.onClickEventListeners,"down"))}f(b,"touchStart");function T(g){let o=c.screens[g.target.dataset.screenId];o&&(j(o,g,"move"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("move",S(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&(c.commands.triggerEventListeners("move",I(o),o.onPressEventListeners),g.preventDefault()))}f(T,"touchMove");function M(g){let o=c.screens[g.target.dataset.screenId];o&&(j(o,g,"end"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("end",S(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&c.commands.triggerEventListeners("up",I(o),o.onPressEventListeners),o.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",I(o),o.onClickEventListeners,"up"))}f(M,"touchEnd");function j(g,o,s){let r=g.canvas.getBoundingClientRect(),i=g.width/r.width,e=g.height/r.height;g.touch.eventType=s,g.touch.count=o.touches.length,g.touch.touches=[];for(let n=0;n<o.touches.length;n++){let d=o.touches[n];g.touch.touches.push({x:Math.floor((d.clientX-r.left)*i),y:Math.floor((d.clientY-r.top)*e),identifier:d.identifier})}g.touch.touches.length>0&&(g.touch.x=g.touch.touches[0].x,g.touch.y=g.touch.touches[0].y),g.lastEvent="touch"}f(j,"updateTouch");function S(g){return{x:g.touch.x,y:g.touch.y,count:g.touch.count,touches:g.touch.touches.slice(),eventType:g.touch.eventType}}f(S,"getTouch"),t._.addCommand("intouch",P,!1,!0,[]);function P(g){return c.commands.startTouch(g),S(g)}f(P,"intouch"),t._.addCommand("ontouch",A,!1,!0,["mode","fn","once"]);function A(g,o){let s=o[0]||"start",r=o[1],i=!!o[2];if(c.commands.startTouch(g),!t.util.isFunction(r)){let e=new TypeError("ontouch: fn must be a function");throw e.code="INVALID_CALLBACK",e}g.onTouchEventListeners||(g.onTouchEventListeners={},g.touchEventListenersActive=0),g.onTouchEventListeners[s]||(g.onTouchEventListeners[s]=[]),g.onTouchEventListeners[s].push({fn:r,once:i}),g.touchEventListenersActive++}f(A,"ontouch"),t._.addCommand("offtouch",h,!1,!0,["mode","fn"]);function h(g,o){let s=o[0]||"start",r=o[1];if(g.onTouchEventListeners&&g.onTouchEventListeners[s])if(r){let i=g.onTouchEventListeners[s].length;g.onTouchEventListeners[s]=g.onTouchEventListeners[s].filter(e=>e.fn!==r),g.touchEventListenersActive-=i-g.onTouchEventListeners[s].length}else g.touchEventListenersActive-=g.onTouchEventListeners[s].length,g.onTouchEventListeners[s]=[]}f(h,"offtouch"),t._.addCommand("getTouchPress",I,!0,!0,[]);function I(g){function o(r,i,e){for(let n in r){let d=r[n],u={x:d.x,y:d.y,id:d.id,lastX:d.lastX,lastY:d.lastY,action:d.action,type:"touch"};e!==void 0&&(d.action=e),i.push(u)}}f(o,"copyTouches");let s=[];if(o(g.touches,s),s.length===0&&o(g.lastTouches,s,"up"),s.length>0){let r=s[0];return r.action==="up"?r.buttons=0:r.buttons=1,r.touches=s,r}return{x:-1,y:-1,id:-1,lastX:-1,lastY:-1,action:"none",buttons:0,type:"touch"}}f(I,"getTouchPress"),t._.addCommand("setPinchZoom",v,!1,!1,["isEnabled"]),t._.addSetting("pinchZoom",v,!1,["isEnabled"]);function v(g){!!g[0]?document.body.style.touchAction="":document.body.style.touchAction="none"}f(v,"setPinchZoom")}f(He,"init");function Ye(t){let c=t._.data,E={},C=[],b={},T=null,M=["connect","disconnect","axis","pressed","touched","pressReleased","touchReleased"],j=!1,S=8,P=.2,A=!1;function h(){window.addEventListener("gamepadconnected",I),window.addEventListener("gamepaddisconnected",v),A=!0}f(h,"initGamepads");function I(a){E[a.gamepad.index]=a.gamepad,a.gamepad.controllerIndex=C.length,C.push(a.gamepad),o(a.gamepad),s("connect",a.gamepad.index)}f(I,"gamepadConnected");function v(a){s("disconnect",a.gamepad.index),C.splice(E[a.gamepad.index].controllerIndex,1),delete E[a.gamepad.index]}f(v,"gamepadDisconnected");function g(){let a=navigator.getGamepads?navigator.getGamepads():[];for(let m=0;m<a.length;m++)a[m]&&E[m]&&o(a[m])}f(g,"updateControllers");function o(a){let m=E[a.index];m.buttons||(m.buttons=[]),m.axes||(m.axes=[]);for(let l=0;l<a.buttons.length;l++){let p=a.buttons[l],w=m.buttons[l]||{pressed:!1,touched:!1};p.pressed&&!w.pressed&&s("pressed",a.index,l),!p.pressed&&w.pressed&&s("pressReleased",a.index,l),p.touched&&!w.touched&&s("touched",a.index,l),!p.touched&&w.touched&&s("touchReleased",a.index,l),m.buttons[l]={pressed:p.pressed,touched:p.touched,value:p.value}}for(let l=0;l<a.axes.length;l++){let p=a.axes[l],w=m.axes[l]||0;Math.abs(p-w)>P&&s("axis",a.index,l,p),m.axes[l]=p}E[a.index]=m}f(o,"updateController");function s(a,m,l,p){if(!b[m])return;let w=b[m][a];if(w){if(l!==void 0&&w[l])for(let y=w[l].length-1;y>=0;y--){let x=w[l][y];x.fn({gamepadIndex:m,mode:a,item:l,value:p,customData:x.customData}),x.once&&w[l].splice(y,1)}if(w["*"])for(let y=w["*"].length-1;y>=0;y--){let x=w["*"][y];x.fn({gamepadIndex:m,mode:a,item:l,value:p,customData:x.customData}),x.once&&w["*"].splice(y,1)}}}f(s,"triggerGamepadEvent"),t._.addCommand("ingamepads",r,!1,!1,[]);function r(){return A||h(),E&&g(),C}f(r,"ingamepads"),t._.addCommand("ongamepad",i,!1,!1,["gamepadIndex","mode","item","fn","once","customData"]);function i(a){A||h();let m=a[0],l=a[1],p=a[2],w=a[3],y=!!a[4],x=a[5];if(!t.util.isFunction(w)){let k=new TypeError("ongamepad: fn must be a function");throw k.code="INVALID_CALLBACK",k}if(m==null){let k=new TypeError("ongamepad: gamepadIndex is required");throw k.code="MISSING_GAMEPAD_INDEX",k}b[m]||(b[m]={}),b[m][l]||(b[m][l]={});let _=p!==void 0?p:"*";b[m][l][_]||(b[m][l][_]=[]),b[m][l][_].push({fn:w,once:y,customData:x}),j||n()}f(i,"ongamepad"),t._.addCommand("offgamepad",e,!1,!1,["gamepadIndex","mode","item","fn"]);function e(a){let m=a[0],l=a[1],p=a[2],w=a[3];if(!b[m]||!b[m][l])return;let y=p!==void 0?p:"*";b[m][l][y]&&(w?b[m][l][y]=b[m][l][y].filter(x=>x.fn!==w):b[m][l][y]=[])}f(e,"offgamepad");function n(){if(j)return;j=!0;function a(){j&&(g(),T=setTimeout(a,S))}f(a,"loop"),a()}f(n,"startGamepadLoop");function d(){j=!1,T&&(clearTimeout(T),T=null)}f(d,"stopGamepadLoop"),t._.addCommand("setGamepadSensitivity",u,!1,!1,["sensitivity"]);function u(a){let m=a[0];if(isNaN(m)||m<0||m>1){let l=new RangeError("setGamepadSensitivity: sensitivity must be between 0 and 1");throw l.code="INVALID_SENSITIVITY",l}P=m}f(u,"setGamepadSensitivity")}f(Ye,"init");function $e(t){let c=t._.data,E=t._.wait,C=t._.resume,b={},T=0,M=null,j={},S=0;t._.addCommand("createAudioPool",P,!1,!1,["src","poolSize"]);function P(i){let e=i[0],n=i[1];if(!e){let a=new TypeError("createAudioPool: No sound source provided");throw a.code="NO_SOURCE",a}if(n==null&&(n=1),n=Math.round(n),isNaN(n)||n<1){let a=new RangeError("createAudioPool: parameter poolSize must be an integer greater than 0");throw a.code="INVALID_POOL_SIZE",a}let d={pool:[],index:0};for(let a=0;a<n;a++){let m=new Audio(e);A(d,m)}let u="audioPool_"+T;return b[u]=d,T+=1,u}f(P,"createAudioPool");function A(i,e,n){n==null&&(n=3);function d(){i.pool.push({audio:e,timeout:0,volume:1}),e.removeEventListener("canplay",d),C()}f(d,"audioReady");function u(){let a=["MEDIA_ERR_ABORTED - fetching process aborted by user","MEDIA_ERR_NETWORK - error occurred when downloading","MEDIA_ERR_DECODE - error occurred when decoding","MEDIA_ERR_SRC_NOT_SUPPORTED - audio/video not supported"],m=e.error.code,l=m-1;l>=0&&l<a.length?(console.warn(`createAudioPool: ${a[l]}`),n>0?setTimeout(()=>{e.removeEventListener("canplay",d),e.removeEventListener("error",u);let p=new Audio(e.src);A(i,p,n-1)},100):(console.warn(`createAudioPool: Max retries exceeded for ${e.src}`),C())):(console.warn(`createAudioPool: unknown error - ${m}`),C())}f(u,"audioError"),n===3&&E(),e.addEventListener("canplay",d),e.addEventListener("error",u)}f(A,"loadAudio"),t._.addCommand("deleteAudioPool",h,!1,!1,["audioId"]);function h(i){let e=i[0];if(!b[e]){console.warn(`deleteAudioPool: audio ID ${e} not found.`);return}for(let n=0;n<b[e].pool.length;n++){let d=b[e].pool[n];d.audio.pause(),d.audio.src="",clearTimeout(d.timeout)}delete b[e]}f(h,"deleteAudioPool"),t._.addCommand("playAudioPool",I,!1,!1,["audioId","volume","startTime","duration"]);function I(i){let e=i[0],n=i[1],d=i[2],u=i[3];if(!b[e]){console.warn(`playAudioPool: audio ID ${e} not found.`);return}let a=b[e];if(n==null&&(n=1),isNaN(n)||n<0||n>1){let p=new RangeError("playAudioPool: volume needs to be a number between 0 and 1");throw p.code="INVALID_VOLUME",p}if(d==null&&(d=0),isNaN(d)||d<0){let p=new RangeError("playAudioPool: startTime needs to be a number equal to or greater than 0");throw p.code="INVALID_START_TIME",p}if(u==null&&(u=0),isNaN(u)||u<0){let p=new RangeError("playAudioPool: duration needs to be a number equal to or greater than 0");throw p.code="INVALID_DURATION",p}let m=a.pool[a.index],l=m.audio;l.volume=c.volume*n,m.volume=n,l.currentTime=d,u>0&&(clearTimeout(m.timeout),m.timeout=setTimeout(()=>{l.pause(),l.currentTime=0},u*1e3)),l.play(),a.index+=1,a.index>=a.pool.length&&(a.index=0)}f(I,"playAudioPool"),t._.addCommand("stopAudioPool",v,!1,!1,["audioId"]);function v(i){let e=i[0];if(e==null){for(let n in b)for(let d=0;d<b[n].pool.length;d++)b[n].pool[d].audio.pause();return}if(!b[e]){console.warn(`stopAudioPool: audio ID ${e} not found.`);return}for(let n=0;n<b[e].pool.length;n++)b[e].pool[n].audio.pause()}f(v,"stopAudioPool"),t._.addCommand("sound",g,!1,!1,["frequency","duration","volume","oType","delay","attack","decay"]);function g(i){let e=Math.round(i[0]),n=i[1],d=i[2],u=i[3],a=i[4],m=i[5],l=i[6];if(isNaN(e)){let y=new TypeError("sound: frequency needs to be an integer");throw y.code="INVALID_FREQUENCY",y}if(n==null&&(n=1),isNaN(n)||n<0){let y=new RangeError("sound: duration needs to be a number equal to or greater than 0");throw y.code="INVALID_DURATION",y}if(d==null&&(d=1),isNaN(d)||d<0||d>1){let y=new RangeError("sound: volume needs to be a number between 0 and 1");throw y.code="INVALID_VOLUME",y}if(m==null&&(m=0),isNaN(m)||m<0){let y=new RangeError("sound: attack needs to be a number equal to or greater than 0");throw y.code="INVALID_ATTACK",y}if(a==null&&(a=0),isNaN(a)||a<0){let y=new RangeError("sound: delay needs to be a number equal to or greater than 0");throw y.code="INVALID_DELAY",y}if(l==null&&(l=.1),isNaN(l)){let y=new TypeError("sound: decay needs to be a number");throw y.code="INVALID_DECAY",y}u==null&&(u="triangle");let p=null;if(t.util.isArray(u)){if(u.length!==2||u[0].length===0||u[1].length===0||u[0].length!==u[1].length){let y=new TypeError("sound: oType array must be an array with two non empty arrays of equal length");throw y.code="INVALID_WAVE_TABLE",y}p=[];for(let y=0;y<u.length;y++){for(let x=0;x<u[y].length;x++)if(isNaN(u[y][x])){let _=new TypeError("sound: oType array must only contain numbers");throw _.code="INVALID_WAVE_VALUE",_}p.push(new Float32Array(u[y]))}u="custom"}else{if(typeof u!="string"){let x=new TypeError("sound: oType needs to be a string or an array");throw x.code="INVALID_TYPE",x}if(["triangle","sine","square","sawtooth"].indexOf(u)===-1){let x=new TypeError("sound: oType is not a valid type. oType must be one of the following: triangle, sine, square, sawtooth");throw x.code="INVALID_OSCILLATOR_TYPE",x}}if(!M){let y=window.AudioContext||window.webkitAudioContext;M=new y}let w=m+n+l;return c.commands.createSound("sound",M,e,d,m,n,l,w,u,p,a)}f(g,"sound"),t._.addCommand("createSound",o,!0,!1,[]);function o(i,e,n,d,u,a,m,l,p,w,y){let x=e.createOscillator(),_=e.createGain(),k=e.createGain();if(k.gain.value=c.volume,x.frequency.value=n,p==="custom"){let Y=w[0],H=w[1],q=e.createPeriodicWave(Y,H);x.setPeriodicWave(q)}else x.type=p;u===0?_.gain.value=d:_.gain.value=0,x.connect(_),_.connect(k),k.connect(e.destination);let R=e.currentTime+y;u>0&&_.gain.setValueCurveAtTime(new Float32Array([0,d]),R,u),a>0&&_.gain.setValueCurveAtTime(new Float32Array([d,.8*d]),R+u,a),m>0&&_.gain.setValueCurveAtTime(new Float32Array([.8*d,.1*d,0]),R+u+a,m),x.start(R),x.stop(R+l);let O="sound_"+S;return S+=1,j[O]={oscillator:x,master:k,audioContext:e},setTimeout(()=>{delete j[O]},(R+l)*1e3),O}f(o,"createSound"),t._.addCommand("stopSound",s,!1,!1,["soundId"]);function s(i){let e=i[0];if(e==null){for(let n in j)j[n].oscillator.stop(0);return}j[e]&&j[e].oscillator.stop(0)}f(s,"stopSound"),t._.addCommand("setVolume",r,!1,!1,["volume"]),t._.addSetting("volume",r,!1,["volume"]);function r(i){let e=i[0];if(isNaN(e)||e<0||e>1){let n=new RangeError("setVolume: volume needs to be a number between 0 and 1");throw n.code="INVALID_VOLUME",n}c.volume=e;for(let n in j)e===0?(j[n].master.gain.exponentialRampToValueAtTime(.01,j[n].audioContext.currentTime+.1),j[n].master.gain.setValueAtTime(0,j[n].audioContext.currentTime+.11)):j[n].master.gain.exponentialRampToValueAtTime(e,j[n].audioContext.currentTime+.1);for(let n in b)for(let d in b[n].pool){let u=b[n].pool[d];u.audio.volume=c.volume*u.volume}}f(r,"setVolume")}f($e,"init");function Xe(t){let c=t._.data,E={A:[27.5,55,110,220,440,880,1760,3520,7040,14080],"A#":[29.14,58.27,116.541,233.082,466.164,932.328,1864.655,3729.31,7458.62,14917.24],B:[30.87,61.74,123.471,246.942,493.883,987.767,1975.533,3951.066,7902.132,15804.264],C:[16.35,32.7,65.41,130.813,261.626,523.251,1046.502,2093.005,4186.009,8372.018],"C#":[17.32,34.65,69.296,138.591,277.183,554.365,1108.731,2217.461,4434.922,8869.844],D:[18.35,36.71,73.416,146.832,293.665,587.33,1174.659,2349.318,4698.636,9397.272],"D#":[19.45,38.89,77.782,155.563,311.127,622.254,1244.508,2489.016,4978.032,9956.064],E:[20.6,41.2,82.407,164.814,329.628,659.255,1318.51,2637.021,5274.042,10548.084],F:[21.83,43.65,87.307,174.614,349.228,698.456,1396.913,2793.826,5587.652,11175.304],"F#":[23.12,46.25,92.499,184.997,369.994,739.989,1479.978,2959.955,5919.91,11839.82],G:[24.5,49,97.999,195.998,391.995,783.991,1567.982,3135.964,6271.928,12543.856],"G#":[25.96,51.91,103.826,207.652,415.305,830.609,1661.219,3322.438,6644.876,13289.752]},C={},b=[],T=0,M=[];t._.addCommand("play",j,!1,!1,["playString"]);function j(s){let r=s[0];if(typeof r!="string"){let d=new TypeError("play: playString needs to be a string");throw d.code="INVALID_PLAY_STRING",d}let i=S(r);if(!i)return null;M=[],P(i),M.sort((d,u)=>d.time-u.time);let e=window.AudioContext||window.webkitAudioContext,n=new e;for(let d=0;d<M.length;d++){let u=M[d];u.track.sounds.push(c.commands.createSound("play",n,u.frequency,u.volume,u.attackTime,u.sustainTime,u.decayTime,u.stopTime,u.oType,u.waveTables,u.time))}}f(j,"play");function S(s){s=s.split(/\s+/).join("").toUpperCase();let r="track_"+T;T+=1;let i={id:r,notes:[],noteId:0,attackRate:.1,decayRate:.2,sustainRate:.65,fullNote:!1,tempo:60/120,noteLength:.25,pace:.875,octave:4,volume:1,type:"triangle",waveTables:null,sounds:[]};C[r]=i,b.push({id:r});let e=0;for(;e<s.length;){let n=s.charAt(e);if("ABCDEFG".indexOf(n)!==-1){let d=n,u=null,a=0;e++,e<s.length&&"#+- ".indexOf(s.charAt(e))!==-1&&(s.charAt(e)!==" "&&(d+=s.charAt(e)),e++);let m="";for(;e<s.length&&/\d/.test(s.charAt(e));)m+=s.charAt(e),e++;for(m&&(u=parseFloat(m));e<s.length&&s.charAt(e)===".";)a++,e++;i.notes.push({type:"note",note:d,length:u,dots:a});continue}if("PN".indexOf(n)!==-1){let d=n;e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;u&&i.notes.push({type:d==="P"?"pause":"noteNum",value:parseInt(u)});continue}if(n==="M"){if(e++,e<s.length){let d=s.charAt(e);if("LNSF".indexOf(d)!==-1){e++,d==="L"||d==="N"||d==="S"?i.notes.push({type:"musicStyle",value:d}):d==="F"&&i.notes.push({type:"fullNote"});continue}if("ATD".indexOf(d)!==-1){e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;if(u){let a=parseInt(u);if(a>=0&&a<=100){let m;d==="A"?m="attackRate":d==="T"?m="sustainRate":d==="D"&&(m="decayRate"),i.notes.push({type:m,value:a/100})}}continue}}continue}if("OLT".indexOf(n)!==-1){let d=n;e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;if(u){let a=parseFloat(u);d==="O"&&a>=0&&a<=7?i.notes.push({type:"octave",value:parseInt(a)}):d==="L"&&a>0?i.notes.push({type:"length",value:a}):d==="T"&&a>=32&&a<=255&&i.notes.push({type:"tempo",value:parseInt(a)})}continue}if(n==="V"){e++;let d="";for(;e<s.length&&/\d/.test(s.charAt(e));)d+=s.charAt(e),e++;if(d){let u=parseInt(d);u>=0&&u<=100&&i.notes.push({type:"volume",value:u/100})}continue}if(n==="<"){i.notes.push({type:"octaveDown"}),e++;continue}if(n===">"){i.notes.push({type:"octaveUp"}),e++;continue}if(e+6<=s.length&&s.substring(e,e+6)==="SQUARE"){i.notes.push({type:"waveform",value:"square"}),e+=6;continue}if(e+4<=s.length&&s.substring(e,e+4)==="SINE"){i.notes.push({type:"waveform",value:"sine"}),e+=4;continue}if(e+8<=s.length&&s.substring(e,e+8)==="TRIANGLE"){i.notes.push({type:"waveform",value:"triangle"}),e+=8;continue}if(e+8<=s.length&&s.substring(e,e+8)==="SAWTOOTH"){i.notes.push({type:"waveform",value:"sawtooth"}),e+=8;continue}if(n==="["){let d="",u=0;for(;e<s.length;){if(d+=s.charAt(e),s.charAt(e)==="[")u++;else if(s.charAt(e)==="]"&&(u--,u===0)){e++;break}e++}try{let a=JSON.parse(d);t.util.isArray(a)&&a.length===2&&i.notes.push({type:"wavetable",value:a})}catch{console.warn(`play: Invalid wavetable format: ${d}`)}continue}e++}return r}f(S,"createTrack");function P(s){let r=C[s];if(!r||r.noteId>=r.notes.length)return;let i=0;for(;r.noteId<r.notes.length;){let e=r.notes[r.noteId];switch(e.type){case"note":let n=A(r,e.note);if(n>0){let u=h(r,e.length,e.dots);I(r,n,i),i+=u}break;case"noteNum":if(e.value>0&&e.value<85){let u=v[e.value],a=h(r,null,0);I(r,u,i),i+=a}break;case"pause":let d=4/e.value*r.tempo;i+=d;break;case"octave":r.octave=e.value;break;case"octaveUp":r.octave<7&&r.octave++;break;case"octaveDown":r.octave>0&&r.octave--;break;case"length":r.noteLength=4/e.value;break;case"tempo":r.tempo=60/e.value;break;case"volume":r.volume=e.value;break;case"attackRate":r.attackRate=e.value;break;case"sustainRate":r.sustainRate=e.value;break;case"decayRate":r.decayRate=e.value;break;case"fullNote":r.fullNote=!0,r.pace=1;break;case"waveform":r.type=e.value;break;case"wavetable":r.waveTables=[new Float32Array(e.value[0]),new Float32Array(e.value[1])],r.type="custom";break;case"musicStyle":e.value==="L"?(r.pace=1,r.fullNote=!0):e.value==="N"?(r.pace=.875,r.fullNote=!1):e.value==="S"&&(r.pace=.75,r.fullNote=!1);break}r.noteId++}}f(P,"playTrack");function A(s,r){r=r.replace(/\+/g,"#"),r=r.replace("C-","B"),r=r.replace("D-","C#"),r=r.replace("E-","D#"),r=r.replace("F-","E"),r=r.replace("G-","F#"),r=r.replace("A-","G#"),r=r.replace("B-","A#");let i=E[r];if(!i)return 0;let e=s.octave;return e<0||e>=i.length?0:i[e]}f(A,"getNoteFrequency");function h(s,r,i){r==null?r=s.noteLength:r=4/r;let e=r*s.tempo*s.pace;if(i===1)e=e*1.5;else if(i===2)e=e*1.75;else if(i>2){let n=1,d=.5;for(let u=0;u<i;u++)n+=d,d=d/2;e=e*n}return e}f(h,"getNoteDuration");function I(s,r,i){let e=s.volume,n=h(s,null,0),d=n*s.attackRate,u=n*s.sustainRate,a=n*s.decayRate,m;s.fullNote&&d+u+a>n?m=n:m=d+u+a;let l={frequency:r,volume:e,attackTime:d,sustainTime:u,decayTime:a,stopTime:m,oType:s.type,waveTables:s.waveTables,time:i,track:s};M.push(l)}f(I,"playNote");let v=[0,16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87,32.7,34.65,36.71,38.89,41.2,43.65,46.25,49,51.91,55,58.27,61.74,65.406,69.296,73.416,77.782,82.407,87.307,92.499,97.999,103.826,110,116.541,123.471,130.813,138.591,146.832,155.563,164.814,174.614,184.997,195.998,207.652,220,233.082,246.942,261.626,277.183,293.665,311.127,329.628,349.228,369.994,391.995,415.305,440,466.164,493.883,523.251,554.365,587.33,622.254,659.255,698.456,739.989,783.991,830.609,880,932.328,987.767,1046.502,1108.731,1174.659,1244.508,1318.51,1396.913,1479.978,1567.982,1661.219,1760,1864.655,1975.533,2093.005,2217.461,2349.318,2489.016,2637.021,2793.826,2959.955,3135.964,3322.438,3520,3729.31,3951.066,4186.009,4434.922,4698.636,4978.032,5274.042,5587.652,5919.91,6271.928,6644.876,7040,7458.62,7902.132,8372.018,8869.844,9397.272,9956.064,10548.084,11175.304,11839.82,13289.752,14080,14917.24,15804.264];t._.addCommand("stopPlay",g,!1,!1,["trackId"]);function g(s){let r=s[0];if(r==null){for(let i=0;i<b.length;i++){let e=C[b[i].id];if(e){for(let n=0;n<e.sounds.length;n++){let d=e.sounds[n];c.commands.stopSound([d])}delete C[b[i].id]}}b=[];return}if(C[r]){let i=C[r];for(let e=0;e<i.sounds.length;e++){let n=i.sounds[e];c.commands.stopSound([n])}o(r)}}f(g,"stopPlay");function o(s){for(let r=0;r<b.length;r++)if(b[r].id===s){b.splice(r,1);break}delete C[s]}f(o,"removeTrack")}f(Xe,"init");function Ze(t){let c=t._.data;t._.addCommand("draw",E,!1,!0,["drawString"]);function E(C,b){let T=b[0];if(typeof T!="string"){let v=new TypeError("draw: drawString must be a string");throw v.code="INVALID_DRAW_STRING",v}T=T.toUpperCase();let M=T.match(/(#[A-Z0-9]+)/g);if(M)for(let v=0;v<M.length;v++)T=T.replace("C"+M[v],"O"+v);T=T.replace(/(TA)/gi,"T"),T=T.split(/\s+/).join("");let j=/(?=C|C#|R|B|F|G|L|A|T|D|G|H|U|E|N|M|P|S)/,S=T.split(j),P=!1,A={x:C.x,y:C.y,angle:0},h=!1,I=!1;for(let v=0;v<S.length;v++){let g=S[v].split(/(\d+)/);switch(g[0]){case"C":let o=Number(g[1]);C.screenObj.setColor(o),h=!0;break;case"O":let s=M[g[1]];C.screenObj.setColor(s),h=!0;break;case"D":{let r=t.util.getInt(g[1],1),i=t.util.degreesToRadian(90)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"E":{let r=t.util.getInt(g[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(315)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"F":{let r=t.util.getInt(g[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(45)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"G":{let r=t.util.getInt(g[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(135)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"H":{let r=t.util.getInt(g[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(225)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"L":{let r=t.util.getInt(g[1],1),i=t.util.degreesToRadian(180)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"R":{let r=t.util.getInt(g[1],1),i=t.util.degreesToRadian(0)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"U":{let r=t.util.getInt(g[1],1),i=t.util.degreesToRadian(270)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"P":case"S":{let r=t.util.getInt(g[1],0);C.screenObj.paint(C.x,C.y,r,g[0]==="S"),h=!0;break}case"A":{let r=t.util.getInt(g[1],1),i=t.util.getInt(g[3],1),e=t.util.getInt(g[5],1);I=!0,C._arcParams={radius:r,angle1:i,angle2:e};break}case"T":C.angle=t.util.degreesToRadian(t.util.getInt(g[1],1)),h=!0;break;case"M":C.x=t.util.getInt(g[1],1),C.y=t.util.getInt(g[3],1),h=!0;break;default:h=!0}if(!h)if(I&&C._arcParams){let o=C._arcParams;C.screenObj.arc(C.x,C.y,o.radius,o.angle1,o.angle2)}else C.screenObj.line(A.x,A.y,C.x,C.y);h=!1,I=!1,P&&(P=!1,C.x=A.x,C.y=A.y,C.angle=A.angle),g[0]==="N"?P=!0:A={x:C.x,y:C.y,angle:C.angle},g[0]==="B"&&(h=!0)}}f(E,"draw")}f(Ze,"init");function Qe(t){t.loadFont("0,14004,2602800,oidnrt,3po8cff,3vnhgs4,1uv77og,3hpuv70,73g00,3vjgoef,3o00000,0,71ji,k9o000,1sg,1ogoc3p,jp4ir8,19fvt51,31ovfn3,cevfh,31vrooc,1tv52h8,2g0kula,2d2hcsp,8r2jg0,3vvvj,f33opv,8efh0g,3ho84fj,2200idv,2c40237,3r4g000,87000i,3vv901h,3jptvvv,3vnjpsc,0,g8420,22h800,57p9,3p80ea7,237000i,889019,111cc02,0,88420g,g4211,28oc,140011o,1000000,11000,1s00000,400,3333100,sjam9o,1g8423,203i888,1s060ho,hg0654,2fgg1sg,1o2e01p,3p4e07,211hgg0,oi64hg,1h4e13,31g0c,o00100,gg444,41000v,v0010,1088803,2110080,sqb41o,1h4if4,20729oi,1o07421,1o0s94,19701sg,1sgf03p,3p0g03,384p4c0,14if4i8,1o8423,201o84i,s04ihg,2h40842,43o12r,1ul8g25,2blej03,28ka4s0,s97i10,1h4ib3,10729oi,140321g,ho0v21,21014i,14i6025,a4k404,1al9ok0,12a22i4,24k421,7g8og,1s06210,21g1gc3,30g0c2,42300g,2g00000,1v,o40000,1o2f3,10210s9,s003i1,1o0211,251g00c,14s700g,23gg800,6kjo4s,ge4i94,8021,g04,1884218,3180421,21000a,1ul8g01,3294i00,64i8o0,c5310,200ca30,2102ok8,g003j0,3jo0023,221000i,14i6g00,24k400,8lbsk0,a2118,14i70,2e01s44,u02230,20g0630,31g082,622019,1000001,74a5u0,sg83go,3i80i93,30110oi,1oe22jg,joqh07,17hlg4,1o2f39g,33g4u6j,2841o66,gkc971,34g0oie,e411h4,3gsi030,211osh6,423hg0,1g84720,230g8e9,c94jp4,1goi97i,133p0u8,u06pmr,1sjf94j,34i8c93,94hg0c,14i604l,3inbvgk,2603ooc,1tdvstn,3phsif4,2prfurv,2qc67i1,3ooe4n,42rp8k,gs473h,jh8ua3,561igo,ggc231,30gg842,e110oi,14c2229,i8o887,94i9si,1km94jh,301s003,2703o00,40108,3g000f4,u,40g951,108d0kc,630gg0,g84000,2a8i000,92a800,1404g28,2mkll5,1lbfvdv,2rv210g,10g8421,u10g9s,84u118,2hbka50,7oka,1s217g,11bka5e,252h8ka,ka0fg8,n8kat0,21fg0ka,lu000j,30g9s00,7g84,8421o0,g84vg,1v,84210g,1og8000,vg0084,9v210g,1og8722,252hcka,kb421s,u842,352nc00,3u00fo0,7cka5i,42p81v,vg1b,2o01r51,vg03u0,ka5fo0,3u00f,320001v,ka52h8,3o0043h,21o007,843h00,ua52,252nska,9v217s,10g84u0,7,84vvvv,3vvu000,vvvtgo,1goc60o,1goc63f,3vvo000,2e53g,hp5upf,287i90g,10g003s,2h81uh4,44no00,1ska200,18s880,etgg84,1sc94hh,3hh4u94,267k631,15jfk3p,2i9s0fb,1f0004u,2iuo01p,221so70,64i94i,3u0vg7s,gs40,e01088,1o0020g,23g0452,421042,425110,3g0800,5500kk,oi6000,400,c,1gg,12go062,252g1o2,88f000,1ose00",6,6,null,!0),t.loadFont("0,ugs,3gvtm2u,1tvmss7,vtskvf,2v710g0,g8efjg,21008e2,vfl8gs,g8e77p,311o003,f7hg00,3vvpoc7,vvu045,h8igg0,3v1mrdm,3efu71h,1ep4i8o,oi94hg,33oof4j,34233hg,u97i95,cq08mn,2pspiqc,21gsfn3,400233,2v3go40,gsv213,3jggka5,a50180,1val6h8,2h80e9j,94hj4s,3p,3jo08ef,24fjghv,gsvah0,2100842,lfjgg0,82fgg,2000044,v41000,8421,3g00098,1voa800,8477r,3g000vf,2e21000,0,8e7,4200g0,18ka000,kaf,2afih80,gug70b,33000p9,442ac0,gk4aki,1380844,0,ggg841,100g41,211100,k4fh1,1000021,fh0g00,0,2110000,f00000,0,210000g,2222200,1p2jamb,jg08ca,4213s0,1p21332,no0sh0,260k9o0,8ca97o,11o1ug8,u0k9o0,oggf4a,jg1uh1,442100,1p2h74a,jg0sh8,2f0g9o0,84000,2100042,10gg,888820,20g000f,2007o00,10820gg,2200sh0,22200g0,1p2nalq,3g08a8,2hfka40,3oi9729,ng0c98,g828o0,3oi94i9,ng1u94,e42bs0,3si8721,700c98,g9i8s0,252hfka,k80s42,4211o0,s4214i,1301ia5,c52j60,3gg8421,no12ra,2l8ka40,25il9ka,k80sh8,2h8k9o0,3oi9721,700sh8,2h8l9o3,3oi9731,1680sh8,e0k9o0,3ta4210,23g12h8,2h8k9o0,252h8k9,11012h8,2lal980,24ka22h,14812h5,4211o0,3t22222,no1og8,g843g0,210820g,g41o42,4213g0,gkh8g0,0,1v,g82000,7,17k9u0,30g8539,lg0007,h849o0,c216kq,1jc0007,hfk1o0,oi8e21,700006,2h8jo5s,30ga6i9,m80806,4211o0,4030ga,k9pg84,2a62h40,1g84210,23g000d,lalak0,mcka,k80007,h8k9o0,u4i9,323g006,2i93g8e,r6i1,700007,2g70bo0,10gu421,hg0008,2h8kpk0,h8k9,1100008,2lal980,h511,1480008,2h8jo5s,v111,7o0642,o210c0,g84010,2101g42,321300,15c0000,45,h8kbs0,1p2g8jg,309o0i0,i94hs0,o0e8nq,3g0sh6,274hs0,240c13i,13o0o06,274hs0,g0c13i,13o0007,g83gcc,1p2e8nq,3g1207,hfk1o0,1g0e8nq,3g1406,4211o0,1p2c210,23g0o06,4211o0,248a8nq,k80840,e8nq40,c0v43h,7o000c,267khk0,skifki,14o08a0,e8k9o0,12074a,jg0g40,e8k9o0,gk08ka,jg0g40,h8k9o0,1208k9,3g9p245,h8igg0,240h8ka,jg0847,2g83og8,oi8e22,ng12af,24fh0g0,3ome4it,if4c52,e212go,o0c13i,13o0c06,4211o0,88074a,jg0022,h8k9o0,1lc0f4a,k80qj0,pakq40,1p4i7g3,3g00oi9,c07g00,g04442,jg0000,v84000,fg8,g00iq6,r5cecv,15kbdiq,3s84080,842100,aaa2g,2g000k5,555000,1348p26,1268ll5,1l5d9ba,3ctreup,3erm842,4210g8,g84270,210g84e,4e10g8,ka52n8,2h8k000,fh8ka,s270,210ga5e,21eh8ka,ka52h8,2h8k00f,21eh8ka,kat0no,a52,25fg000,g8s270,0,e10g8,g8421s,842,4fo000,7s,210g842,43p0g8,7s,842,4fp0g8,g87i1s,210ga52,252p8ka,ka5i1s,3,342p8ka,katg7s,f,30ep8ka,ka5i1c,2h8k00f,30fo000,katg7c,2h8k84f,30fo000,ka52ns,f,30fp0g8,7s,2h8ka52,253o000,g87i1s,3,343p0g8,1s,2h8ka52,25fp8ka,g8vi7s,210g842,4e0000,1s,210hvvv,3vvvvvv,7v,3vvvose,se73ho,e73hos,1osfvvv,3vg0000,cqki,2i400e8,2u8ni10,1uh842,4000fq,252h8k0,3t28322,no0007,2ka5100,i94jl,2200cp,2210g80,3s8e8k9,313sc98,1voa8o0,oigoa9,mc0e83,f8c5s0,impdd,g00117,2iqbp10,oggf41,1g0sh8,2h8ka40,v07o1,3o0084f,24203s0,g41110,7o0888,8203s0,c94i10,210g842,4252go,oc0fo0,31g00cp,206co00,oi9300,0,630000,1g,721,216h8c,3h4i94g,oi2,8f0000,e73h,3000000",6,8,null,!0),t.loadFont("0,0,1v839c1,2upj0bu,1vfvmvv,31ufvru,1mftvnu,1u3g400,83gv7u,1u3g400,s7oe7u,3v7oe3s,810e3s,3v7oe3s,61s,u1g000,3vvvpu3,31ufvvv,3opi2,116cf00,3vs76dt,2upjgvv,7ge3rt,36cpj3o,u6cpj6,u1gvgo,vj6fpg,o71s70,1vm6vr3,1hmfpm0,2clkf77,3jjomkp,20e1u7u,3se1000,10sfnu,v0s0g0,c3ovgo,c7sf0o,1j6cpj6,1j00pg0,1vtnmrr,dhm6o0,v66e3c,1m3hj3o,0,1v7svg0,c3ovgo,1v3o67v,c3ovgo,c1g600,c1g60o,1v3o600,1g37u,61g000,30o7u,1g30000,1g60,30fs000,28pnv,1j28000,1gf3u,3vvu000,fvvru,u1g000,0,0,o7gu1g,o00c00,1m6or00,0,1m6pvjc,3v6or00,o7pg3o,6fgc00,cdj0o,o6dhg0,s6oe3m,3ecotg0,1g61g00,0,c30o30,1g30600,1g3060o,c30o00,6cf7v,u6c000,30c7s,o30000,0,30c30,7s,0,0,30c00,30o61g,1gc1000,1ucdjmu,3recv00,o70c1g,o31v00,1sco31o,1gcpv00,1sco31o,6cou00,e3or6c,3v0o7g0,3uc1u0c,6cou00,s61g7o,36cou00,3uco30o,o30c00,1scpj3o,36cou00,1scpj3s,61gs00,30c00,30c00,30c00,30c30,c30o60,1g30600,1v00,fo000,1g3060c,c30o00,1sco30o,o00c00,1ucdnmu,3fc0u00,o7hj6c,3ucpj00,3u6cpjs,1j6dv00,u6dg60,306cf00,3s6opj6,1j6pu00,3v64q3o,1k65vg0,3v64q3o,1k61s00,u6dg60,376cfg0,36cpj7s,36cpj00,1s30c1g,o30u00,f0o30c,36cou00,3j6cr3o,1m6dpg0,3o60o30,1h6dvg0,33etvnu,3bcdhg0,33edtmu,37cdhg0,s6phm6,336oe00,3u6cpjs,1g61s00,1scpj6c,3e7g700,3u6cpjs,1m6dpg0,1scpo3g,ecou00,3ub8c1g,o30u00,36cpj6c,36cpv00,36cpj6c,367gc00,33cdhmm,3vethg0,33ccr1o,s6phg0,36cpj3o,o30u00,3vcd30o,p6dvg0,1s60o30,1g60u00,3060c0o,60c0g0,1s1g60o,c1gu00,83gr66,0,0,7v,o30600,0,u0c,1ucotg0,3g60o3s,1j6dn00,u6c,30cou00,e0o33s,36cotg0,u6c,3uc0u00,s6oo7g,1g61s00,tmc,367o37o,3g60r3m,1j6dpg0,o00s1g,o30u00,60030c,6cpj3o,3g60pjc,1s6ppg0,1o30c1g,o30u00,1j7u,3vddhg0,1u6c,36cpj00,u6c,36cou00,1n36,1j7oo7g,tmc,367o30u,1n3m,1j61s00,v60,1s0pu00,830v1g,o38600,1j6c,36cotg0,1j6c,367gc00,1hmm,3vfsr00,1hjc,s6phg0,1j6c,367o37o,1v4o,o69v00,e30c70,o30700,c1g600,c1g600,3g30c0s,o31o00,1rdo000,0,10e3c,33cdvg0,1scpg6c,1s1g33o,co06c,36covg0,e00u6c,3uc0u00,1vc6f06,v6cfo0,3600u0c,1ucovg0,3g00u0c,1ucovg0,o30u0c,1ucovg0,u60,307g31o,1vc6f36,1v60f00,3600u6c,3uc0u00,3g00u6c,3uc0u00,3600s1g,o30u00,1ucce0o,c1gf00,3g00s1g,o30u00,333gr66,3vcdhg0,o3003o,36fpj00,e01v30,1s61v00,voc,1vsovo0,v6pj7u,36cpjg0,1sco03o,36cou00,co03o,36cou00,e003o,36cou00,1sco06c,36covg0,e006c,36covg0,co06c,367o37o,31hgf36,1j3o600,3601j6c,36cou00,c1gvm0,307s60o,s6op7g,1gedv00,36cou7s,ofoc1g,3scpj7q,33cvhm7,71m61s,c1hm3g,e00u0c,1ucovg0,s00s1g,o30u00,1o03o,36cou00,1o06c,36covg0,fg07o,36cpj00,3u01j7c,3udpj00,u6or1u,7s000,s6or1o,7o000,o00c30,30cou00,7s,30c0000,7s,60o000,31sdj6u,pmdj0f,31sdj6r,rmvjo3,c1g00o,c1g600,36pmc,1j36000,cophj,1jco000,h8g8k8,h8g8k8,1aqklda,1aqklda,3dnfmve,3dnfmve,c1g60o,c1g60o,c1g60o,3s1g60o,c1hu0o,3s1g60o,r3cdhm,3r3cdhm,0,3v3cdhm,1u0o,3s1g60o,r3dtg6,3r3cdhm,r3cdhm,r3cdhm,1vg6,3r3cdhm,r3dtg6,3v00000,r3cdhm,3v00000,c1hu0o,3s00000,0,3s1g60o,c1g60o,fg0000,c1g60o,3vg0000,0,3vhg60o,c1g60o,fhg60o,0,3vg0000,c1g60o,3vhg60o,c1g7oo,fhg60o,r3cdhm,rjcdhm,r3cdpg,vg0000,fpg,rjcdhm,r3dto0,3vg0000,1vo0,3rjcdhm,r3cdpg,rjcdhm,1vo0,3vg0000,r3dto0,3rjcdhm,c1hvo0,3vg0000,r3cdhm,3vg0000,1vo0,3vhg60o,0,3vjcdhm,r3cdhm,vg0000,c1g7oo,fg0000,7oo,fhg60o,0,vjcdhm,r3cdhm,3vjcdhm,c1hvoo,3vhg60o,c1g60o,3s00000,0,fhg60o,3vvvvvv,3vvvvvv,0,3vvvvvv,3of1s7g,3of1s7g,7gu3of,7gu3of,3vvvvvv,0,tms,34dotg0,7hj7o,36fhg60,fpj60,30c1g00,fsr3c,1m6or00,3ucoo1g,1gcpv00,vmo,3cdgs00,6cpj6,1j7oo60,7dn0o,c1g600,3u30u6c,367gc7s,s6phnu,336oe00,s6phm6,1m6prg0,e3063s,36cou00,vmr,3dns000,30ovmr,3dnso60,s61g7o,3060e00,1scpj6c,36cpj00,fo07s,fo000,o31v1g,o01v00,1g3061g,1g01v00,c30o1g,c01v00,71m6oo,c1g60o,c1g60o,cdhm3g,o3007s,30c00,7dn00,1rdo000,s6or1o,0,o,c00000,0,c00000,7go30c,3m6of0s,1s6or3c,1m00000,1o1gc30,1s00000,f1s,u3o000",6,8,null,!0),t.loadFont("0,0,0,0,1v839c1,20rr6c1,1v00000,vnv,3dvvvu3,3jvuvg0,0,6pvnu,3vfsv1o,800000,g,s7pvjs,s10000,0,c3of77,3jue60o,u00000,61s,1vfvvru,c1gf00,0,o,u3o600,0,3vvvvvv,3vufgu3,3jvvvvv,3vvu000,f36,1144phs,0,3vvvvvv,31pjfdt,2cs7vvv,3vvu000,f0s6hi,1scpj6c,1s00000,f36,1j6cf0o,1v1g600,0,vj6fpg,o30s7g,3g00000,vr3,1vm6or3,1jufpm0,0,c1hmps,3jjpmoo,c00000,1060,3gfhvno,3gc1000,0,10c3hu,3v3s3g6,100000,61s,1v1g60o,1v3o600,0,1j6cpj6,1j6c036,1j00000,vur,3dtmuor,dhm6o0,3s,3360e3c,33ccr1o,6ccv00,0,0,3vftvg0,0,c3ovgo,c1gvhs,c7s000,61s,1v1g60o,c1g600,0,c1g60o,c1gvhs,c00000,0,c0pvgc,c00000,0,c30,3v60c00,0,0,c1g60,3v00000,0,a3c,3v6oa00,0,g,s3gv3s,3vfs000,0,ftvjs,1u3ge0g,0,0,0,0,0,c3of1s,c1g00o,c00000,6cpj6,i00000,0,0,1m6pvjc,1m6pvjc,1m00000,c1gv66,31c0v06,23ccv0o,c00000,1gm6,61gc36,3300000,e3c,1m3gtms,36cotg0,1g,o30o00,0,0,30o,o30c1g,o1g300,0,o1g30c,60o30o,o00000,0,1j3pvps,1j00000,0,60o,1v1g600,0,0,0,c1g61g,0,0,3v00000,0,0,0,1g600,0,10c30o,o61g40,0,v66,37dttn6,33ccv00,0,c3gu0o,c1g60o,1v00000,v66,30o61g,1gcdvg0,0,1ucc1g6,u0c1m6,1u00000,30s,u6pj7u,60o7g0,0,3vc1g60,3u0c1m6,1u00000,e30,30c1v66,33ccv00,0,3vcc1gc,c30c1g,o00000,v66,33ccv66,33ccv00,0,1ucdhm6,1v0c1gc,1s00000,o,c00000,c1g000,0,1g600,60o,o00000,1gc,c30o1g,c0o1g0,0,3u,vg0,0,o1g,c0o1gc,c30o00,0,1ucdhgc,c1g00o,c00000,v66,33dtnmu,3ec0v00,0,83gr66,33fthm6,3300000,1v36,1j6cv36,1j6dv00,0,u6dgm0,30c1gj6,u00000,1u3c,1j6cpj6,1j6pu00,0,3v6coj8,1s6goj6,3v00000,1vj6,1h6gu38,1g61s00,0,u6dgm0,30dthj6,t00000,1hm6,33cdvm6,33cdhg0,0,u1g60o,c1g60o,u00000,7gc,60o30c,36cou00,0,3j6cr3c,1s6or36,3j00000,1s30,1g60o30,1h6dvg0,0,33etvnu,3bcdhm6,3300000,1hn6,3rftnme,33cdhg0,0,s6phm6,33cdhjc,s00000,1v36,1j6cv30,1g61s00,0,1ucdhm6,33ddnjs,60s000,1v36,1j6cv3c,1j6dpg0,0,1ucdhj0,s0phm6,1u00000,vju,1d1g60o,c1gf00,0,33cdhm6,33cdhm6,1u00000,1hm6,33cdhm6,1m3g400,0,33cdhm6,3bddvjs,1m00000,1hm6,1m3ge1o,1mcdhg0,0,1j6cpj6,u1g60o,u00000,1vm6,261gc30,31cdvg0,0,u30c1g,o30c1g,u00000,1060,3g70e0s,70c0g0,0,u0o30c,60o30c,u00000,83gr66,0,0,0,0,0,1vo0,o30600,0,0,0,3o,67pj6c,1r00000,1o30,1g7gr36,1j6cv00,0,3s,33c1g66,1u00000,70c,63or6c,36cotg0,0,3s,33ftg66,1u00000,e3c,1i61s30,1g61s00,0,3m,36cpj3s,6cou00,1o30,1g6otj6,1j6dpg0,0,c1g01o,c1g60o,u00000,1g6,s1g6,30cpj6,u00000,3g60o36,1m7gr36,3j00000,e0o,c1g60o,c1gf00,0,7c,3vddlmm,3300000,0,dopj6,1j6cpg0,0,3s,33cdhm6,1u00000,0,dopj6,1j7oo30,3o00000,3m,36cpj3s,60o7g0,0,dotj6,1g61s00,0,3s,3370766,1u00000,41g,ofoc1g,o3c700,0,6c,36cpj6c,1r00000,0,6cpj6,1j3o600,0,66,33ddlnu,1m00000,0,ccr1o,s6phg0,0,66,33cdhju,30pu00,0,ftj0o,o6dvg0,0,71g60o,1o1g60o,700000,60o,c1g00o,c1g600,0,1o1g60o,71g60o,1o00000,tms,0,0,0,41o,1mcdhnu,0,f36,31c1g62,1j3o306,1u00000,36co06c,36cpj6c,1r00000,o61g,7phnu,30ccv00,g,s6o03o,67pj6c,1r00000,1j6c,7g33s,36cotg0,30,o1g03o,67pj6c,1r00000,3gr1o,7g33s,36cotg0,0,f36,1g6cf0c,33o000,10e3c,7phnu,30ccv00,0,36co03s,33ftg66,1u00000,60c0o,7phnu,30ccv00,0,1j6c01o,c1g60o,u00000,1gf36,3g60o,c1gf00,30,o1g01o,c1g60o,u00000,cdhgg,s6phm6,3vcdhg0,e3c,s00e3c,33cdvm6,3300000,c30o00,3v6co3s,1g6dvg0,0,1j3m,r7tm6o,1n00000,fjc,36cpvmc,36cpjg0,g,s6o03s,33cdhm6,1u00000,1hm6,7phm6,33ccv00,30,o1g03s,33cdhm6,1u00000,30u6c,cpj6c,36cotg0,30,o1g06c,36cpj6c,1r00000,1hm6,cdhm6,337s1gc,1s00066,333gr66,33cdhjc,s00000,cdhg0,33cdhm6,33ccv00,o,c3opj0,1g6cf0o,c00000,3gr34,1gf0o30,1gedv00,0,1j6cf0o,1v1gvgo,c00000,fhj6c,3sc9j6u,36cphg0,e,dhg60o,1v1g60o,cdgs00,1gc30,7g33s,36cotg0,c,c3001o,c1g60o,u00000,1gc30,7phm6,33ccv00,o,o6006c,36cpj6c,1r00000,tms,dopj6,1j6cpg0,tms,cdpnm,3vdtjm6,3300000,3or3c,v00vg0,0,1o,1m6oe00,1u00000,0,c1g,30c30,33ccv00,0,0,3vc1g60,0,0,1vg6,30c000,60,30cdj6o,o61n46,61gfg0,c1g66,36dgc36,379sfg6,300000,c1g00o,c3of1s,c00000,0,r6pm3c,r00000,0,1m3c,r6pm00,0,8k84a4,8k84a4,8k84a4,8k8lda,1aqklda,1aqklda,1aqklda,3enfnbn,3enfnbn,3enfnbn,3ene60o,c1g60o,c1g60o,c1g60o,c1g60o,c1g67o,c1g60o,c1g60o,c1g67o,cfg60o,c1g60o,r3cdhm,r3cdnm,r3cdhm,r3c000,0,fsdhm,r3cdhm,0,fg67o,c1g60o,c1gdhm,r3cdnm,3fcdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3c000,7u,3fcdhm,r3cdhm,r3cdhm,rfc1nu,0,dhm,r3cdhm,rfs000,0,c1g60o,cfg67o,0,0,0,fg60o,c1g60o,c1g60o,c1g60v,0,60o,c1g60o,cfu000,0,0,7v,c1g60o,c1g60o,c1g60o,c1u60o,c1g60o,0,7v,0,60o,c1g60o,cfu60o,c1g60o,c1g60o,c1u60v,c1g60o,c1gdhm,r3cdhm,r3edhm,r3cdhm,r3cdhm,r3ec1v,0,0,1v,o3edhm,r3cdhm,r3cdhm,rfe07v,0,0,7v,fedhm,r3cdhm,r3cdhm,r3ec1n,r3cdhm,r3c000,7v,fu000,0,r3cdhm,rfe07n,r3cdhm,r3c60o,c1g67v,fu000,0,r3cdhm,r3cdnv,0,0,7v,fu60o,c1g60o,0,7v,r3cdhm,r3cdhm,r3cdhm,r3u000,0,c1g60o,c1u60v,0,0,v,c1u60o,c1g60o,0,1v,r3cdhm,r3cdhm,r3cdhm,rfudhm,r3cdhm,c1g60o,cfu67v,c1g60o,c1g60o,c1g60o,cfg000,0,0,v,c1g60o,c1hvvv,3vvvvvv,3vvvvvv,3vvvvvv,0,7v,3vvvvvv,3vvvs7g,3of1s7g,3of1s7g,3of1s7g,7gu3of,7gu3of,7gu3of,7gvvvv,3vvvvvv,3vg0000,0,0,7dn6o,3cdotg0,0,v66,3ucdhns,30c0g00,1vm6,33c1g60,30c1g00,0,1vjc,1m6or3c,1m00000,1vm6,1g3061g,1gcdvg0,0,3u,3cdhm6o,1o00000,0,1j6cpj6,1u60o60,0,tms,c1g60o,c00000,vgo,u6cpj6,u1gvg0,0,s6phm6,3vcdhjc,s00000,e3c,33cdhjc,1m6prg0,0,f3060c,v6cpj6,u00000,0,7tmur,1v00000,0,1gcvmr,3dv6vj0,3000000,71g,1g60v30,1g30700,0,7phm6,33cdhm6,3300000,7u,1vg0,fs000,0,1g63u,c1g000,3vg0000,c0o,60c30o,o00vg0,0,61gc30,o1g300,1v00000,3gr,dhg60o,c1g60o,c1g60o,c1g60o,c1hm6o,1o00000,o,c00vg0,c1g000,0,tms,7dn00,0,3gr3c,s00000,0,0,0,c1g000,0,0,o,0,f,60o30c,6eor1s,e00000,dgr3c,1m6or00,0,3g,3c30o68,3s00000,0,0,1u7ov3s,1u7o000,0",8,14,null,!0),t.loadFont("0,0,0,0,vk1,2io30dt,2co30bu,0,vnv,3dvvvu3,3jvvvru,0,0,1mftvnu,3v7oe0g,0,0,83gv7u,1u3g400,0,o,u3ppv7,3jhg61s,0,o,u7tvvv,1v1g61s,0,0,0,0,0,3vvvvvv,3vvvpu3,31ufvvv,3vvvvvv,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,vr3,1vm6or3,1hmfpv6,3000000,o,cdmf77,udm60o,0,81g70,3ofhvno,3oe1g40,0,41ge,f3tvhu,f0s1g2,0,61s,1v1g60o,1v3o600,0,pj6,1j6cpj6,1j00pj6,0,vur,3dtmuor,dhm6or,0,7phj0,s6phm6,1m3g366,1u00000,0,0,3vftvnu,0,61s,1v1g60o,1v3o63u,0,61s,1v1g60o,c1g60o,0,60o,c1g60o,c7sf0o,0,0,1g37u,61g000,0,0,30o7u,1g30000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61s,u3o60o,c0060o,0,6cpj6,i00000,0,0,3c,1mfsr3c,1mfsr3c,0,c1gv66,31c0v06,38dhjs,c1g000,0,31cc30o,o61hk6,0,e3c,1m3gtms,36cpj3m,0,30c1g,1g00000,0,0,30o,o30c1g,o3060c,0,c0o,60o30c,60o61g,0,0,6cf7v,u6c000,0,0,1g63u,c1g000,0,0,0,1g60o,o00000,0,7u,0,0,0,0,60o,0,0,10c30o,o61g40,0,f36,31s7mur,31s6phs,0,61o,1s1g60o,c1g63u,0,v66,30o61g,1gc1hnu,0,v66,30cf06,30dhjs,0,30s,u6pj7u,60o30u,0,1vm0,30c1v06,30dhjs,0,e30,30c1v66,33cdhjs,0,1vm6,30c30o,o30c1g,0,v66,33ccv66,33cdhjs,0,v66,33ccvg6,30c33o,0,0,c1g000,1g600,0,0,c1g000,1g61g,0,6,61gc30,o1g306,0,0,7s000,1v00000,0,30,o1g306,61gc30,0,v66,330o60o,c0060o,0,3s,33cdnmu,3fdpg3s,0,41o,1mcdhnu,33cdhm6,0,1v36,1j6cv36,1j6cpns,0,f36,31c1g60,30c4phs,0,1u3c,1j6cpj6,1j6cr7o,0,1vj6,1h6gu38,1g64pnu,0,1vj6,1h6gu38,1g60o7g,0,f36,31c1g6u,33ccphq,0,1hm6,33cdvm6,33cdhm6,0,f0o,c1g60o,c1g61s,0,7gc,60o30c,36cpj3o,0,1pj6,1j6ou3o,1m6cpn6,0,1s30,1g60o30,1g64pnu,0,1gv7,3vvvmu3,31s7gu3,0,1hn6,3rftnme,33cdhm6,0,v66,33cdhm6,33cdhjs,0,1v36,1j6cv30,1g60o7g,0,v66,33cdhm6,33ddnjs,60s000,1v36,1j6cv3c,1j6cpn6,0,v66,3360e0c,3cdhjs,0,1vur,2chg60o,c1g61s,0,1hm6,33cdhm6,33cdhjs,0,1gu3,31s7gu3,31mcf0o,0,1gu3,31s7gur,3dvupj6,0,1gu3,1j3o60o,u6dgu3,0,1gu3,31mcf0o,c1g61s,0,1vu3,230o61g,1gc3gvv,0,f1g,o30c1g,o30c1s,0,40,30e0s1o,e0s1g2,0,f0c,60o30c,60o31s,0,83gr66,0,0,0,0,0,0,fu000,o30600,0,0,0,0,7g33s,36cpj3m,0,1o30,1g7gr36,1j6cpjs,0,0,7phm0,30c1hjs,0,70c,63or6c,36cpj3m,0,0,7phnu,30c1hjs,0,e3c,1i61s30,1g60o7g,0,0,7dj6c,36cpj3s,6cou00,1o30,1g6otj6,1j6cpn6,0,60o,3g60o,c1g61s,0,1g6,s1g6,30c1g6,1j6cf00,1o30,1g6cr3o,1s6opn6,0,e0o,c1g60o,c1g61s,0,0,edvur,3dtnmur,0,0,dopj6,1j6cpj6,0,0,7phm6,33cdhjs,0,0,dopj6,1j6cpjs,1g61s00,0,7dj6c,36cpj3s,60o7g0,0,dotj6,1g60o7g,0,0,7phj0,s0phjs,0,41g,ofoc1g,o30dgs,0,0,cpj6c,36cpj3m,0,0,c7gu3,31mcf0o,0,0,c7gu3,3dtnvr6,0,0,c6phs,c3opm3,0,0,cdhm6,33cdhju,30pu00,0,ftj0o,o61hnu,0,3go,c1gs0o,c1g60e,0,60o,c1g00o,c1g60o,0,s0o,c1g3go,c1g63g,0,tms,0,0,0,0,83gr66,33cdvg0,0,f36,31c1g60,316cf0c,37o000,1j00,cpj6c,36cpj3m,0,o61g,7phnu,30c1hjs,0,10e3c,7g33s,36cpj3m,0,1j00,7g33s,36cpj3m,0,60c0o,7g33s,36cpj3m,0,3gr1o,7g33s,36cpj3m,0,0,u6co30,1j3o306,u00000,10e3c,7phnu,30c1hjs,0,1hg0,7phnu,30c1hjs,0,60c0o,7phnu,30c1hjs,0,pg0,3g60o,c1g61s,0,1gf36,3g60o,c1g61s,0,60c0o,3g60o,c1g61s,0,cc00g,s6phm6,3vcdhm6,0,s6oe00,s6phm6,3vcdhm6,0,c30o00,3v6co3s,1g60pnu,0,0,6seor,1vdhn3n,0,fjc,36cpvmc,36cpj6e,0,10e3c,7phm6,33cdhjs,0,1hg0,7phm6,33cdhjs,0,60c0o,7phm6,33cdhjs,0,30u6c,cpj6c,36cpj3m,0,60c0o,cpj6c,36cpj3m,0,1hg0,cdhm6,33cdhju,30ou00,cc03s,33cdhm6,33cdhjs,0,cc066,33cdhm6,33cdhjs,0,1g63u,31s1g60,31ns60o,0,3gr34,1gf0o30,1g61pns,0,1gr6,u1hvoo,3vhg60o,0,fopj6,1u64pjf,1j6cpnj,0,s6oo,c1gvgo,c1g60o,3c70000,1gc30,7g33s,36cpj3m,0,o61g,3g60o,c1g61s,0,1gc30,7phm6,33cdhjs,0,1gc30,cpj6c,36cpj3m,0,tms,dopj6,1j6cpj6,0,1rdo066,3jfdvmu,37cdhm6,0,3or3c,v00vg0,0,0,3gr3c,s00v00,0,0,c1g,30c30,30cdhjs,0,0,1vm0,30c1g00,0,0,1vg6,30c1g0,0,c1g62,33co61g,1gct6o6,61u000,c1g62,33co61g,1jct5hu,30c000,60o,1g60o,u3of0o,0,0,3cr6o,1m3c000,0,0,dgr1m,1mdg000,0,8k84a4,8k84a4,8k84a4,8k84a4,1aqklda,1aqklda,1aqklda,1aqklda,3enfnbn,3enfnbn,3enfnbn,3enfnbn,c1g60o,c1g60o,c1g60o,c1g60o,c1g60o,c1g67o,c1g60o,c1g60o,c1g60o,cfg67o,c1g60o,c1g60o,r3cdhm,r3cdnm,r3cdhm,r3cdhm,0,7u,r3cdhm,r3cdhm,0,fg67o,c1g60o,c1g60o,r3cdhm,rfc1nm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,0,fs1nm,r3cdhm,r3cdhm,r3cdhm,rfc1nu,0,0,r3cdhm,r3cdnu,0,0,c1g60o,cfg67o,0,0,0,7o,c1g60o,c1g60o,c1g60o,c1g60v,0,0,c1g60o,c1g67v,0,0,0,7v,c1g60o,c1g60o,c1g60o,c1g60v,c1g60o,c1g60o,0,7v,0,0,c1g60o,c1g67v,c1g60o,c1g60o,c1g60o,c1u60v,c1g60o,c1g60o,r3cdhm,r3cdhn,r3cdhm,r3cdhm,r3cdhm,r3ec1v,0,0,0,3uc1n,r3cdhm,r3cdhm,r3cdhm,rfe07v,0,0,0,fu07n,r3cdhm,r3cdhm,r3cdhm,r3ec1n,r3cdhm,r3cdhm,0,fu07v,0,0,r3cdhm,rfe07n,r3cdhm,r3cdhm,c1g60o,cfu07v,0,0,r3cdhm,r3cdnv,0,0,0,fu07v,c1g60o,c1g60o,0,7v,r3cdhm,r3cdhm,r3cdhm,r3cdhv,0,0,c1g60o,c1u60v,0,0,0,1u60v,c1g60o,c1g60o,0,1v,r3cdhm,r3cdhm,r3cdhm,r3cdnv,r3cdhm,r3cdhm,c1g60o,cfu67v,c1g60o,c1g60o,c1g60o,c1g67o,0,0,0,v,c1g60o,c1g60o,3vvvvvv,3vvvvvv,3vvvvvv,3vvvvvv,0,7v,3vvvvvv,3vvvvvv,3of1s7g,3of1s7g,3of1s7g,3of1s7g,7gu3of,7gu3of,7gu3of,7gu3of,3vvvvvv,3vvvvo0,0,0,0,7dn6o,3cdhn3m,0,u6c,36cpm6c,33cdhmc,0,1vm6,33c1g60,30c1g60,0,0,3v6or3c,1m6or3c,0,7u,3360c0o,o61hnu,0,0,7tm6o,3cdhm3g,0,0,1j6cpj6,1j7oo30,3000000,0,1rdo60o,c1g60o,0,3u,c3opj6,1j3o63u,0,1o,1mcdhnu,33ccr1o,0,e3c,33cdhjc,1m6or7e,0,7hg,c0ofj6,1j6cphs,0,0,7tmur,3dns000,0,3,37tmur,3pnso60,0,71g,1g60v30,1g60c0s,0,3s,33cdhm6,33cdhm6,0,0,3v0007u,1vg0,0,0,c1gvgo,c0007v,0,1g,c0o1gc,c3003u,0,c,c30o1g,c0o03u,0,3gr,dhg60o,c1g60o,c1g60o,c1g60o,c1g60o,3cdhm3g,0,0,c1g03u,1g600,0,0,7dn00,1rdo000,0,3gr3c,s00000,0,0,0,o,c00000,0,0,0,c00000,0,u30c,60o37c,1m6of0s,0,dgr3c,1m6or00,0,0,71m1g,1gchu00,0,0,0,1u7ov3s,1u7ov00,0",8,16,null,!0),t.setDefaultFont(1)}f(Qe,"loadBuiltInFonts");var Xt="2.0.0-alpha.1",ae=0,Ie=!1,fe=[],ge=0;function Zt(){ae++,Ie=!0}f(Zt,"wait");function Qt(){ae--,ae===0&&Ee()}f(Qt,"resume");function Ee(){if(document.readyState!=="loading"&&ae===0){Ie=!1;let t=fe.slice();fe.length=0;for(let c of t)c()}else clearTimeout(ge),ge=setTimeout(Ee,10)}f(Ee,"startReadyList");var G={version:Xt,_:{data:U,addCommand:de,addCommands:je,addSetting:Le,addPen:Te,addBlendCommand:ke,parseOptions:ne,wait:Zt,resume:Qt},util:le};de("ready",Jt,!1,!1,["fn"]);function Jt(t){let c=t[0];pe(c)&&(Ie?fe.push(c):document.readyState==="loading"?(fe.push(c),clearTimeout(ge),ge=setTimeout(Ee,10)):c())}f(Jt,"ready");Se(G);Pe(G);Re(G);Oe(G);Ve(G);Be(G);qe(G);ze(G);We(G);Ke(G);Ge(G);Ue(G);He(G);Ye(G);$e(G);Xe(G);Ze(G);Me(G);U.commands.setDefaultPal([be]);U.commands.setDefaultColor([7]);Fe(G);typeof window<"u"&&(window.pi=G,window.$===void 0&&(window.$=G));typeof window<"u"&&Qe(G);var Dt=G;
/**
 * Pi.js - Main Entry Point
 * 
 * Graphics and sound library for retro-style games and demos.
 * Modernized architecture with legacy API compatibility.
 * 
 * @module pi.js
 * @author Andy Stubbs
 * @license Apache-2.0
 */
//# sourceMappingURL=pi.cjs.min.js.map
