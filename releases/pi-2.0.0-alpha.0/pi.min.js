/**
 * Pi.js - Graphics and Sound Library
 * @version 2.0.0-alpha.0
 * @author Andy Stubbs
 * @license Apache-2.0
 * @preserve
 */
"use strict";(()=>{var Je=Object.defineProperty;var De=(t,c)=>{for(var I in c)Je(t,I,{get:c[I],enumerable:!0})};var Ie=["#000000","#0000AA","#00AA00","#00AAAA","#AA0000","#AA00AA","#AA5500","#AAAAAA","#555555","#5555FF","#55FF55","#55FFFF","#FF5555","#FF55FF","#FFFF55","#FFFFFF","#000000","#141414","#202020","#2D2D2D","#393939","#454545","#515151","#616161","#717171","#828282","#929292","#A2A2A2","#B6B6B6","#CACACA","#E3E3E3","#FFFFFF","#0000FF","#4100FF","#7D00FF","#BE00FF","#FF00FF","#FF00BE","#FF007D","#FF0041","#FF0000","#FF4100","#FF7D00","#FFBE00","#FFFF00","#BEFF00","#7DFF00","#41FF00","#00FF00","#00FF41","#00FF7D","#00FFBE","#00FFFF","#00BEFF","#007DFF","#0041FF","#7D7DFF","#9E7DFF","#BE7DFF","#DF7DFF","#FF7DFF","#FF7DDF","#FF7DBE","#FF7D9E","#FF7D7D","#FF9E7D","#FFBE7D","#FFDF7D","#FFFF7D","#DFFF7D","#BEFF7D","#9EFF7D","#7DFF7D","#7DFF9E","#7DFFBE","#7DFFDF","#7DFFFF","#7DDFFF","#7DBEFF","#7D9EFF","#B6B6FF","#C6B6FF","#DBB6FF","#EBB6FF","#FFB6FF","#FFB6EB","#FFB6DB","#FFB6C6","#FFB6B6","#FFC6B6","#FFDBB6","#FFEBB6","#FFFFB6","#EBFFB6","#DBFFB6","#C6FFB6","#B6FFB6","#B6FFC6","#B6FFDB","#B6FFEB","#B6FFFF","#B6EBFF","#B6DBFF","#B6C6FF","#000071","#1C0071","#390071","#550071","#710071","#710055","#710039","#71001C","#710000","#711C00","#713900","#715500","#717100","#557100","#397100","#1C7100","#007100","#00711C","#007139","#007155","#007171","#005571","#003971","#001C71","#393971","#453971","#553971","#613971","#713971","#713961","#713955","#713945","#713939","#714539","#715539","#716139","#717139","#617139","#557139","#457139","#397139","#397145","#397155","#397161","#397171","#396171","#395571","#394571","#515171","#595171","#615171","#695171","#715171","#715169","#715161","#715159","#715151","#715951","#716151","#716951","#717151","#697151","#617151","#597151","#517151","#517159","#517161","#517169","#517171","#516971","#516171","#515971","#000041","#100041","#200041","#310041","#410041","#410031","#410020","#410010","#410000","#411000","#412000","#413100","#414100","#314100","#204100","#104100","#004100","#004110","#004120","#004131","#004141","#003141","#002041","#001041","#202041","#282041","#312041","#392041","#412041","#412039","#412031","#412028","#412020","#412820","#413120","#413920","#414120","#394120","#314120","#284120","#204120","#204128","#204131","#204139","#204141","#203941","#203141","#202841","#2D2D41","#312D41","#352D41","#3D2D41","#412D41","#412D3D","#412D35","#412D31","#412D2D","#41312D","#41352D","#413D2D","#41412D","#3D412D","#35412D","#31412D","#2D412D","#2D4131","#2D4135","#2D413D","#2D4141","#2D3D41","#2D3541","#2D3141","#000000","#000000","#000000","#000000","#000000","#000000","#000000"],G={nextScreenId:0,screens:{},activeScreen:null,images:{},imageCount:0,defaultPrompt:"\xDB",defaultFont:{},nextFontId:0,fonts:{},defaultPalette:[],defaultColor:7,commands:{},screenCommands:{},defaultPenDraw:null,pens:{},penList:[],blendCommands:{},blendCommandsList:[],defaultBlendCmd:null,settings:{},settingsList:[],volume:.75,isTouchScreen:!1,defaultInputFocus:typeof window<"u"?window:null},re=[];var se={};De(se,{binarySearch:()=>yt,cToHex:()=>ee,canAddEventListeners:()=>et,checkColor:()=>rt,clamp:()=>xe,colorStringToColor:()=>we,colorStringToHex:()=>tt,compareColors:()=>it,convertToArray:()=>vt,convertToColor:()=>nt,copyProperties:()=>ht,dataToHex:()=>ct,degreesToRadian:()=>at,deleteProperties:()=>pt,getInt:()=>Ct,getWindowSize:()=>wt,hexToColor:()=>pe,hexToData:()=>st,inRange:()=>lt,inRange2:()=>dt,isArray:()=>ie,isDomElement:()=>ve,isFunction:()=>he,isInteger:()=>D,math:()=>It,pad:()=>mt,padL:()=>be,padR:()=>gt,queueMicrotask:()=>Et,radiansToDegrees:()=>ft,rgbToColor:()=>te,rgbToHex:()=>Ee,rndRange:()=>ut});var he=t=>typeof t=="function",ve=t=>t instanceof Element,ie=Array.isArray,D=Number.isInteger,et=t=>typeof t.addEventListener=="function"&&typeof t.removeEventListener=="function";function pe(t){let c,I,C,b,L;return L=t,t.length===4?(c=parseInt(t.slice(1,2),16)*16-1,I=parseInt(t.slice(2,3),16)*16-1,C=parseInt(t.slice(3,4),16)*16-1):(c=parseInt(t.slice(1,3),16),I=parseInt(t.slice(3,5),16),C=parseInt(t.slice(5,7),16)),t.length===9?(L=t.slice(0,7),b=parseInt(t.slice(7,9),16)):b=255,{r:c,g:I,b:C,a:b,s:`rgba(${c},${I},${C},${Math.round(b/255*1e3)/1e3})`,s2:L}}function ee(t){D(t)||(t=Math.round(t)),t=xe(t,0,255);let c=Number(t).toString(16);return c.length<2?"0"+c:c.toUpperCase()}function Ee(t,c,I,C){return isNaN(C)&&(C=255),"#"+ee(t)+ee(c)+ee(I)+ee(C)}function te(t,c,I,C){return pe(Ee(t,c,I,C))}function we(t){let I=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});I.fillStyle=t,I.fillRect(0,0,1,1);let C=I.getImageData(0,0,1,1).data;return te(C[0],C[1],C[2],C[3])}function tt(t){return we(t).s2}function ot(t){t=t.slice(t.indexOf("(")+1,t.indexOf(")"));let c=t.split(","),I=[];for(let C=0;C<c.length;C++){let b;C===3?b=parseFloat(c[C].trim())*255:b=parseInt(c[C].trim()),I.push(b)}return I}function nt(t){if(t===void 0)return null;if(ie(t)&&t.length>2)return te(t[0],t[1],t[2],t[3]);if(D(t?.r)&&D(t?.g)&&D(t?.b))return te(t.r,t.g,t.b,t.a);if(typeof t!="string")return null;if(/(^#[0-9A-F]{8}$)|(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t))return pe(t);if(t.indexOf("rgb")===0){let I=ot(t);return I.length<3?null:te(I[0],I[1],I[2],I[3])}return we(t)}function rt(t){let c=new Option().style;return c.color=t,c.color!==""}function it(t,c){return t.r===c.r&&t.g===c.g&&t.b===c.b&&t.a===c.a}function st(t,c,I){t=t.toUpperCase();let C=[],b=0,L="",F=0;for(let _=0;_<I;_++){C.push([]);for(let M=0;M<c;M++){if(F>=L.length){let S=parseInt(t[b],16);isNaN(S)&&(S=0),L=be(S.toString(2),4,"0"),b+=1,F=0}C[_].push(parseInt(L[F])),F+=1}}return C}function ct(t){let c="",I="";for(let C=0;C<t.length;C++)for(let b=0;b<t[C].length;b++)I+=t[C][b],I.length===4&&(c+=parseInt(I,2).toString(16),I="");return c}function xe(t,c,I){return Math.min(Math.max(t,c),I)}function lt(t,c){return t.x>=c.x&&t.x<c.x+c.width&&t.y>=c.y&&t.y<c.y+c.height}function dt(t,c,I,C,b,L){return t>=I&&t<I+b&&c>=C&&c<C+L}function ut(t,c){return Math.random()*(c-t)+t}function at(t){return t*(Math.PI/180)}function ft(t){return t*(180/Math.PI)}function be(t,c,I){typeof I!="string"&&(I=" ");let C="";t=t+"";for(let b=t.length;b<c;b++)C+=I;return C+t}function gt(t,c,I){typeof I!="string"&&(I=" "),t=t+"";for(let C=t.length;C<c;C++)t+=I;return t}function mt(t,c,I){for((typeof I!="string"||I.length===0)&&(I=" "),t=t+"";t.length<c;)t=I+t+I;return t.length>c&&(t=t.substr(0,c)),t}function ht(t,c){for(let I in c)c.hasOwnProperty(I)&&(t[I]=c[I])}function vt(t){let c=[];for(let I in t)t.hasOwnProperty(I)&&c.push(t[I]);return c}function pt(t){for(let c in t)t.hasOwnProperty(c)&&delete t[c]}function wt(){let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:t,height:c}}function yt(t,c,I){let C=0,b=t.length-1;for(;C<=b;){let L=b+C>>1,F=I(c,t[L],L);if(F>0)C=L+1;else if(F<0)b=L-1;else return L}return-C-1}function Ct(t,c){return t=parseInt(t),isNaN(t)&&(t=c),t}var It=Object.freeze({deg30:Math.PI/6,deg45:Math.PI/4,deg60:Math.PI/3,deg90:Math.PI/2,deg120:2*Math.PI/3,deg135:3*Math.PI/4,deg150:5*Math.PI/6,deg180:Math.PI,deg210:7*Math.PI/6,deg225:5*Math.PI/4,deg240:4*Math.PI/3,deg270:3*Math.PI/2,deg300:5*Math.PI/3,deg315:7*Math.PI/4,deg330:11*Math.PI/6,deg360:Math.PI*2}),Et=t=>{window.queueMicrotask?window.queueMicrotask(t):setTimeout(t,0)};function ce(t,c,I,C,b,L){G.commands[t]=c,I||re.push({name:t,fn:c,isScreen:C,parameters:b||[],isSet:L,noParse:L})}function Ae(t,c,I,C){ce(t,function(b,L){b.pixelMode?c(b,L):I(b,L)},!1,!0,C)}function Ne(t,c,I,C){G.settings[t]={name:t,fn:c,isScreen:I,parameters:C||[]},G.settingsList.push(t)}function oe(t,c){if(t.noParse)return c;if(c.length>0&&typeof c[0]=="object"&&c[0]!==null&&!c[0].hasOwnProperty("screen")&&!ie(c[0])&&!ve(c[0])){let I=c[0],C=[],b=!1;for(let L=0;L<t.parameters.length;L++)I.hasOwnProperty(t.parameters[L])?(C.push(I[t.parameters[L]]),b=!0):C.push(null);if(b)return C}return c}function _e(t,c,I){G.penList.push(t),G.pens[t]={cmd:c,cap:I}}function je(t,c){G.blendCommandsList.push(t),G.blendCommands[t]=c}function Le(t){re.sort((c,I)=>{let C=c.name.toUpperCase(),b=I.name.toUpperCase();return C<b?-1:C>b?1:0});for(let c of re)xt(t,c)}function xt(t,c){if(c.isSet){G.screenCommands[c.name]=c,t[c.name]=function(...I){let C=oe(c,I);return G.commands[c.name](null,C)};return}c.isScreen?(G.screenCommands[c.name]=c,t[c.name]=function(...I){let C=oe(c,I),b=le(void 0,c.name);if(b!==!1)return G.commands[c.name](b,C)}):t[c.name]=function(...I){let C=oe(c,I);return G.commands[c.name](C)}}function le(t,c){if(G.activeScreen===null){if(c==="set")return!1;let I=new Error(`${c}: No screens available for command.`);throw I.code="NO_SCREEN",I}if(t==null&&(t=G.activeScreen.id),D(t)&&!G.screens[t]){let I=new Error(`${c}: Invalid screen id.`);throw I.code="INVALID_SCREEN_ID",I}return G.screens[t]}function Te(t){let c=t._.data;t._.addCommand("setScreen",I,!1,!1,["screen"]),t._.addSetting("screen",I,!1,["screen"]);function I(x){let m=x[0],y;if(t.util.isInteger(m)?y=m:m&&t.util.isInteger(m.id)&&(y=m.id),!c.screens[y]){let h=new Error("screen: Invalid screen.");throw h.code="INVALID_SCREEN",h}c.activeScreen=c.screens[y]}t._.addCommand("removeAllScreens",C,!1,!1,[]);function C(){for(let x in c.screens)c.screens[x].screenObj.removeScreen();c.nextScreenId=0}t._.addCommand("getScreen",b,!1,!1,["screenId"]);function b(x){let m=x[0];return le(m,"getScreen").screenObj}t._.addCommand("setDefaultColor",L,!1,!1,["color"]),t._.addSetting("defaultColor",L,!1,["color"]);function L(x){let m=x[0];if(!isNaN(Number(m))&&c.defaultPalette.length>m)c.defaultColor=m;else{if(m=t.util.convertToColor(m),m===null){let y=new TypeError("setDefaultColor: invalid color value for parameter color.");throw y.code="INVALID_COLOR",y}c.defaultColor=m}}t._.addCommand("setDefaultPal",F,!1,!1,["pal"]),t._.addSetting("defaultPal",F,!1,["pal"]);function F(x){let m=x[0];if(!t.util.isArray(m)){let h=new TypeError("setDefaultPal: parameter pal is not an array.");throw h.code="INVALID_PARAMETER",h}if(m.length<1){let h=new RangeError("setDefaultPal: parameter pal must have at least one color value.");throw h.code="EMPTY_PALETTE",h}c.defaultPalette=[],m.length>1?c.defaultColor=1:c.defaultColor=0;for(let h=0;h<m.length;h++){let f=t.util.convertToColor(m[h]);f===null?(console.warn("setDefaultPal: invalid color value inside array pal."),c.defaultPalette.push(t.util.convertToColor("#000000"))):c.defaultPalette.push(f)}let y=c.defaultPalette[0];c.defaultPalette[0]=t.util.convertToColor([y.r,y.g,y.b,0])}t._.addCommand("getDefaultPal",_,!1,!1,[]);function _(){let x=[];for(let m of c.defaultPalette)x.push(m);return x}t._.addCommand("setDefaultInputFocus",M,!1,!1,["element"]),t._.addSetting("defaultInputFocus",M,!1,["element"]);function M(x){let m=x[0];if(typeof m=="string"&&(m=document.getElementById(m)),!m||!t.util.canAddEventListeners(m)){let y=new TypeError("setDefaultInputFocus: Invalid argument element. Element must be a DOM element or string id of a DOM element.");throw y.code="INVALID_ELEMENT",y}m.tabIndex>=0||(m.tabIndex=0),c.defaultInputFocus=m,c.commands.reinitKeyboard&&c.commands.reinitKeyboard()}t._.addCommand("set",S,!1,!0,c.settingsList,!0);function S(x,m){let y=m[0];for(let h in y)if(c.settings[h]){let f=c.settings[h],o=y[h];!t.util.isArray(o)&&typeof o=="object"?o=t._.parseOptions(f,[o]):o=[o],f.isScreen?(x||(x=le(void 0,`set ${f.name}`)),f.fn(x,o)):f.fn(o)}}}function ke(t){let c=t._.data;t._.addBlendCommand("normal",I);function I(s,r,i,e){let n=s.imageData.data,d=(s.width*i+r)*4;n[d]=e.r,n[d+1]=e.g,n[d+2]=e.b,n[d+3]=e.a}t._.addBlendCommand("blend",C);function C(s,r,i,e){let n=s.imageData.data,d=(s.width*i+r)*4,u=e.a/255,a=(255-e.a)/255;n[d]=e.r*u+n[d]*a,n[d+1]=e.g*u+n[d+1]*a,n[d+2]=e.b*u+n[d+2]*a,n[d+3]=e.a+n[d+3]*a}t._.addCommand("getImageData",b,!0,!1);function b(s){(s.dirty===!1||s.imageData===null)&&(s.imageData=s.context.getImageData(0,0,s.width,s.height))}t._.addCommand("resetImageData",L,!0,!1);function L(s){s.imageData=null}t._.addCommand("setImageDirty",F,!0,!1);function F(s){s.dirty===!1&&(s.dirty=!0,s.isAutoRender&&!s.autoRenderMicrotaskScheduled&&(s.autoRenderMicrotaskScheduled=!0,t.util.queueMicrotask(function(){s.screenObj&&s.isAutoRender&&s.screenObj.render(),s.autoRenderMicrotaskScheduled=!1})))}t._.addCommand("setPixel",_,!0,!1);function _(s,r,i,e){s.blendPixelCmd(s,r,i,e)}t._.addCommand("setPixelSafe",M,!0,!1),t._.addPen("pixel",M,"square");function M(s,r,i,e){r<0||r>=s.width||i<0||i>=s.height||(c.commands.getImageData(s),e=S(s,e),s.blendPixelCmd(s,r,i,e),c.commands.setImageDirty(s))}t._.addCommand("getPixelColor",S,!0,!1);function S(s,r){let i=s.pen.noise;if(!i)return r;let e={r:r.r,g:r.g,b:r.b,a:r.a},n=i/2;if(t.util.isArray(i))e.r=t.util.clamp(Math.round(e.r+t.util.rndRange(-i[0],i[0])),0,255),e.g=t.util.clamp(Math.round(e.g+t.util.rndRange(-i[1],i[1])),0,255),e.b=t.util.clamp(Math.round(e.b+t.util.rndRange(-i[2],i[2])),0,255),e.a=t.util.clamp(e.a+t.util.rndRange(-i[3],i[3]),0,255);else{let d=Math.round(Math.random()*i-n);e.r=t.util.clamp(e.r+d,0,255),e.g=t.util.clamp(e.g+d,0,255),e.b=t.util.clamp(e.b+d,0,255)}return e}t._.addCommand("drawSquarePen",x,!0,!1),t._.addPen("square",x,"square");function x(s,r,i,e){let n=s.pen.size*2-1,d=Math.round(n/2)-1;for(let u=0;u<n;u++)for(let a=0;a<n;a++)c.commands.setPixelSafe(s,a+r-d,u+i-d,e);c.commands.setImageDirty(s)}t._.addCommand("drawCirclePen",m,!0,!1),t._.addPen("circle",m,"round");function m(s,r,i,e){if(s.pen.size===2){c.commands.setPixelSafe(s,r,i,e),c.commands.setPixelSafe(s,r+1,i,e),c.commands.setPixelSafe(s,r-1,i,e),c.commands.setPixelSafe(s,r,i+1,e),c.commands.setPixelSafe(s,r,i-1,e),c.commands.setImageDirty(s);return}let n=s.pen.size*2,d=s.pen.size,u=d-1;for(let a=0;a<n;a++)for(let g=0;g<n;g++){let l=g-u,v=a-u;Math.round(Math.sqrt(l*l+v*v))<d&&c.commands.setPixelSafe(s,l+r,v+i,e)}c.commands.setImageDirty(s)}t._.addCommand("getPixelInternal",y,!0,!1);function y(s,r,i){let e=s.imageData.data,n=(s.width*i+r)*4;return{r:e[n],g:e[n+1],b:e[n+2],a:e[n+3]}}t._.addCommand("getPixelSafe",h,!0,!1);function h(s,r,i){return c.commands.getImageData(s),y(s,r,i)}t._.addCommand("findColorValue",f,!0,!1);function f(s,r,i){let e;if(t.util.isInteger(r)){if(r>s.pal.length){let n=new RangeError(`${i}: parameter color is not a color in the palette.`);throw n.code="COLOR_OUT_OF_RANGE",n}e=s.pal[r]}else if(e=t.util.convertToColor(r),e===null){let n=new TypeError(`${i}: parameter color is not a valid color format.`);throw n.code="INVALID_COLOR",n}return e}t._.addCommand("put",o,!1,!0,["data","x","y","includeZero"]);function o(s,r){let i=r[0],e=Math.round(r[1]),n=Math.round(r[2]),d=!!r[3];if(!i||i.length<1)return;if(isNaN(e)||isNaN(n)){let v=new TypeError("put: parameters x and y must be integers.");throw v.code="INVALID_COORDINATES",v}let u;e<0?u=e*-1:u=0;let a;n<0?a=n*-1:a=0;let g=i[0].length-u,l=i.length-a;if(e+u+g>=s.width&&(g=s.width-e-u),n+a+l>=s.height&&(l=s.height-n-a),!(g<=0||l<=0)){c.commands.getImageData(s);for(let v=a;v<a+l;v++)for(let p=u;p<u+g;p++){let w=s.pal[i[v][p]],E=(s.width*(n+v)+(e+p))*4;w&&(w.a>0||d)&&(s.imageData.data[E]=w.r,s.imageData.data[E+1]=w.g,s.imageData.data[E+2]=w.b,s.imageData.data[E+3]=w.a)}c.commands.setImageDirty(s)}}c.defaultPenDraw=M,c.defaultBlendCmd=I}function Fe(t){let c=t._.data;t._.addCommand("screen",I,!1,!1,["aspect","container","isOffscreen","willReadFrequently","noStyles","isMultiple","resizeCallback"]);function I(m){let y=m[0],h=m[1],f=m[2],o=!!m[3],s=m[4],r=m[5],i=m[6],e;if(i!=null&&!t.util.isFunction(i)){let u=new TypeError("screen: resizeCallback must be a function.");throw u.code="INVALID_CALLBACK",u}if(typeof y=="string"&&y!==""){if(e=b(y.toLowerCase()),!e){let u=new Error("screen: invalid value for aspect.");throw u.code="INVALID_ASPECT",u}e.isMultiple=!!r}let n;if(f){if(!e){let u=new Error("screen: You must supply an aspect ratio with exact dimensions for offscreen screens.");throw u.code="NO_ASPECT_OFFSCREEN",u}if(e.splitter!=="x"){let u=new Error("screen: You must use aspect ratio with e(x)act pixel dimensions such as 320x200 for offscreen screens.");throw u.code="INVALID_OFFSCREEN_ASPECT",u}n=L(e,o)}else{let u=h;if(typeof h=="string"&&(u=document.getElementById(h)),u&&!t.util.isDomElement(u)){let a=new TypeError("screen: Invalid argument container. Container must be a DOM element or a string id of a DOM element.");throw a.code="INVALID_CONTAINER",a}s?n=_(e,u,o):n=F(e,u,i,o)}n.cache={findColor:{}};let d={};n.commands={};for(let u in c.screenCommands){let a=c.screenCommands[u];n.commands[u]=a.fn,C(d,u,n,a)}return n.screenObj=d,d.id=n.id,d.screen=!0,d}function C(m,y,h,f){m[y]=function(...o){let s=t._.parseOptions(f,o);return h.commands[y](h,s)}}function b(m){let y,h,f,o;if(m.indexOf(":")>-1)o=":";else if(m.indexOf("x")>-1)o="x";else if(m.indexOf("e")>-1)o="e";else return null;return f=m.split(o),y=Number(f[0]),isNaN(y)||y===0||(h=Number(f[1]),isNaN(h)||h===0)?null:{width:y,height:h,splitter:o}}function L(m,y){let h=document.createElement("canvas");h.width=m.width,h.height=m.height;let f=document.createElement("canvas");return f.width=m.width,f.height=m.height,M(h,f,null,m,!0,!1,null,y)}function F(m,y,h,f){let o=document.createElement("canvas"),s=document.createElement("canvas");o.style.backgroundColor="black",o.style.position="absolute",o.style.imageRendering="pixelated",o.style.imageRendering="crisp-edges";let r=!0;if(t.util.isDomElement(y)||(r=!1,document.documentElement.style.height="100%",document.documentElement.style.margin="0",document.body.style.height="100%",document.body.style.margin="0",document.body.style.overflow="hidden",o.style.left="0",o.style.top="0",y=document.body),y.offsetHeight===0&&(y.style.height="200px"),y.appendChild(o),m){let i=x(y);S(m,o,i.width,i.height),s.width=o.width,s.height=o.height}else{r&&(o.style.position="static"),o.style.width="100%",o.style.height="100%";let i=x(o);o.width=i.width,o.height=i.height,s.width=i.width,s.height=i.height}return M(o,s,y,m,!1,!1,h,f)}function _(m,y,h){let f=document.createElement("canvas"),o=document.createElement("canvas");if(t.util.isDomElement(y)||(y=document.body),y.appendChild(f),m&&m.splitter==="x")f.width=m.width,f.height=m.height,o.width=f.width,o.height=f.height;else{let s=x(f);o.width=s.width,o.height=s.height}return M(f,o,y,m,!1,!0,null,h)}function M(m,y,h,f,o,s,r,i){let e={};return e.id=c.nextScreenId,c.nextScreenId+=1,c.activeScreen=e,m.dataset.screenId=e.id,i?e.contextAttributes={willReadFrequently:!0}:e.contextAttributes={},e.canvas=m,e.width=m.width,e.height=m.height,e.container=h,e.aspectData=f,e.isOffscreen=o,e.isNoStyles=s,e.context=m.getContext("2d",e.contextAttributes),e.bufferCanvas=y,e.bufferContext=y.getContext("2d",e.contextAttributes),e.dirty=!1,e.isAutoRender=!0,e.autoRenderMicrotaskScheduled=!1,e.imageData=null,e.x=0,e.y=0,e.angle=0,e.pal=c.defaultPalette.slice(),e.fColor=e.pal[c.defaultColor]||t.util.convertToColor("#FFFFFF"),e.bColor=e.pal[0]||t.util.convertToColor("#000000"),e.context.fillStyle=e.fColor.s,e.context.strokeStyle=e.fColor.s,e.mouseStarted=!1,e.touchStarted=!1,e.printCursor={x:0,y:0,font:c.defaultFont,rows:Math.floor(m.height/(c.defaultFont.height||14)),cols:Math.floor(m.width/(c.defaultFont.width||8)),prompt:c.defaultPrompt,breakWord:!0},e.clientRect=m.getBoundingClientRect(),e.mouse={x:-1,y:-1,offsetX:0,offsetY:0,button:0,buttons:0,lastX:-1,lastY:-1,eventType:""},e.touch={x:-1,y:-1,count:0,touches:[],eventType:""},e.touches={},e.lastTouches={},e.pixelMode=!0,e.pen={draw:c.defaultPenDraw,size:1,noise:null},e.blendPixelCmd=c.defaultBlendCmd,e.context.imageSmoothingEnabled=!1,e.onMouseEventListeners={},e.onTouchEventListeners={},e.onPressEventListeners={},e.onClickEventListeners={},e.mouseEventListenersActive=0,e.touchEventListenersActive=0,e.pressEventListenersActive=0,e.clickEventListenersActive=0,e.lastEvent=null,e.isContextMenuEnabled=!0,e.resizeCallback=r,c.screens[e.id]=e,e}function S(m,y,h,f){let o=m.width,s=m.height,r=m.splitter,i,e;if(m.isMultiple&&r!==":"){let n=Math.floor(h/o),d=Math.floor(f/s),u=n>d?d:n;u<1&&(u=1),i=o*u,e=s*u,r==="e"&&(o=Math.floor(h/u),s=Math.floor(f/u),i=o*u,e=s*u)}else{let n=s/o,d=o/s;i=f*d,e=h*n,i>h?(i=h,e=i*n):e=f,r==="e"&&(o+=Math.round((h-i)*(o/i)),s+=Math.round((f-e)*(s/e)),i=h,e=f)}y.style.width=Math.floor(i)+"px",y.style.height=Math.floor(e)+"px",y.style.marginLeft=Math.floor((h-i)/2)+"px",y.style.marginTop=Math.floor((f-e)/2)+"px",r==="x"||r==="e"?(y.width=o,y.height=s):(y.width=Math.floor(i),y.height=Math.floor(e))}function x(m){return{width:m.offsetWidth||m.clientWidth||m.width,height:m.offsetHeight||m.clientHeight||m.height}}}function Me(t){let c=t._.data;t._.addCommand("onevent",I,!0,!0,[]);function I(l,v,p,w,E,N,T,P,R,H){let U=!1;for(let B=0;B<E.length;B++)if(l===E[B]){U=!0;break}if(!U){let B=new TypeError(`${N}: mode needs to be one of the following ${E.join(", ")}`);throw B.code="INVALID_MODE",B}if(p=!!p,!t.util.isFunction(v)){let B=new TypeError(`${N}: fn is not a valid function`);throw B.code="INVALID_CALLBACK",B}if(w&&(!t.util.isInteger(w.x)||!t.util.isInteger(w.y)||!t.util.isInteger(w.width)||!t.util.isInteger(w.height))){let B=new TypeError(`${N}: hitbox must have properties x, y, width, and height whose values are integers`);throw B.code="INVALID_HITBOX",B}return setTimeout(function(){let B=v,Y;typeof P=="string"?Y=l+P:Y=l,p&&(v=function($,X){C(l,B,E,N,T,P),B($,X)}),T[Y]||(T[Y]=[]),T[Y].push({fn:v,hitBox:w,extraData:R,clickDown:!1,originalFn:B,customData:H})},1),!0}t._.addCommand("offevent",C,!0,!0,[]);function C(l,v,p,w,E,N){let T=!1;for(let R=0;R<p.length;R++)if(l===p[R]){T=!0;break}if(!T){let R=new TypeError(`${w}: mode needs to be one of the following ${p.join(", ")}`);throw R.code="INVALID_MODE",R}typeof N=="string"&&(l+=N);let P=v==null;if(!P&&!t.util.isFunction(v)){let R=new TypeError(`${w}: fn is not a valid function`);throw R.code="INVALID_CALLBACK",R}if(E[l]){if(P)delete E[l];else for(let R=E[l].length-1;R>=0;R--)E[l][R].originalFn===v&&E[l].splice(R,1),E[l].length===0&&delete E[l];return!0}return!1}t._.addCommand("clearEvents",b,!1,!0,[]);function b(l){l.onMouseEventListeners={},l.onTouchEventListeners={},l.onPressEventListeners={},l.onClickEventListeners={},l.mouseEventListenersActive=0,l.touchEventListenersActive=0,l.pressEventListenersActive=0,l.clickEventListenersActive=0,l.lastEvent=null}t._.addCommand("setAutoRender",L,!1,!0,["isAutoRender"]),t._.addSetting("autoRender",L,!0,["isAutoRender"]);function L(l,v){l.isAutoRender=!!v[0],l.isAutoRender&&l.screenObj.render()}t._.addCommand("removeScreen",F,!1,!0,[]);function F(l){let v=l.id;if(l===c.activeScreen){for(let p in c.screens)if(c.screens[p]!==l){c.activeScreen=c.screens[p];break}}l.screenObj.cancelInput&&l.screenObj.cancelInput();for(let p in l.screenObj)delete l.screenObj[p];l.canvas.parentElement&&l.canvas.parentElement.removeChild(l.canvas),l.canvas=null,l.bufferCanvas=null,l.pal=null,l.commands=null,l.context=null,l.imageData=null,l.screenObj=null,delete c.screens[v]}t._.addCommand("render",_,!1,!0,[]);function _(l){l.dirty===!0&&(l.context.putImageData(l.imageData,0,0),l.dirty=!1)}t._.addCommand("width",M,!1,!0,[]);function M(l){return l.width}t._.addCommand("height",S,!1,!0,[]);function S(l){return l.height}t._.addCommand("canvas",x,!1,!0,[]);function x(l){return l.canvas}t._.addCommand("setBgColor",m,!1,!0,["color"]),t._.addSetting("bgColor",m,!0,["color"]);function m(l,v){let p=v[0],w;if(t.util.isInteger(p)?w=l.pal[p]:w=t.util.convertToColor(p),w&&typeof w.s=="string")l.canvas.style.backgroundColor=w.s;else{let E=new TypeError("bgColor: invalid color value for parameter c.");throw E.code="INVALID_COLOR",E}}t._.addCommand("setContainerBgColor",y,!1,!0,["color"]),t._.addSetting("containerBgColor",y,!0,["color"]);function y(l,v){let p=v[0],w;if(l.container)if(t.util.isInteger(p)?w=l.pal[p]:w=t.util.convertToColor(p),w&&typeof w.s=="string")l.container.style.backgroundColor=w.s;else{let E=new TypeError("containerBgColor: invalid color value for parameter c.");throw E.code="INVALID_COLOR",E}}t._.addCommand("findColor",h,!1,!0,["color","tolerance","isAddToPalette"]);function h(l,v){let p=v[0],w=v[1],E=!!v[2],N=65025*3.25;if(w==null)w=1;else if(isNaN(w)||w<0||w>1){let P=new RangeError("findColor: parameter tolerance must be a number between 0 and 1");throw P.code="INVALID_TOLERANCE",P}w=w*(2-w)*N;let T=l.pal;if(p&&p.s&&l.cache.findColor[p.s]!==void 0)return l.cache.findColor[p.s];p=c.commands.findColorValue(l,p,"findColor");for(let P=0;P<T.length;P++){if(T[P].s===p.s)return l.cache.findColor[p.s]=P,P;{let R=T[P].r-p.r,H=T[P].g-p.g,U=T[P].b-p.b,B=T[P].a-p.a,Y=R*R+H*H+U*U+B*B*.25;if(N-Y>=w)return l.cache.findColor[p.s]=P,P}}return E?(T.push(p),l.cache.findColor[p.s]=T.length-1,T.length-1):0}t._.addCommand("setColor",f,!1,!0,["color","isAddToPalette"]),t._.addSetting("color",f,!0,["color","isAddToPalette"]);function f(l,v){let p=v[0],w=!!v[1],E=c.commands.findColorValue(l,p,"setColor");if(E!==void 0){if(w){let N=c.commands.findColor(l,[E,1,w]);l.fColor=l.pal[N]}else l.fColor=E;l.context.fillStyle=l.fColor.s,l.context.strokeStyle=l.fColor.s}}t._.addCommand("setPenSize",o,!1,!0,["size"]),t._.addSetting("penSize",o,!0,["size"]);function o(l,v){let p=v[0];if(p===void 0&&(p=1),!t.util.isInteger(p)||p<1){let w=new TypeError("setPenSize: size must be an integer >= 1.");throw w.code="INVALID_PEN_SIZE",w}l.pen.size=p,l.context.lineWidth=p}t._.addCommand("getPal",s,!1,!0,[]);function s(l){let v=[];for(let p=0;p<l.pal.length;p++){let w={r:l.pal[p].r,g:l.pal[p].g,b:l.pal[p].b,a:l.pal[p].a,s:l.pal[p].s};v.push(w)}return v}t._.addCommand("setPalColor",r,!1,!0,["index","color"]),t._.addSetting("palColor",r,!0,["index","color"]);function r(l,v){let p=v[0],w=v[1];if(!t.util.isInteger(p)||p<0||p>l.pal.length){let N=new RangeError("setPalColor: index is not a valid integer value");throw N.code="INVALID_INDEX",N}let E=t.util.convertToColor(w);if(E===null){let N=new TypeError("setPalColor: parameter color is not a valid color format");throw N.code="INVALID_COLOR",N}l.fColor.s===l.pal[p].s&&(l.fColor=E),l.cache.findColor[w.s]&&(l.cache.findColor[w.s]=p),l.pal[p]=E}t._.addCommand("swapColor",i,!1,!0,["oldColor","newColor"]);function i(l,v){let p=v[0],w=v[1];if(!t.util.isInteger(p)){let T=new TypeError("swapColor: parameter oldColor must be an integer");throw T.code="INVALID_OLD_COLOR",T}if(p<0||p>=l.pal.length){let T=new RangeError("swapColor: parameter oldColor is an invalid integer");throw T.code="INVALID_OLD_COLOR_INDEX",T}if(l.pal[p]===void 0){let T=new Error("swapColor: parameter oldColor is not in the screen color palette");throw T.code="COLOR_NOT_IN_PALETTE",T}let E=p;if(p=l.pal[E],w=t.util.convertToColor(w),w===null){let T=new TypeError("swapColor: parameter newColor is not a valid color format");throw T.code="INVALID_NEW_COLOR",T}c.commands.getImageData(l);let N=l.imageData.data;for(let T=0;T<l.height;T++)for(let P=0;P<l.width;P++){let R=(l.width*T+P)*4;N[R]===p.r&&N[R+1]===p.g&&N[R+2]===p.b&&N[R+3]===p.a&&(N[R]=w.r,N[R+1]=w.g,N[R+2]=w.b,N[R+3]=w.a)}c.commands.setImageDirty(l),l.pal[E]=w}t._.addCommand("setPixelMode",e,!1,!0,["isEnabled"]),t._.addSetting("pixelMode",e,!0,["isEnabled"]);function e(l,v){v[0]?(l.context.imageSmoothingEnabled=!1,l.pixelMode=!0):(l.context.imageSmoothingEnabled=!0,l.pixelMode=!1)}t._.addCommand("setPen",n,!1,!0,["pen","size","noise"]),t._.addSetting("pen",n,!0,["pen","size","noise"]);function n(l,v){let p=v[0],w=Math.round(v[1]),E=v[2];if(!c.pens[p]){let N=new TypeError(`setPen: parameter pen is not a valid pen. Valid pens: ${c.penList.join(", ")}`);throw N.code="INVALID_PEN",N}if(!t.util.isInteger(w)){let N=new TypeError("setPen: parameter size must be an integer");throw N.code="INVALID_SIZE",N}if(E&&!t.util.isArray(E)&&isNaN(E)){let N=new TypeError("setPen: parameter noise is not an array or number");throw N.code="INVALID_NOISE",N}if(t.util.isArray(E)){E=E.slice();for(let N=0;N<E.length;N++)if(isNaN(E[N])){let T=new TypeError("setPen: parameter noise array contains an invalid value");throw T.code="INVALID_NOISE_VALUE",T}}p==="pixel"&&(w=1),w<1&&(w=1),w===1?(l.pen.draw=c.pens.pixel.cmd,l.context.lineWidth=1):(l.pen.draw=c.pens[p].cmd,l.context.lineWidth=w*2-1),l.pen.noise=E,l.pen.size=w,l.context.lineCap=c.pens[p].cap}t._.addCommand("setBlendMode",d,!1,!0,["mode"]),t._.addSetting("blendMode",d,!0,["mode"]);function d(l,v){let p=v[0];if(!c.blendCommands[p]){let w=new TypeError(`setBlendMode: Argument blend is not a valid blend mode. Valid modes: ${c.blendCommandsList.join(", ")}`);throw w.code="INVALID_BLEND_MODE",w}l.blendPixelCmd=c.blendCommands[p]}t._.addCommand("getPixel",u,!1,!0,["x","y"]);function u(l,v){let p=Math.round(v[0]),w=Math.round(v[1]);if(!t.util.isInteger(p)||!t.util.isInteger(w)){let T=new TypeError("getPixel: x and y must be integers");throw T.code="INVALID_COORDINATES",T}c.commands.getImageData(l);let E=l.imageData.data,N=(l.width*w+p)*4;return t.util.convertToColor({r:E[N],g:E[N+1],b:E[N+2],a:E[N+3]})}t._.addCommand("filterImg",a,!1,!0,["filter"]);function a(l,v){let p=v[0];if(!t.util.isFunction(p)){let E=new TypeError("filterImg: filter must be a callback function");throw E.code="INVALID_FILTER",E}c.commands.getImageData(l);let w=l.imageData.data;for(let E=0;E<l.height;E++)for(let N=0;N<l.width;N++){let T=(l.width*E+N)*4,P=p({r:w[T],g:w[T+1],b:w[T+2],a:w[T+3]},N,E);P&&t.util.isInteger(P.r)&&t.util.isInteger(P.g)&&t.util.isInteger(P.b)&&t.util.isInteger(P.a)&&(w[T]=t.util.clamp(P.r,0,255),w[T+1]=t.util.clamp(P.g,0,255),w[T+2]=t.util.clamp(P.b,0,255),w[T+3]=t.util.clamp(P.a,0,255))}c.commands.setImageDirty(l)}t._.addCommand("get",g,!1,!0,["x1","y1","x2","y2","tolerance","isAddToPalette"]);function g(l,v){let p=Math.round(v[0]),w=Math.round(v[1]),E=Math.round(v[2]),N=Math.round(v[3]),T=v[4]!=null?v[4]:1,P=!!v[5];if(isNaN(p)||isNaN(w)||isNaN(E)||isNaN(N)){let B=new TypeError("get: parameters x1, x2, y1, y2 must be integers.");throw B.code="INVALID_COORDINATES",B}if(isNaN(T)){let B=new TypeError("get: parameter tolerance must be a number.");throw B.code="INVALID_TOLERANCE",B}if(p=t.util.clamp(p,0,l.width-1),E=t.util.clamp(E,0,l.width-1),w=t.util.clamp(w,0,l.height-1),N=t.util.clamp(N,0,l.height-1),p>E){let B=p;p=E,E=B}if(w>N){let B=w;w=N,N=B}c.commands.getImageData(l);let R=l.imageData,H=[],U=0;for(let B=w;B<=N;B++){H.push([]);for(let Y=p;Y<=E;Y++){let $=(l.width*B+Y)*4,X=R.data[$],Z=R.data[$+1],fe=R.data[$+2],ge=R.data[$+3],me=t.util.rgbToColor(X,Z,fe,ge),ne=c.commands.findColor(l,[me,T,P]);H[U].push(ne)}U+=1}return H}}function Se(t){let c=t._.data;t._.addCommand("cls",I,!1,!0,["x","y","width","height"]);function I(o,s){let r=t.util.getInt(Math.round(s[0]),0),i=t.util.getInt(Math.round(s[1]),0),e=t.util.getInt(Math.round(s[2]),o.width),n=t.util.getInt(Math.round(s[3]),o.height);r!==0||i!==0||e!==o.width||n!==o.height?(o.screenObj.render(),o.context.clearRect(r,i,e,n)):(o.context.clearRect(r,i,e,n),o.imageData=null,o.printCursor.x=0,o.printCursor.y=0,o.x=0,o.y=0,o.dirty=!1),c.commands.resetImageData(o)}t._.addCommands("pset",C,b,["x","y"]);function C(o,s){let r=Math.round(s[0]),i=Math.round(s[1]);if(!t.util.isInteger(r)||!t.util.isInteger(i)){let n=new TypeError("pset: Arguments x and y must be integers.");throw n.code="INVALID_COORDINATES",n}if(o.x=r,o.y=i,!t.util.inRange2(r,i,0,0,o.width,o.height))return;let e=o.fColor;c.commands.getImageData(o),o.pen.draw(o,r,i,e),c.commands.setImageDirty(o)}function b(o,s){let r=s[0],i=s[1];if(isNaN(r)||isNaN(i)){let e=new TypeError("pset: Arguments x and y must be numbers.");throw e.code="INVALID_COORDINATES",e}o.context.fillRect(r,i,1,1)}t._.addCommands("line",L,F,["x1","y1","x2","y2"]);function L(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]);if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)||!t.util.isInteger(n)){let p=new TypeError("line: Arguments x1, y1, x2, and y2 must be integers.");throw p.code="INVALID_COORDINATES",p}let d=o.fColor,u=Math.abs(e-r),a=Math.abs(n-i),g=r<e?1:-1,l=i<n?1:-1,v=u-a;for(c.commands.getImageData(o),o.pen.draw(o,r,i,d);!(r===e&&i===n);){let p=v<<1;p>-a&&(v-=a,r+=g),p<u&&(v+=u,i+=l),o.pen.draw(o,r,i,d)}c.commands.setImageDirty(o)}function F(o,s){let r=s[0],i=s[1],e=s[2],n=s[3];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let u=new TypeError("line: parameters x1, y1, x2, y2 must be numbers.");throw u.code="INVALID_COORDINATES",u}o.screenObj.render();let d=o.context;d.beginPath(),d.moveTo(r,i),d.lineTo(e,n),d.stroke()}t._.addCommands("circle",_,M,["x","y","radius","fillColor"]);function _(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=!1;if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)){let p=new TypeError("circle: x, y, radius must be integers.");throw p.code="INVALID_COORDINATES",p}if(n!=null){if(n=c.commands.findColorValue(o,n,"circle"),n===void 0)return;d=!0}c.commands.getImageData(o);let u=o.fColor;if(d){let p=e-1,w=p*p;for(let E=-p;E<=p;E++){let N=i+E;if(N<0||N>=o.height)continue;let T=Math.floor(Math.sqrt(w-E*E));for(let P=r-T;P<=r+T;P++)P<0||P>=o.width||c.commands.setPixelSafe(o,P,N,n)}}let a=e-1,g=a,l=0;a>1?(o.pen.draw(o,g+r,l+i,u),o.pen.draw(o,-g+r,l+i,u),o.pen.draw(o,r,g+i,u),o.pen.draw(o,r,-g+i,u)):a===1?(o.pen.draw(o,r+1,i,u),o.pen.draw(o,r-1,i,u),o.pen.draw(o,r,i+1,u),o.pen.draw(o,r,i-1,u),l=g+1):a===0&&(o.pen.draw(o,r,i,u),l=g+1);let v=1-a;for(;g>l;)l+=1,v<=0?v=v+2*l+1:(g-=1,v=v+2*l-2*g+1),o.pen.draw(o,g+r,l+i,u),o.pen.draw(o,-g+r,l+i,u),o.pen.draw(o,g+r,-l+i,u),o.pen.draw(o,-g+r,-l+i,u),g!==l&&(o.pen.draw(o,l+r,g+i,u),o.pen.draw(o,-l+r,g+i,u),o.pen.draw(o,l+r,-g+i,u),o.pen.draw(o,-l+r,-g+i,u));c.commands.setImageDirty(o)}function M(o,s){let r=s[0]+.5,i=s[1]+.5,e=s[2]-.9,n=s[3];if(isNaN(r)||isNaN(i)||isNaN(e)){let g=new TypeError("circle: parameters x, y, r must be numbers.");throw g.code="INVALID_COORDINATES",g}e<0&&(e=0);let d=!1;if(n!=null){if(n=c.commands.findColorValue(o,n,"circle"),n===void 0)return;d=!0}o.screenObj.render();let u=o.context,a=o.fColor.s;u.beginPath(),u.arc(r,i,e,0,Math.PI*2),d&&(u.fillStyle=n.s,u.fill()),u.strokeStyle=a,u.stroke()}t._.addCommands("rect",S,x,["x","y","width","height","fillColor"]);function S(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]),d=s[4];if(!t.util.isInteger(r)||!t.util.isInteger(i)||!t.util.isInteger(e)||!t.util.isInteger(n)){let g=new TypeError("rect: x, y, width, height must be integers.");throw g.code="INVALID_COORDINATES",g}let u=o.fColor,a=d!=null;if(!(a&&(d=c.commands.findColorValue(o,d,"rect"),d===void 0))){c.commands.getImageData(o);for(let g=0;g<e;g++)o.pen.draw(o,r+g,i,u),o.pen.draw(o,r+g,i+n-1,u);for(let g=1;g<n-1;g++)o.pen.draw(o,r,i+g,u),o.pen.draw(o,r+e-1,i+g,u);if(a)for(let g=1;g<n-1;g++)for(let l=1;l<e-1;l++)c.commands.setPixel(o,r+l,i+g,d);c.commands.setImageDirty(o)}}function x(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let g=new TypeError("rect: parameters must be numbers.");throw g.code="INVALID_COORDINATES",g}let u=d!=null;if(u&&(d=c.commands.findColorValue(o,d,"rect"),d===void 0))return;o.screenObj.render();let a=o.context;u?(a.fillStyle=d.s,a.fillRect(r,i,e,n)):a.strokeRect(r,i,e,n)}t._.addCommands("ellipse",m,y,["x","y","radiusX","radiusY","fillColor"]);function m(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=Math.round(s[3]),d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let N=new TypeError("ellipse: parameters x, y, radiusX, radiusY must be integers.");throw N.code="INVALID_COORDINATES",N}let u=!1;if(d!=null){if(d=c.commands.findColorValue(o,d,"ellipse"),d===void 0)return;u=!0}c.commands.getImageData(o);let a=o.fColor;if(e===0&&n===0){o.pen.draw(o,Math.floor(r),Math.floor(i),a),c.commands.setImageDirty(o);return}if(u){let N=e*e,T=n*n;for(let P=-n;P<=n;P++){let R=i+P;if(R<0||R>=o.height)continue;let H=Math.floor(e*Math.sqrt(1-P*P/T));for(let U=r-H;U<=r+H;U++)U<0||U>=o.width||c.commands.setPixelSafe(o,U,R,d)}}let g=0,l=n,v=n*n-e*e*n+.25*e*e,p=2*n*n*g,w=2*e*e*l;for(;p<w;)o.pen.draw(o,Math.floor(g+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(-g+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(g+r),Math.floor(-l+i),a),o.pen.draw(o,Math.floor(-g+r),Math.floor(-l+i),a),v<0?(g++,p=p+2*n*n,v=v+p+n*n):(g++,l--,p=p+2*n*n,w=w-2*e*e,v=v+p-w+n*n);let E=n*n*((g+.5)*(g+.5))+e*e*((l-1)*(l-1))-e*e*n*n;for(;l>=0;)o.pen.draw(o,Math.floor(g+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(-g+r),Math.floor(l+i),a),o.pen.draw(o,Math.floor(g+r),Math.floor(-l+i),a),o.pen.draw(o,Math.floor(-g+r),Math.floor(-l+i),a),E>0?(l--,w=w-2*e*e,E=E+e*e-w):(l--,g++,p=p+2*n*n,w=w-2*e*e,E=E+p-w+e*e);c.commands.setImageDirty(o)}function y(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)){let g=new TypeError("ellipse: parameters x, y, radiusX, radiusY must be numbers.");throw g.code="INVALID_COORDINATES",g}let u=!1;if(d!=null){if(d=c.commands.findColorValue(o,d,"ellipse"),d===void 0)return;u=!0}o.screenObj.render();let a=o.context;a.beginPath(),a.strokeStyle=o.fColor.s,a.moveTo(r+e,i),a.ellipse(r,i,e,n,0,t.util.math.deg360,!1),u&&(a.fillStyle=d.s,a.fill()),a.stroke(),c.commands.resetImageData(o)}t._.addCommands("arc",h,f,["x","y","radius","angle1","angle2"]);function h(o,s){let r=Math.round(s[0]),i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=s[4];n=(n+360)%360,d=(d+360)%360;let u=n>d;if(isNaN(r)||isNaN(i)||isNaN(e)){let w=new TypeError("arc: x, y, radius must be integers.");throw w.code="INVALID_COORDINATES",w}c.commands.getImageData(o);let a=o.fColor;function g(w,E){let N=t.util.radiansToDegrees(Math.atan2(E-i,w-r));return N=(N+360)%360,u?N>=n||N<=d:N>=n&&N<=d}e-=1,e<0&&(e=0);let l=e,v=0;if(e>1)g(l+r,v+i)&&o.pen.draw(o,l+r,v+i,a),g(-l+r,v+i)&&o.pen.draw(o,-l+r,v+i,a),g(r,l+i)&&o.pen.draw(o,r,l+i,a),g(r,-l+i)&&o.pen.draw(o,r,-l+i,a);else if(e===1){g(r+1,i)&&o.pen.draw(o,r+1,i,a),g(r-1,i)&&o.pen.draw(o,r-1,i,a),g(r,i+1)&&o.pen.draw(o,r,i+1,a),g(r,i-1)&&o.pen.draw(o,r,i-1,a),c.commands.setImageDirty(o);return}else if(e===0){o.pen.draw(o,r,i,a),c.commands.setImageDirty(o);return}let p=1-e;for(;l>v;)v+=1,p<=0?p=p+2*v+1:(l-=1,p=p+2*v-2*l+1),g(l+r,v+i)&&o.pen.draw(o,l+r,v+i,a),g(-l+r,v+i)&&o.pen.draw(o,-l+r,v+i,a),g(l+r,-v+i)&&o.pen.draw(o,l+r,-v+i,a),g(-l+r,-v+i)&&o.pen.draw(o,-l+r,-v+i,a),l!==v&&(g(v+r,l+i)&&o.pen.draw(o,v+r,l+i,a),g(-v+r,l+i)&&o.pen.draw(o,-v+r,l+i,a),g(v+r,-l+i)&&o.pen.draw(o,v+r,-l+i,a),g(-v+r,-l+i)&&o.pen.draw(o,-v+r,-l+i,a));c.commands.setImageDirty(o)}function f(o,s){let r=s[0],i=s[1],e=s[2],n=s[3],d=s[4];if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(n)||isNaN(d)){let a=new TypeError("arc: parameters must be numbers.");throw a.code="INVALID_COORDINATES",a}r=r+.5,i=i+.5,e=e-.9,e<0&&(e=0),o.screenObj.render(),n=t.util.degreesToRadian(n),d=t.util.degreesToRadian(d);let u=o.context;u.beginPath(),u.strokeStyle=o.fColor.s,u.moveTo(r+Math.cos(n)*e,i+Math.sin(n)*e),u.arc(r,i,e,n,d),u.stroke(),c.commands.resetImageData(o)}}function Pe(t){let c=t._.data,I=65025*3.25,C,b;t._.addCommand("paint",L,!1,!0,["x","y","fillColor","tolerance"]);function L(x,m){let y=Math.round(m[0]),h=Math.round(m[1]),f=m[2],o=m[3];if(!t.util.isInteger(y)||!t.util.isInteger(h)){let i=new TypeError("paint: parameters x and y must be integers");throw i.code="INVALID_COORDINATES",i}if((o==null||o===!1)&&(o=1),isNaN(o)||o<0||o>1){let i=new RangeError("paint: parameter tolerance must be a number between 0 and 1.");throw i.code="INVALID_TOLERANCE",i}o=o*(2-o)*I,navigator.brave&&o===I&&(o-=1);let s=[{x:y,y:h}];if(x.pen.noise?C=F:C=c.commands.setPixel,t.util.isInteger(f)){if(f>x.pal.length){let i=new RangeError("paint: Argument fillColor is not a color in the palette.");throw i.code="COLOR_OUT_OF_RANGE",i}f=x.pal[f]}else if(f=t.util.convertToColor(f),f===null){let i=new TypeError("paint: Argument fillColor is not a valid color format.");throw i.code="INVALID_COLOR",i}b={},c.commands.getImageData(x);let r=c.commands.getPixelInternal(x,y,h);for(;s.length>0;){let i=s.pop();C(x,i.x,i.y,f),M(x,i.x+1,i.y,s,f,r,o),M(x,i.x-1,i.y,s,f,r,o),M(x,i.x,i.y+1,s,f,r,o),M(x,i.x,i.y-1,s,f,r,o)}b=null,c.commands.setImageDirty(x)}function F(x,m,y,h){h=c.commands.getPixelColor(x,h),c.commands.setPixel(x,m,y,h)}function _(x,m){let y=x+" "+m;return b[y]?!0:(b[y]=!0,!1)}function M(x,m,y,h,f,o,s){if(S(x,m,y,f,o,s)){C(x,m,y,f);let r={x:m,y};h.push(r)}}function S(x,m,y,h,f,o){if(m<0||m>=x.width||y<0||y>=x.height)return!1;let s=c.commands.getPixelInternal(x,m,y);if(!_(m,y)){let r=s.r-f.r,i=s.g-f.g,e=s.b-f.b,n=s.a-f.a,d=r*r+i*i+e*e+n*n*.25;return I-d>=o}return!1}}function Re(t){let c=t._.data;t._.addCommands("bezier",I,C,["xStart","yStart","x1","y1","x2","y2","xEnd","yEnd"]);function I(F,_){let M=Math.round(_[0]),S=Math.round(_[1]),x=Math.round(_[2]),m=Math.round(_[3]),y=Math.round(_[4]),h=Math.round(_[5]),f=Math.round(_[6]),o=Math.round(_[7]);if(isNaN(M)||isNaN(S)||isNaN(x)||isNaN(m)||isNaN(y)||isNaN(h)||isNaN(f)||isNaN(o)){let a=new TypeError("bezier: parameters xStart, yStart, x1, y1, x2, y2, xEnd, and yEnd must be numbers.");throw a.code="INVALID_COORDINATES",a}let s=F.fColor;c.commands.getImageData(F);let r=F.pen.size,i=[{x:M,y:S},{x,y:m},{x:y,y:h},{x:f,y:o}],e=L(0,i);F.pen.draw(F,e.x,e.y,s);let n=.1,d=.1;for(;n<1;){let a=L(n,i);b(a,e)>r&&d>1e-5?(n-=d,d=d*.75):(F.pen.draw(F,a.x,a.y,s),e=a),n+=d}let u=L(1,i);F.pen.draw(F,u.x,u.y,s),c.commands.setImageDirty(F)}function C(F,_){let M=_[0]+.5,S=_[1]+.5,x=_[2]+.5,m=_[3]+.5,y=_[4]+.5,h=_[5]+.5,f=_[6]+.5,o=_[7]+.5;if(isNaN(M)||isNaN(S)||isNaN(x)||isNaN(m)||isNaN(y)||isNaN(h)||isNaN(f)||isNaN(o)){let r=new TypeError("bezier: parameters xStart, yStart, x1, y1, x2, y2, xEnd, and yEnd must be numbers.");throw r.code="INVALID_COORDINATES",r}F.screenObj.render();let s=F.context;s.strokeStyle=F.fColor.s,s.beginPath(),s.moveTo(M,S),s.bezierCurveTo(x,m,y,h,f,o),s.stroke(),c.commands.resetImageData(F)}function b(F,_){let M=F.x-_.x,S=F.y-_.y;return M*M+S*S}function L(F,_){let M=1-F,S=M*M,x=M*M*M,m=F*F,y=F*F*F;return{x:Math.round(x*_[0].x+3*S*F*_[1].x+3*M*m*_[2].x+y*_[3].x),y:Math.round(x*_[0].y+3*S*F*_[1].y+3*M*m*_[2].y+y*_[3].y)}}}function Oe(t){let c=t._.data,I=t._.wait,C=t._.resume,b=null;t._.addCommand("loadImage",L,!1,!1,["src","name"]);function L(h){let f=h[0],o=h[1],s,r,i;if(typeof f=="string")s=new Image,s.src=f;else{if(!f||f.tagName!=="IMG"&&f.tagName!=="CANVAS"){let e=new TypeError("loadImage: src must be a string, image element, or canvas.");throw e.code="INVALID_IMAGE_SOURCE",e}s=f}return typeof o!="string"&&(o=""+c.imageCount,c.imageCount+=1),c.images[o]={image:null,type:"image"},r=b,b=null,s.complete?(c.images[o].image=s,t.util.isFunction(r)&&r()):(I(),t.util.isFunction(s.onload)&&(i=s.onload),s.onload=function(){i&&i(),c.images[o].image=s,t.util.isFunction(r)&&r(),C()}),o}t._.addCommand("loadSpritesheet",F,!1,!1,["src","name","width","height","margin"]);function F(h){let f=h[0],o=h[1],s=h[2],r=h[3],i=h[4];i==null&&(i=0);let e=!1;if(s==null&&r==null&&(e=!0,s=0,r=0,i=0),s=Math.round(s),r=Math.round(r),i=Math.round(i),!e&&(!t.util.isInteger(s)||!t.util.isInteger(r))){let n=new TypeError("loadSpriteSheet: width, and height must be integers.");throw n.code="INVALID_SPRITE_SIZE",n}if(!e&&(s<1||r<1)){let n=new RangeError("loadSpriteSheet: width, and height must be greater than 0.");throw n.code="INVALID_SPRITE_SIZE",n}if(!t.util.isInteger(i)){let n=new TypeError("loadSpriteSheet: margin must be an integer.");throw n.code="INVALID_MARGIN",n}return typeof o!="string"&&(o=""+c.imageCount,c.imageCount+=1),b=function(){let n=c.images[o];n.type="spritesheet",n.spriteWidth=s,n.spriteHeight=r,n.margin=i,n.frames=[],n.isAuto=e;let d=n.image.width,u=n.image.height;if(n.isAuto){let w=function(E,N,T){let P=E+"_"+N;if(a[P]||E<0||E>=d||N<0||N>=u)return;let R=[];for(R.push([E,N,P]);R.length>0;){let H=R.pop();E=H[0],N=H[1];let U=H[2];a[U]=!0;let B=(E+N*d)*4;if(p[B+3]>0){T.x=Math.min(T.x,E),T.y=Math.min(T.y,N),T.right=Math.max(T.right,E),T.bottom=Math.max(T.bottom,N),T.width=T.right-T.x+1,T.height=T.bottom-T.y+1;for(let Y=0;Y<v.length;Y++){let $=E+v[Y][0],X=N+v[Y][1],Z=$+"_"+X;a[Z]||$<0||$>=d||X<0||X>=u||R.push([$,X,Z])}}}},a={},g=document.createElement("canvas");g.width=d,g.height=u;let l=g.getContext("2d",{willReadFrequently:!0});l.drawImage(n.image,0,0);let v=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]],p=l.getImageData(0,0,d,u).data;for(let E=3;E<p.length;E+=4)if(p[E]>0){let N=(E-3)/4,T=N%d,P=Math.floor(N/d),R={x:d,y:u,width:0,height:0,right:0,bottom:0};w(T,P,R),R.width+R.height>4&&n.frames.push(R)}}else{let a=n.margin,g=n.margin,l=a+n.spriteWidth,v=g+n.spriteHeight;for(;v<=u-n.margin;){for(;l<=d-n.margin;)n.frames.push({x:a,y:g,width:n.spriteWidth,height:n.spriteHeight,right:a+n.spriteWidth-1,bottom:g+n.spriteHeight-1}),a+=n.spriteWidth+n.margin,l=a+n.spriteWidth;a=n.margin,l=a+n.spriteWidth,g+=n.spriteHeight+n.margin,v=g+n.spriteHeight}}},L([f,o]),o}t._.addCommand("getSpritesheetData",_,!1,!0,["name"]);function _(h,f){let o=f[0];if(!c.images[o]){let i=new Error("getSpritesheetData: invalid sprite name");throw i.code="INVALID_SPRITE_NAME",i}let s=c.images[o];if(s.type!=="spritesheet"){let i=new Error("getSpritesheetData: image is not a sprite");throw i.code="NOT_A_SPRITESHEET",i}let r={frameCount:s.frames.length,frames:[]};for(let i=0;i<s.frames.length;i++)r.frames.push({index:i,x:s.frames[i].x,y:s.frames[i].y,width:s.frames[i].width,height:s.frames[i].height,left:s.frames[i].x,top:s.frames[i].y,right:s.frames[i].right,bottom:s.frames[i].bottom});return r}t._.addCommand("getImage",M,!1,!0,["name","x1","y1","x2","y2"]);function M(h,f){let o=f[0],s=Math.round(f[1]),r=Math.round(f[2]),i=Math.round(f[3]),e=Math.round(f[4]);if(isNaN(s)||isNaN(r)||isNaN(i)||isNaN(e)){let g=new TypeError("getImage: parameters x1, x2, y1, y2 must be integers.");throw g.code="INVALID_COORDINATES",g}if(typeof o!="string")o=""+c.imageCount,c.imageCount+=1;else if(c.images[o]){let g=new Error(`getImage: name ${o} is already used; name must be unique.`);throw g.code="DUPLICATE_IMAGE_NAME",g}let n=document.createElement("canvas"),d=n.getContext("2d"),u=Math.abs(s-i),a=Math.abs(r-e);return n.width=u,n.height=a,h.screenObj.render(),d.drawImage(h.screenObj.canvas(),s,r,u,a,0,0,u,a),c.images[o]={image:n,type:"image"},o}t._.addCommand("removeImage",S,!1,!1,["name"]);function S(h){let f=h[0];if(typeof f!="string"){let o=new TypeError("removeImage: name must be a string.");throw o.code="INVALID_NAME",o}delete c.images[f]}t._.addCommand("drawImage",x,!1,!0,["name","x","y","angle","anchorX","anchorY","alpha","scaleX","scaleY"]);function x(h,f){let o=f[0],s=f[1],r=f[2],i=f[3],e=f[4],n=f[5],d=f[6],u=f[7],a=f[8],g;if(typeof o=="string"){if(!c.images[o]){let l=new Error("drawImage: invalid image name");throw l.code="INVALID_IMAGE_NAME",l}g=c.images[o].image}else{if(!o||!o.canvas&&!o.getContext){let l=new TypeError("drawImage: image source object type must be an image already loaded by the loadImage command or a screen.");throw l.code="INVALID_IMAGE_SOURCE",l}t.util.isFunction(o.canvas)?g=o.canvas():g=o}if(isNaN(s)||isNaN(r)){let l=new TypeError("drawImage: parameters x and y must be numbers");throw l.code="INVALID_COORDINATES",l}y(h,g,s,r,i,e,n,d,null,u,a)}t._.addCommand("drawSprite",m,!1,!0,["name","frame","x","y","angle","anchorX","anchorY","alpha","scaleX","scaleY"]);function m(h,f){let o=f[0],s=f[1],r=f[2],i=f[3],e=f[4],n=f[5],d=f[6],u=f[7],a=f[8],g=f[9];if(!c.images[o]){let v=new Error("drawSprite: invalid sprite name");throw v.code="INVALID_SPRITE_NAME",v}if(!t.util.isInteger(s)||s>=c.images[o].frames.length||s<0){let v=new RangeError("drawSprite: frame number is not valid");throw v.code="INVALID_FRAME",v}if(isNaN(r)||isNaN(i)){let v=new TypeError("drawSprite: parameters x and y must be numbers");throw v.code="INVALID_COORDINATES",v}let l=c.images[o].image;y(h,l,r,i,e,n,d,u,c.images[o].frames[s],a,g)}function y(h,f,o,s,r,i,e,n,d,u,a){(u==null||isNaN(Number(u)))&&(u=1),(a==null||isNaN(Number(a)))&&(a=1),r==null&&(r=0),r=t.util.degreesToRadian(r),i||(i=0),e||(e=0),!n&&n!==0&&(n=255),d?(i=Math.round(d.width*i),e=Math.round(d.height*e)):(i=Math.round(f.width*i),e=Math.round(f.height*e));let g=h.context,l=g.globalAlpha;g.globalAlpha=n/255,h.screenObj.render(),g.translate(o,s),g.rotate(r),g.scale(u,a),d==null?g.drawImage(f,-i,-e):g.drawImage(f,d.x,d.y,d.width,d.height,-i,-e,d.width,d.height),g.scale(1/u,1/a),g.rotate(-r),g.translate(-o,-s),g.globalAlpha=l,c.commands.resetImageData(h)}}function Ve(t){let c=t._.data,I=t._.wait,C=t._.resume;t._.addCommand("loadFont",b,!1,!1,["fontSrc","width","height","charSet","isEncoded"]);function b(s){let r=s[0],i=Math.round(s[1]),e=Math.round(s[2]),n=s[3],d=!!s[4];if(isNaN(i)||isNaN(e)){let g=new TypeError("loadFont: width and height must be integers.");throw g.code="INVALID_FONT_SIZE",g}if(!n){n=[];for(let g=0;g<256;g+=1)n.push(g)}if(!(t.util.isArray(n)||typeof n=="string")){let g=new TypeError("loadFont: charSet must be an array or a string.");throw g.code="INVALID_CHARSET",g}if(typeof n=="string"){let g=[];for(let l=0;l<n.length;l+=1)g.push(n.charCodeAt(l));n=g}let u={};for(let g=0;g<n.length;g+=1)u[n[g]]=g;let a={id:c.nextFontId,width:i,height:e,data:[],chars:u,charSet:n,colorCount:2,mode:"pixel",printFunction:c.commands.piPrint,calcWidth:c.commands.piCalcWidth,image:null,sWidth:i,sHeight:e};return d||(a.mode="bitmap",a.printFunction=c.commands.bitmapPrint),c.fonts[a.id]=a,c.nextFontId+=1,d?L(r,i,e,a):_(r,a),a.id}function L(s,r,i,e){e.data=F(s,r,i)}function F(s,r,i){let d="",u=[];s=""+s;let a=s.split(",");for(let l=0;l<a.length;l++){let v=parseInt(a[l],32).toString(2);for(let p=v.length;p<32;p++)v="0"+v;d+=v}let g=0;if(d.length%32>0)return console.warn("loadFont: Invalid font data."),u;for(;g<d.length;){u.push([]);let l=u.length-1;for(let v=0;v<i;v+=1){u[l].push([]);for(let p=0;p<r;p+=1){let w;g>=d.length?w=0:(w=parseInt(d[g]),isNaN(w)&&(w=0)),u[l][v].push(w),g+=1}}}return u}function _(s,r){let i;if(typeof s=="string")i=new Image,i.src=s;else if(s instanceof HTMLImageElement)i=s;else{let e=new TypeError("loadFont: fontSrc must be a string, image or canvas.");throw e.code="INVALID_FONT_SOURCE",e}i.complete?r.image=i:(I(),i.onload=function(){r.image=i,C()},i.onerror=function(e){console.warn("loadFont: unable to load image for font."),C()})}t._.addCommand("setDefaultFont",M,!1,!1,["fontId"]),t._.addSetting("defaultFont",M,!1,["fontId"]);function M(s){let r=parseInt(s[0]);if(isNaN(r)||r<0||!c.fonts[r]){let i=new Error("setDefaultFont: invalid fontId");throw i.code="INVALID_FONT_ID",i}c.defaultFont=c.fonts[r]}t._.addCommand("setFont",S,!1,!0,["fontId"]),t._.addSetting("font",S,!0,["fontId"]);function S(s,r){let i=r[0];if(c.fonts[i]){let e=c.fonts[i];s.printCursor.font=e,s.printCursor.cols=Math.floor(s.width/e.width),s.printCursor.rows=Math.floor(s.height/e.height)}else if(typeof i=="string"){s.context.font=i,s.context.textBaseline="top";let e=x(s.context);s.printCursor.font={name:s.context.font,width:e.width,height:e.height,mode:"canvas",printFunction:c.commands.canvasPrint,calcWidth:c.commands.canvasCalcWidth},s.printCursor.cols=Math.floor(s.width/e.width),s.printCursor.rows=Math.floor(s.height/e.height)}}function x(s){let r=s.measureText("M").width;r=Math.round(r*1.5);let i=document.createElement("canvas");i.width=r,i.height=r;let e=i.getContext("2d",{willReadFrequently:!0});e.font=s.font,e.textBaseline="top",e.fillStyle="#FF0000";let n={height:0,width:0};e.fillText("M",0,0);let d=e.getImageData(0,0,r,r).data;for(let u=0;u<r;u++)for(let a=0;a<r;a++){let g=(u*r+a)*4;d[g+3]>0&&(a>n.width&&(n.width=a),u>n.height&&(n.height=u))}return n.width+=1,n.height+=1,n}t._.addCommand("canvasPrint",m,!0,!1);function m(s,r,i,e){s.context.fillStyle=s.fColor.s,s.context.fillText(r,i,e)}t._.addCommand("bitmapPrint",y,!0,!1);function y(s,r,i,e){s.screenObj.render();let n=s.printCursor.font,d=n.image.width,u=Math.floor(d/n.sWidth);for(let a=0;a<r.length;a++){let g=n.chars[r.charCodeAt(a)],l=g%u*n.sWidth,v=Math.floor(g/u)*n.sHeight;s.context.drawImage(n.image,l,v,n.sWidth,n.sHeight,i+n.width*a,e,n.width,n.height)}}t._.addCommand("getAvailableFonts",h,!1,!1,[]);function h(){let s=[];for(let r in c.fonts)s.push({id:c.fonts[r].id,width:c.fonts[r].width,height:c.fonts[r].height});return s}t._.addCommand("setFontSize",f,!1,!0,["width","height"]),t._.addSetting("fontSize",f,!0,["width","height"]);function f(s,r){let i=r[0],e=r[1];if(isNaN(i)){let n=new TypeError("setFontSize: width must be a number");throw n.code="INVALID_WIDTH",n}if(isNaN(e)){let n=new TypeError("setFontSize: height must be a number");throw n.code="INVALID_HEIGHT",n}if(s.printCursor.font.mode!=="bitmap"){console.warn("setFontSize: only bitmap fonts can change sizes");return}s.printCursor.font.width=i,s.printCursor.font.height=e,s.printCursor.cols=Math.floor(s.width/i),s.printCursor.rows=Math.floor(s.height/e)}t._.addCommand("setChar",o,!1,!0,["code","data"]),t._.addSetting("char",o,!0,["code","data"]);function o(s,r){let i=r[0],e=r[1];if(s.printCursor.font.mode!=="pixel"){console.warn("setChar: only pixel fonts can change characters");return}if(typeof i=="string"?i=i.charCodeAt(0):i=Math.round(i),isNaN(i)){let n=new TypeError("setChar: code must be an integer or a string");throw n.code="INVALID_CODE",n}if(typeof e=="string")e=t.util.hexToData(e,s.printCursor.font.width,s.printCursor.font.height);else if(t.util.isArray(e)){if(e.length!==s.printCursor.font.height){let n=new RangeError("setChar: data array is the wrong length");throw n.code="INVALID_DATA_LENGTH",n}for(let n=0;n<e.length;n++){if(e[n].length!==s.printCursor.font.width){let d=new RangeError("setChar: data array row is the wrong length");throw d.code="INVALID_DATA_WIDTH",d}for(let d=0;d<e[n].length;d++)if(!t.util.isInteger(e[n][d])){let u=new TypeError("setChar: data array contains invalid data");throw u.code="INVALID_DATA_VALUE",u}}}else{let n=new TypeError("setChar: data must be a string or an array");throw n.code="INVALID_DATA_TYPE",n}s.printCursor.font.data[i]=e}}function Be(t){let c=t._.data;t._.addCommand("print",I,!1,!0,["msg","inLine","isCentered"]);function I(o,s){let r=s[0],i=s[1],e=s[2];if(o.printCursor.font.height>o.height)return;r===void 0?r="":typeof r!="string"&&(r=""+r),r=r.replace(/\t/g,"    ");let n=r.split(/\n/);for(let d=0;d<n.length;d++)C(o,n[d],i,e)}function C(o,s,r,i){let e=o.printCursor,n=e.font.calcWidth(o,s);if(i&&(e.x=Math.floor((e.cols-s.length)/2)*o.printCursor.font.width),!r&&!i&&n+e.x>o.width&&s.length>1){let d=n+e.x-o.width,a=(n-d)/n,g=Math.floor(s.length*a),l=s.substring(0,g),v=s.substring(g,s.length);if(e.breakWord){let p=l.lastIndexOf(" ");p>-1&&(v=l.substring(p).trim()+v,l=l.substring(0,p))}C(o,l,r,i),C(o,v,r,i);return}e.y+e.font.height>o.height&&(e.font.mode==="canvas"&&o.screenObj.render(),b(o,e.font.height),e.y-=e.font.height),e.font.printFunction(o,s,e.x,e.y),r?(e.x+=e.font.width*s.length,e.x>o.width-e.font.width&&(e.x=0,e.y+=e.font.height)):(e.y+=e.font.height,e.x=0)}function b(o,s){if(s<=0)return;c.commands.getImageData(o);let r=s;for(;r<o.height;r++)for(let i=0;i<o.width;i++){let e=(o.width*r+i)*4,n=(o.width*(r-s)+i)*4,d=o.imageData.data;o.imageData.data[n]=d[e],o.imageData.data[n+1]=d[e+1],o.imageData.data[n+2]=d[e+2],o.imageData.data[n+3]=d[e+3]}for(r=o.height-s;r<o.height;r++)for(let i=0;i<o.width;i++){let e=(o.width*r+i)*4;o.imageData.data[e]=0,o.imageData.data[e+1]=0,o.imageData.data[e+2]=0,o.imageData.data[e+3]=0}c.commands.setImageDirty(o)}t._.addCommand("piCalcWidth",L,!0,!1);function L(o,s){return o.printCursor.font.width*s.length}t._.addCommand("canvasCalcWidth",F,!0,!1);function F(o,s){return o.context.measureText(s).width}t._.addCommand("setWordBreak",_,!1,!0,["isEnabled"]),t._.addSetting("wordBreak",_,!0,["isEnabled"]);function _(o,s){o.printCursor.breakWord=!!s[0]}t._.addCommand("piPrint",M,!0,!1);function M(o,s,r,i){let e=o.printCursor,n=o.pal;o.pal=[o.pal[0],o.fColor];for(let d=0;d<s.length;d++){let u=e.font.chars[s.charCodeAt(d)];u!==void 0&&e.font.data[u]&&o.screenObj.put(e.font.data[u],r+d*e.font.width,i,!1)}o.pal=n}t._.addCommand("setPos",S,!1,!0,["col","row"]),t._.addSetting("pos",S,!0,["col","row"]);function S(o,s){let r=s[0],i=s[1];if(r!=null){if(isNaN(r)){let n=new TypeError("setPos: parameter col must be a number");throw n.code="INVALID_COL",n}let e=Math.floor(r*o.printCursor.font.width);e>o.width&&(e=o.width-o.printCursor.font.width),o.printCursor.x=e}if(i!=null){if(isNaN(i)){let n=new TypeError("setPos: parameter row must be a number");throw n.code="INVALID_ROW",n}let e=Math.floor(i*o.printCursor.font.height);e>o.height&&(e=o.height-o.printCursor.font.height),o.printCursor.y=e}}t._.addCommand("setPosPx",x,!1,!0,["x","y"]),t._.addSetting("posPx",x,!0,["x","y"]);function x(o,s){let r=s[0],i=s[1];if(r!=null){if(isNaN(r)){let e=new TypeError("setPosPx: parameter x must be an integer");throw e.code="INVALID_X",e}o.printCursor.x=Math.round(r)}if(i!=null){if(isNaN(i)){let e=new TypeError("setPosPx: parameter y must be an integer");throw e.code="INVALID_Y",e}o.printCursor.y=Math.round(i)}}t._.addCommand("getPos",m,!1,!0,[]);function m(o){return{col:Math.floor(o.printCursor.x/o.printCursor.font.width),row:Math.floor(o.printCursor.y/o.printCursor.font.height)}}t._.addCommand("getCols",y,!1,!0,[]);function y(o){return o.printCursor.cols}t._.addCommand("getRows",h,!1,!0,[]);function h(o){return o.printCursor.rows}t._.addCommand("getPosPx",f,!1,!0,[]);function f(o){return{x:o.printCursor.x,y:o.printCursor.y}}}function qe(t){let c=t._.data,I={single:[[218,196,194,191],[195,196,197,180],[192,196,193,217],[179,32,179]],double:[[201,205,203,187],[204,205,206,185],[200,205,202,188],[186,32,186]],singleDouble:[[213,205,209,184],[198,205,216,181],[212,205,207,190],[179,32,179]],doubleSingle:[[214,196,210,183],[199,196,215,182],[211,196,208,189],[186,32,186]],thick:[[219,223,219,219],[219,223,219,219],[223,223,223,223],[219,32,219]]};t._.addCommand("printTable",C,!1,!0,["items","tableFormat","borderStyle","isCentered"]);function C(x,m){let y=m[0],h=m[1],f=m[2],o=!!m[3];if(!t.util.isArray(y)){let r=new TypeError("printTable: items must be an array");throw r.code="INVALID_ITEMS",r}f||(f=I.single);let s;if(h==null)s=!1;else if(t.util.isArray(h)){for(let r=0;r<h.length;r++)if(typeof h[r]!="string"){let i=new TypeError("printTable: tableFormat must be an array of strings");throw i.code="INVALID_FORMAT",i}s=!0}else{let r=new TypeError("printTable: tableFormat must be an array");throw r.code="INVALID_FORMAT",r}if(typeof f=="string"&&I[f])f=I[f];else if(!t.util.isArray(f)){let r=new TypeError("printTable: borderStyle must be an integer or array");throw r.code="INVALID_BORDER_STYLE",r}if(s)return L(x,y,f,h,o);{let r=c.commands.getCols(x);return b(x,y,r,f)}}function b(x,m,y,h){let f="",o=[],s=x.printCursor.font,r=c.commands.getPos(x),i=2;for(let e=0;e<m.length;e+=1){let n=Math.floor(y/m[e].length);n<3&&(n=3);let d=(n-2)*m[e].length+m[e].length+1,u=Math.round((y-d)/2),a=t.util.padL("",u," "),g=a,l=a;for(let v=0;v<m[e].length;v+=1){_(v*(n-1)+u,e*2+r.row,o,s);let p=o[o.length-1];p.pos.width=n-1,p.pos.height=2,p.pixels.width=p.pos.width*s.width,p.pixels.height=p.pos.height*s.height,v===m[e].length-1&&(p.pixels.width+=1),e===m.length-1&&(p.pixels.height+=1),g+=String.fromCharCode(h[3][0])+t.util.pad(m[e][v],n-2,String.fromCharCode(h[3][1])),v===m[e].length-1&&(g+=String.fromCharCode(h[3][2])),e===0&&(v===0?a+=String.fromCharCode(h[0][0]):a+=String.fromCharCode(h[0][2]),a+=t.util.pad("",n-2,String.fromCharCode(h[0][1])),v===m[e].length-1&&(a+=String.fromCharCode(h[0][3])));let w;e===m.length-1?w=2:w=1,v===0?l+=String.fromCharCode(h[w][0]):l+=String.fromCharCode(h[w][2]),l+=t.util.pad("",n-2,String.fromCharCode(h[w][1])),v===m[e].length-1&&(l+=String.fromCharCode(h[w][3]))}e===0&&(f+=a+`
`),f+=g+`
`,f+=l+`
`}return f=f.substr(0,f.length-1),c.commands.print(x,[f]),o}function L(x,m,y,h,f){let o="",s=[],r=c.commands.getPos(x),i=x.printCursor.font;f&&(r.col=Math.floor((c.commands.getCols(x)-h[0].length)/2));let e=t.util.pad("",r.col," ");c.commands.setPos(x,[0,r.row]);for(let u=0;u<h.length;u+=1){o+=e;for(let a=0;a<h[u].length;a+=1){let g=h[u].charAt(a);if(g==="*"){let l=""+S(a,u,"left",h)+S(a,u,"right",h)+S(a,u,"up",h)+S(a,u,"down",h);l===" - |"?(o+=String.fromCharCode(y[0][0]),_(r.col+a,r.row+u,s,i)):l==="-- |"?(o+=String.fromCharCode(y[0][2]),_(r.col+a,r.row+u,s,i)):l==="-  |"?o+=String.fromCharCode(y[0][3]):l===" -||"?(o+=String.fromCharCode(y[1][0]),_(r.col+a,r.row+u,s,i)):l==="--||"?(o+=String.fromCharCode(y[1][2]),_(r.col+a,r.row+u,s,i)):l==="- ||"?o+=String.fromCharCode(y[1][3]):l===" -| "?o+=String.fromCharCode(y[2][0]):l==="--| "?o+=String.fromCharCode(y[2][2]):l==="- | "&&(o+=String.fromCharCode(y[2][3]))}else g==="-"?o+=String.fromCharCode(y[0][1]):g==="|"?o+=String.fromCharCode(y[3][0]):o+=" "}o+=`
`}let n=c.commands.getPos(x);M(s,h,i,r),o=o.substr(0,o.length-1),c.commands.print(x,[o]);let d=0;for(let u=0;u<m.length;u+=1)if(t.util.isArray(m[u]))for(let a=0;a<m[u].length;a+=1)d<s.length&&(F(x,s[d],m[u][a],r.col),d+=1);else F(x,s[d],m[u],r.col),d+=1;return c.commands.setPos(x,[0,n.row+h.length]),s}function F(x,m,y){if(!m)return;y=""+y;let h=m.pos.width,f=m.pos.height,o=m.format.toLowerCase()==="v";o?y.length>f&&(y=y.substr(0,f)):y.length>h&&(y=y.substr(0,h));let s=c.commands.getPos(x);if(o){let r=0,i=m.pos.col+Math.round(h/2),e=m.pos.row+1+Math.floor((f-y.length)/2);for(let n=e;n<=f+e;n+=1)c.commands.setPos(x,[i,n]),c.commands.print(x,[y.charAt(r),!0]),r+=1}else{let r=m.pos.col+1+Math.floor((h-y.length)/2),i=m.pos.row+Math.round(f/2);c.commands.setPos(x,[r,i]),c.commands.print(x,[y,!0])}c.commands.setPos(x,[s.col,s.row])}function _(x,m,y,h){y.push({pos:{col:x,row:m,width:null,height:null},pixels:{x:x*h.width+Math.round(h.width/2)-1,y:m*h.height+Math.round(h.height/2),width:null,height:null},format:" "})}function M(x,m,y,h){for(let f=0;f<x.length;f+=1){let o=x[f],s=o.pos.col+1-h.col,r=o.pos.row+1-h.row;for(r<m.length&&s<m[r].length&&(o.format=m[r].charAt(s)),s=o.pos.col-h.col,r=o.pos.row-h.row;s<m[r].length-1;)if(s+=1,m[r].charAt(s)==="*"&&S(s,r,"down",m)==="|"){o.pos.width=h.col+(s-1)-o.pos.col,o.pixels.width=(o.pos.width+1)*y.width;break}for(o.pos.width===null&&(o.pos.width=h.col+(s-1)-o.pos.col,o.pixels.width=(o.pos.width+1)*y.width+1);r<m.length-1;)if(r+=1,m[r].charAt(s)==="*"&&S(s,r,"left",m)==="-"){o.pos.height=h.row+(r-1)-o.pos.row,o.pixels.height=(o.pos.height+1)*y.height;break}o.pos.height===null&&(o.pos.height=h.row+(r-1)-o.pos.row,o.pixels.height=(o.pos.height+1)*y.height+1)}}function S(x,m,y,h){return y==="left"?x-=1:y==="right"?x+=1:y==="up"?m-=1:y==="down"&&(m+=1),m>=h.length||m<0||x<0||x>=h[m].length?" ":h[m].charAt(x)==="*"&&(y==="left"||y==="right")?"-":h[m].charAt(x)==="*"&&(y==="up"||y==="down")?"|":h[m].charAt(x)}}function ze(t){let c=t._.data,I={},C={},b={},L=[],F=0,_={},M={},S={},x=!1,m=null,y={},h=[],f=0,o=null,s=!1,r=0,i=null,e=0,n=!1;t._.addCommand("startKeyboard",d,!1,!1,[]);function d(){if(n)return;let A=m||c.defaultInputFocus||window;A&&(A.addEventListener("keydown",a),A.addEventListener("keyup",g),A.addEventListener("blur",l),n=!0)}t._.addCommand("stopKeyboard",u,!1,!1,[]);function u(){if(I={},C={},b={},L=[],m_onkeyListeners={},S={},!n)return;let A=m||c.defaultInputFocus||window;A&&(A.removeEventListener("keydown",a),A.removeEventListener("keyup",g),A.removeEventListener("blur",l)),n=!1}function a(A){let j=A.key,k=A.code,O=A.keyCode,V={key:A.key,location:A.location,code:A.code,keyCode:A.keyCode};I[j]=V,C[O]=V,b[k]=V,L.push(V),(y[j]||y[k]||y[O])&&A.preventDefault(),x&&v("down",j,k)}function g(A){let j=A.key,k=A.code,O=A.keyCode;I[j]=!1,b[k]=!1,C[O]=!1,x&&v("up",j,k)}function l(){for(let A in I)I[A]=!1;for(let A in C)C[A]=!1;for(let A in b)b[A]=!1}function v(A,j,k){let O=_[j];if(O&&O[A])for(let V=O[A].length-1;V>=0;V--){let q=O[A][V];q.fn({key:j,code:k,mode:A}),q.once&&O[A].splice(V,1)}if(k&&k!==j){let V=_[k];if(V&&V[A])for(let q=V[A].length-1;q>=0;q--){let z=V[A][q];z.fn({key:j,code:k,mode:A}),z.once&&V[A].splice(q,1)}}if(M[A])for(let V=M[A].length-1;V>=0;V--){let q=M[A][V];q.fn({key:j,code:k,mode:A}),q.once&&M[A].splice(V,1)}}t._.addCommand("inkey",p,!1,!1,["key"]);function p(A){let j=A[0];if(d(),j!=null)return I[j]?I[j]:C[j]?C[j]:b[j]||!1;let k={};for(let O in b)b[O]&&(k[O]=b[O]);return k}t._.addCommand("onkey",w,!1,!1,["key","mode","fn","once"]);function w(A){let j=A[0],k=A[1]||"down",O=A[2],V=!!A[3];if(d(),x=!0,!t.util.isFunction(O)){let q=new TypeError("onkey: fn must be a function");throw q.code="INVALID_CALLBACK",q}if(j==null||j==="*"){M[k]||(M[k]=[]),M[k].push({fn:O,once:V});return}_[j]||(_[j]={}),_[j][k]||(_[j][k]=[]),_[j][k].push({fn:O,once:V})}t._.addCommand("offkey",E,!1,!1,["key","mode","fn"]);function E(A){let j=A[0],k=A[1]||"down",O=A[2];if(j==null||j==="*"){M[k]&&(O?M[k]=M[k].filter(V=>V.fn!==O):M[k]=[]);return}_[j]&&_[j][k]&&(O?_[j][k]=_[j][k].filter(V=>V.fn!==O):_[j][k]=[])}t._.addCommand("preventKey",N,!1,!1,["key","isPrevent"]);function N(A){let j=A[0];A[1]!==!1?y[j]=!0:delete y[j]}t._.addCommand("clearKeys",T,!1,!1,[]);function T(){I={},C={},b={},L=[],F=0}t._.addCommand("reinitKeyboard",P,!0,!1);function P(){n&&(u(),m=c.defaultInputFocus,d())}t._.addCommand("setInputFocus",R,!1,!0,["element"]);function R(A,j){let k=j[0];if(typeof k=="string"&&(k=document.getElementById(k)),!k||!t.util.canAddEventListeners(k)){let O=new TypeError("setInputFocus: Invalid element.");throw O.code="INVALID_ELEMENT",O}m=k,n&&(u(),d())}t._.addCommand("onkeyCombo",H,!1,!1,["keys","fn","once"]);function H(A){let j=A[0],k=A[1],O=!!A[2];if(!t.util.isArray(j)||j.length===0){let W=new TypeError("onkeyCombo: keys must be a non-empty array");throw W.code="INVALID_KEYS",W}if(!t.util.isFunction(k)){let W=new TypeError("onkeyCombo: fn must be a function");throw W.code="INVALID_CALLBACK",W}let V=j.join("+"),q=[],z={keys:j.slice(),keyData:[],fn:k,allKeys:q,once:O};S[V]||(S[V]=[]),S[V].push(z);for(let W=0;W<j.length;W++)U(j[W],W,q,k,O,z)}function U(A,j,k,O,V,q){q.keyData.push({key:A,keyComboDown:z,keyComboUp:W}),k.push(!1),w([A,"down",z,!1]),w([A,"up",W,!1]);function z(Q){k[j]=!0,k.indexOf(!1)===-1&&(V&&(E([A,"down",z]),E([A,"up",W])),O(Q))}function W(Q){k[j]=!1}}t._.addCommand("offkeyCombo",B,!1,!1,["keys","fn"]);function B(A){let j=A[0],k=A[1];if(!t.util.isArray(j))return;let O=j.join("+");if(S[O]){for(let V=S[O].length-1;V>=0;V--){let q=S[O][V];if(!k||q.fn===k){for(let z=0;z<q.keyData.length;z++){let W=q.keyData[z];E([W.key,"down",W.keyComboDown]),E([W.key,"up",W.keyComboUp])}S[O].splice(V,1)}}S[O].length===0&&delete S[O]}}t._.addCommand("input",Y,!1,!0,["prompt","callback","isNumber","isInteger","allowNegative"]);function Y(A,j){let k=j[0]||"",O=j[1],V=!!j[2],q=!!j[3],z=j[4]!==!1;if(typeof k!="string"){let J=new TypeError("input: prompt must be a string");throw J.code="INVALID_PROMPT",J}if(O!=null&&!t.util.isFunction(O)){let J=new TypeError("input: callback must be a function");throw J.code="INVALID_CALLBACK",J}let W,Q,Xe=new Promise((J,Qe)=>{W=J,Q=Qe}),Ze={prompt:k,isNumber:V,isInteger:q,allowNegative:z,val:"",callback:O,resolve:W,reject:Q,screenData:A};return h.push(Ze),h.length===1&&$(),Xe}function $(){d(),h[f]&&(r=Date.now(),i=null,e=0,o||(o=setInterval(Z,100)),w([null,"down",X,!1]))}function X(A){let j=h[f];if(!j)return;let k=!1;if(A.key==="Enter")fe(j);else if(A.key==="Backspace")j.val.length>0&&(j.val=j.val.substring(0,j.val.length-1));else if(A.key&&A.key.length===1){if(j.isNumber&&j.allowNegative){if(A.key==="-"&&j.val.length===0){j.val="-";return}else if(A.key==="+"&&j.val.charAt(0)==="-"){j.val=j.val.substring(1);return}}j.val+=A.key,j.isNumber&&(isNaN(Number(j.val))||j.isInteger&&A.key===".")&&(k=!0)}k&&(j.val=j.val.substring(0,j.val.length-1)),Z()}function Z(A){if(h.length===0||f>=h.length)return;let j=h[f],k=j.screenData,O=j.prompt+j.val,V=Date.now();V-r>500&&(s=!s,r=V),s&&!A&&(O+=k.printCursor.prompt);let q=c.commands.getPos(k);q.row>=c.commands.getRows(k)&&(c.commands.print(k,["",!1]),c.commands.setPos(k,[q.col,q.row-1]),q=c.commands.getPos(k));let z=c.commands.getPosPx(k),W=(O.length+1)*k.printCursor.font.width,Q=k.printCursor.font.height;i?e<W?(c.commands.put(k,[i,z.x,z.y,!0]),i=c.commands.get(k,[z.x,z.y,z.x+W,z.y+Q])):c.commands.put(k,[i,z.x,z.y,!0]):i=c.commands.get(k,[z.x,z.y,z.x+W,z.y+Q]),e=W,c.commands.print(k,[O,!0]),c.commands.setPos(k,[q.col,q.row]),c.commands.render(k)}function fe(A){Z(!0),o&&(clearInterval(o),o=null),i=null,e=0,E([null,"down",X]),ge(A),c.commands.print(A.screenData,[""]),A.callback&&A.callback(A.val),A.resolve(A.val),f++,f>=h.length?(h=[],f=0):$()}function ge(A){A.isNumber&&(A.val===""||A.val==="-"?A.val=0:(A.val=Number(A.val),A.isInteger&&(A.val=Math.floor(A.val))))}t._.addCommand("cancelInput",me,!1,!0,[]);function me(A){for(let j=h.length-1;j>=0;j--)h[j].screenData===A&&(h[j].reject(new Error("Input cancelled")),h.splice(j,1));o&&(clearInterval(o),o=null),E([null,"down",X]),f=0}t._.addCommand("setInputCursor",ne,!1,!0,["cursor"]),t._.addSetting("inputCursor",ne,!0,["cursor"]);function ne(A,j){let k=j[0];if(t.util.isInteger(k)&&(k=String.fromCharCode(k)),typeof k!="string"){let V=new TypeError("setInputCursor: cursor must be a string or integer");throw V.code="INVALID_CURSOR",V}let O=A.printCursor.font;if(O.mode==="pixel"&&O.charset){let V=!0;for(let q=0;q<O.charset.length;q++)if(O.charset.charAt(q)===k){V=!1;break}if(V){console.warn(`setInputCursor: cursor "${k}" not found in current font charset`);return}}A.printCursor.prompt=k}}function We(t){let c=t._.data;t._.addCommand("startMouse",I,!1,!0,[]);function I(n){n.mouseStarted||(n.canvas.addEventListener("mousemove",b),n.canvas.addEventListener("mousedown",L),n.canvas.addEventListener("mouseup",F),n.canvas.addEventListener("contextmenu",_),n.mouseStarted=!0)}t._.addCommand("stopMouse",C,!1,!0,[]);function C(n){n.mouseStarted&&(n.canvas.removeEventListener("mousemove",b),n.canvas.removeEventListener("mousedown",L),n.canvas.removeEventListener("mouseup",F),n.canvas.removeEventListener("contextmenu",_),n.mouseStarted=!1)}function b(n){let d=c.screens[n.target.dataset.screenId];d&&(M(d,n,"move"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("move",h(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("move",h(d),d.onPressEventListeners))}function L(n){let d=c.screens[n.target.dataset.screenId];d&&(M(d,n,"down"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("down",h(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("down",h(d),d.onPressEventListeners),d.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",h(d),d.onClickEventListeners,"down"))}function F(n){let d=c.screens[n.target.dataset.screenId];d&&(M(d,n,"up"),d.mouseEventListenersActive>0&&c.commands.triggerEventListeners("up",h(d),d.onMouseEventListeners),d.pressEventListenersActive>0&&c.commands.triggerEventListeners("up",h(d),d.onPressEventListeners),d.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",h(d),d.onClickEventListeners,"up"))}function _(n){return n.preventDefault(),!1}function M(n,d,u){let a=n.canvas.getBoundingClientRect(),g=n.width/a.width,l=n.height/a.height;n.mouse.x=Math.floor((d.clientX-a.left)*g),n.mouse.y=Math.floor((d.clientY-a.top)*l),n.mouse.offsetX=d.offsetX,n.mouse.offsetY=d.offsetY,n.mouse.button=d.button,n.mouse.buttons=d.buttons,n.mouse.eventType=u,n.lastEvent="mouse"}t._.addCommand("inmouse",S,!1,!0,[]);function S(n){return c.commands.startMouse(n),h(n)}t._.addCommand("onmouse",x,!1,!0,["mode","fn","once"]);function x(n,d){let u=d[0]||"down",a=d[1],g=!!d[2];if(c.commands.startMouse(n),!t.util.isFunction(a)){let l=new TypeError("onmouse: fn must be a function");throw l.code="INVALID_CALLBACK",l}n.onMouseEventListeners||(n.onMouseEventListeners={},n.mouseEventListenersActive=0),n.onMouseEventListeners[u]||(n.onMouseEventListeners[u]=[]),n.onMouseEventListeners[u].push({fn:a,once:g}),n.mouseEventListenersActive++}t._.addCommand("offmouse",m,!1,!0,["mode","fn"]);function m(n,d){let u=d[0]||"down",a=d[1];if(n.onMouseEventListeners&&n.onMouseEventListeners[u])if(a){let g=n.onMouseEventListeners[u].length;n.onMouseEventListeners[u]=n.onMouseEventListeners[u].filter(l=>l.fn!==a),n.mouseEventListenersActive-=g-n.onMouseEventListeners[u].length}else n.mouseEventListenersActive-=n.onMouseEventListeners[u].length,n.onMouseEventListeners[u]=[]}t._.addCommand("triggerEventListeners",y,!0,!1);function y(n,d,u,a){if(!(!u||!u[n]))for(let g=u[n].length-1;g>=0;g--){let l=u[n][g];l.fn(d,a),l.once&&u[n].splice(g,1)}}t._.addCommand("getMouse",h,!0,!0,[]);function h(n){return{x:n.mouse.x,y:n.mouse.y,lastX:n.mouse.lastX,lastY:n.mouse.lastY,buttons:n.mouse.buttons,action:n.mouse.eventType,type:"mouse"}}t._.addCommand("inpress",f,!1,!0,[]);function f(n){return c.commands.startMouse(n),c.commands.startTouch(n),n.lastEvent==="touch"?c.commands.getTouchPress(n):c.commands.getMouse(n)}t._.addCommand("onpress",o,!1,!0,["mode","fn","once","hitBox","customData"]);function o(n,d){let u=d[0],a=d[1],g=d[2],l=d[3],v=d[4];c.commands.onevent(u,a,g,l,["down","up","move"],"onpress",n.onPressEventListeners,null,null,v)&&(c.commands.startMouse(n),c.commands.startTouch(n),n.pressEventListenersActive+=1)}t._.addCommand("offpress",s,!1,!0,["mode","fn"]);function s(n,d){let u=d[0],a=d[1];c.commands.offevent(u,a,["down","up","move"],"offpress",n.onPressEventListeners)&&(a==null?n.pressEventListenersActive=0:(n.pressEventListenersActive-=1,n.pressEventListenersActive<0&&(n.pressEventListenersActive=0)))}t._.addCommand("onclick",r,!1,!0,["fn","once","hitBox","customData"]);function r(n,d){let u=d[0],a=d[1],g=d[2],l=d[3];g==null&&(g={x:0,y:0,width:c.commands.width(n),height:c.commands.height(n)}),c.commands.onevent("click",u,a,g,["click"],"onclick",n.onClickEventListeners,null,null,l)&&(c.commands.startMouse(n),c.commands.startTouch(n),n.clickEventListenersActive+=1)}t._.addCommand("offclick",i,!1,!0,["fn"]);function i(n,d){let u=d[0];c.commands.offevent("click",u,["click"],"offclick",n.onClickEventListeners)&&(u==null?n.clickEventListenersActive=0:(n.clickEventListenersActive-=1,n.clickEventListenersActive<0&&(n.clickEventListenersActive=0)))}t._.addCommand("setEnableContextMenu",e,!1,!0,["isEnabled"]),t._.addSetting("enableContextMenu",e,!0,["isEnabled"]);function e(n,d){n.isContextMenuEnabled=!!d[0],I(n)}}function Ke(t){let c=t._.data;t._.addCommand("startTouch",I,!1,!0,[]);function I(f){f.touchStarted||(f.canvas.addEventListener("touchstart",b),f.canvas.addEventListener("touchmove",L),f.canvas.addEventListener("touchend",F),f.canvas.addEventListener("touchcancel",F),f.touchStarted=!0)}t._.addCommand("stopTouch",C,!1,!0,[]);function C(f){f.touchStarted&&(f.canvas.removeEventListener("touchstart",b),f.canvas.removeEventListener("touchmove",L),f.canvas.removeEventListener("touchend",F),f.canvas.removeEventListener("touchcancel",F),f.touchStarted=!1)}function b(f){c.isTouchScreen=!0;let o=c.screens[f.target.dataset.screenId];o&&(_(o,f,"start"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("start",M(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&(c.commands.triggerEventListeners("down",y(o),o.onPressEventListeners),f.preventDefault()),o.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",y(o),o.onClickEventListeners,"down"))}function L(f){let o=c.screens[f.target.dataset.screenId];o&&(_(o,f,"move"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("move",M(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&(c.commands.triggerEventListeners("move",y(o),o.onPressEventListeners),f.preventDefault()))}function F(f){let o=c.screens[f.target.dataset.screenId];o&&(_(o,f,"end"),o.touchEventListenersActive>0&&c.commands.triggerEventListeners("end",M(o),o.onTouchEventListeners),o.pressEventListenersActive>0&&c.commands.triggerEventListeners("up",y(o),o.onPressEventListeners),o.clickEventListenersActive>0&&c.commands.triggerEventListeners("click",y(o),o.onClickEventListeners,"up"))}function _(f,o,s){let r=f.canvas.getBoundingClientRect(),i=f.width/r.width,e=f.height/r.height;f.touch.eventType=s,f.touch.count=o.touches.length,f.touch.touches=[];for(let n=0;n<o.touches.length;n++){let d=o.touches[n];f.touch.touches.push({x:Math.floor((d.clientX-r.left)*i),y:Math.floor((d.clientY-r.top)*e),identifier:d.identifier})}f.touch.touches.length>0&&(f.touch.x=f.touch.touches[0].x,f.touch.y=f.touch.touches[0].y),f.lastEvent="touch"}function M(f){return{x:f.touch.x,y:f.touch.y,count:f.touch.count,touches:f.touch.touches.slice(),eventType:f.touch.eventType}}t._.addCommand("intouch",S,!1,!0,[]);function S(f){return c.commands.startTouch(f),M(f)}t._.addCommand("ontouch",x,!1,!0,["mode","fn","once"]);function x(f,o){let s=o[0]||"start",r=o[1],i=!!o[2];if(c.commands.startTouch(f),!t.util.isFunction(r)){let e=new TypeError("ontouch: fn must be a function");throw e.code="INVALID_CALLBACK",e}f.onTouchEventListeners||(f.onTouchEventListeners={},f.touchEventListenersActive=0),f.onTouchEventListeners[s]||(f.onTouchEventListeners[s]=[]),f.onTouchEventListeners[s].push({fn:r,once:i}),f.touchEventListenersActive++}t._.addCommand("offtouch",m,!1,!0,["mode","fn"]);function m(f,o){let s=o[0]||"start",r=o[1];if(f.onTouchEventListeners&&f.onTouchEventListeners[s])if(r){let i=f.onTouchEventListeners[s].length;f.onTouchEventListeners[s]=f.onTouchEventListeners[s].filter(e=>e.fn!==r),f.touchEventListenersActive-=i-f.onTouchEventListeners[s].length}else f.touchEventListenersActive-=f.onTouchEventListeners[s].length,f.onTouchEventListeners[s]=[]}t._.addCommand("getTouchPress",y,!0,!0,[]);function y(f){function o(r,i,e){for(let n in r){let d=r[n],u={x:d.x,y:d.y,id:d.id,lastX:d.lastX,lastY:d.lastY,action:d.action,type:"touch"};e!==void 0&&(d.action=e),i.push(u)}}let s=[];if(o(f.touches,s),s.length===0&&o(f.lastTouches,s,"up"),s.length>0){let r=s[0];return r.action==="up"?r.buttons=0:r.buttons=1,r.touches=s,r}return{x:-1,y:-1,id:-1,lastX:-1,lastY:-1,action:"none",buttons:0,type:"touch"}}t._.addCommand("setPinchZoom",h,!1,!1,["isEnabled"]),t._.addSetting("pinchZoom",h,!1,["isEnabled"]);function h(f){!!f[0]?document.body.style.touchAction="":document.body.style.touchAction="none"}}function Ge(t){let c=t._.data,I={},C=[],b={},L=null,F=["connect","disconnect","axis","pressed","touched","pressReleased","touchReleased"],_=!1,M=8,S=.2,x=!1;function m(){window.addEventListener("gamepadconnected",y),window.addEventListener("gamepaddisconnected",h),x=!0}function y(a){I[a.gamepad.index]=a.gamepad,a.gamepad.controllerIndex=C.length,C.push(a.gamepad),o(a.gamepad),s("connect",a.gamepad.index)}function h(a){s("disconnect",a.gamepad.index),C.splice(I[a.gamepad.index].controllerIndex,1),delete I[a.gamepad.index]}function f(){let a=navigator.getGamepads?navigator.getGamepads():[];for(let g=0;g<a.length;g++)a[g]&&I[g]&&o(a[g])}function o(a){let g=I[a.index];g.buttons||(g.buttons=[]),g.axes||(g.axes=[]);for(let l=0;l<a.buttons.length;l++){let v=a.buttons[l],p=g.buttons[l]||{pressed:!1,touched:!1};v.pressed&&!p.pressed&&s("pressed",a.index,l),!v.pressed&&p.pressed&&s("pressReleased",a.index,l),v.touched&&!p.touched&&s("touched",a.index,l),!v.touched&&p.touched&&s("touchReleased",a.index,l),g.buttons[l]={pressed:v.pressed,touched:v.touched,value:v.value}}for(let l=0;l<a.axes.length;l++){let v=a.axes[l],p=g.axes[l]||0;Math.abs(v-p)>S&&s("axis",a.index,l,v),g.axes[l]=v}I[a.index]=g}function s(a,g,l,v){if(!b[g])return;let p=b[g][a];if(p){if(l!==void 0&&p[l])for(let w=p[l].length-1;w>=0;w--){let E=p[l][w];E.fn({gamepadIndex:g,mode:a,item:l,value:v,customData:E.customData}),E.once&&p[l].splice(w,1)}if(p["*"])for(let w=p["*"].length-1;w>=0;w--){let E=p["*"][w];E.fn({gamepadIndex:g,mode:a,item:l,value:v,customData:E.customData}),E.once&&p["*"].splice(w,1)}}}t._.addCommand("ingamepads",r,!1,!1,[]);function r(){return x||m(),I&&f(),C}t._.addCommand("ongamepad",i,!1,!1,["gamepadIndex","mode","item","fn","once","customData"]);function i(a){x||m();let g=a[0],l=a[1],v=a[2],p=a[3],w=!!a[4],E=a[5];if(!t.util.isFunction(p)){let T=new TypeError("ongamepad: fn must be a function");throw T.code="INVALID_CALLBACK",T}if(g==null){let T=new TypeError("ongamepad: gamepadIndex is required");throw T.code="MISSING_GAMEPAD_INDEX",T}b[g]||(b[g]={}),b[g][l]||(b[g][l]={});let N=v!==void 0?v:"*";b[g][l][N]||(b[g][l][N]=[]),b[g][l][N].push({fn:p,once:w,customData:E}),_||n()}t._.addCommand("offgamepad",e,!1,!1,["gamepadIndex","mode","item","fn"]);function e(a){let g=a[0],l=a[1],v=a[2],p=a[3];if(!b[g]||!b[g][l])return;let w=v!==void 0?v:"*";b[g][l][w]&&(p?b[g][l][w]=b[g][l][w].filter(E=>E.fn!==p):b[g][l][w]=[])}function n(){if(_)return;_=!0;function a(){_&&(f(),L=setTimeout(a,M))}a()}function d(){_=!1,L&&(clearTimeout(L),L=null)}t._.addCommand("setGamepadSensitivity",u,!1,!1,["sensitivity"]);function u(a){let g=a[0];if(isNaN(g)||g<0||g>1){let l=new RangeError("setGamepadSensitivity: sensitivity must be between 0 and 1");throw l.code="INVALID_SENSITIVITY",l}S=g}}function Ue(t){let c=t._.data,I=t._.wait,C=t._.resume,b={},L=0,F=null,_={},M=0;t._.addCommand("createAudioPool",S,!1,!1,["src","poolSize"]);function S(i){let e=i[0],n=i[1];if(!e){let a=new TypeError("createAudioPool: No sound source provided");throw a.code="NO_SOURCE",a}if(n==null&&(n=1),n=Math.round(n),isNaN(n)||n<1){let a=new RangeError("createAudioPool: parameter poolSize must be an integer greater than 0");throw a.code="INVALID_POOL_SIZE",a}let d={pool:[],index:0};for(let a=0;a<n;a++){let g=new Audio(e);x(d,g)}let u="audioPool_"+L;return b[u]=d,L+=1,u}function x(i,e,n){n==null&&(n=3);function d(){i.pool.push({audio:e,timeout:0,volume:1}),e.removeEventListener("canplay",d),C()}function u(){let a=["MEDIA_ERR_ABORTED - fetching process aborted by user","MEDIA_ERR_NETWORK - error occurred when downloading","MEDIA_ERR_DECODE - error occurred when decoding","MEDIA_ERR_SRC_NOT_SUPPORTED - audio/video not supported"],g=e.error.code,l=g-1;l>=0&&l<a.length?(console.warn(`createAudioPool: ${a[l]}`),n>0?setTimeout(()=>{e.removeEventListener("canplay",d),e.removeEventListener("error",u);let v=new Audio(e.src);x(i,v,n-1)},100):(console.warn(`createAudioPool: Max retries exceeded for ${e.src}`),C())):(console.warn(`createAudioPool: unknown error - ${g}`),C())}n===3&&I(),e.addEventListener("canplay",d),e.addEventListener("error",u)}t._.addCommand("deleteAudioPool",m,!1,!1,["audioId"]);function m(i){let e=i[0];if(!b[e]){console.warn(`deleteAudioPool: audio ID ${e} not found.`);return}for(let n=0;n<b[e].pool.length;n++){let d=b[e].pool[n];d.audio.pause(),d.audio.src="",clearTimeout(d.timeout)}delete b[e]}t._.addCommand("playAudioPool",y,!1,!1,["audioId","volume","startTime","duration"]);function y(i){let e=i[0],n=i[1],d=i[2],u=i[3];if(!b[e]){console.warn(`playAudioPool: audio ID ${e} not found.`);return}let a=b[e];if(n==null&&(n=1),isNaN(n)||n<0||n>1){let v=new RangeError("playAudioPool: volume needs to be a number between 0 and 1");throw v.code="INVALID_VOLUME",v}if(d==null&&(d=0),isNaN(d)||d<0){let v=new RangeError("playAudioPool: startTime needs to be a number equal to or greater than 0");throw v.code="INVALID_START_TIME",v}if(u==null&&(u=0),isNaN(u)||u<0){let v=new RangeError("playAudioPool: duration needs to be a number equal to or greater than 0");throw v.code="INVALID_DURATION",v}let g=a.pool[a.index],l=g.audio;l.volume=c.volume*n,g.volume=n,l.currentTime=d,u>0&&(clearTimeout(g.timeout),g.timeout=setTimeout(()=>{l.pause(),l.currentTime=0},u*1e3)),l.play(),a.index+=1,a.index>=a.pool.length&&(a.index=0)}t._.addCommand("stopAudioPool",h,!1,!1,["audioId"]);function h(i){let e=i[0];if(e==null){for(let n in b)for(let d=0;d<b[n].pool.length;d++)b[n].pool[d].audio.pause();return}if(!b[e]){console.warn(`stopAudioPool: audio ID ${e} not found.`);return}for(let n=0;n<b[e].pool.length;n++)b[e].pool[n].audio.pause()}t._.addCommand("sound",f,!1,!1,["frequency","duration","volume","oType","delay","attack","decay"]);function f(i){let e=Math.round(i[0]),n=i[1],d=i[2],u=i[3],a=i[4],g=i[5],l=i[6];if(isNaN(e)){let w=new TypeError("sound: frequency needs to be an integer");throw w.code="INVALID_FREQUENCY",w}if(n==null&&(n=1),isNaN(n)||n<0){let w=new RangeError("sound: duration needs to be a number equal to or greater than 0");throw w.code="INVALID_DURATION",w}if(d==null&&(d=1),isNaN(d)||d<0||d>1){let w=new RangeError("sound: volume needs to be a number between 0 and 1");throw w.code="INVALID_VOLUME",w}if(g==null&&(g=0),isNaN(g)||g<0){let w=new RangeError("sound: attack needs to be a number equal to or greater than 0");throw w.code="INVALID_ATTACK",w}if(a==null&&(a=0),isNaN(a)||a<0){let w=new RangeError("sound: delay needs to be a number equal to or greater than 0");throw w.code="INVALID_DELAY",w}if(l==null&&(l=.1),isNaN(l)){let w=new TypeError("sound: decay needs to be a number");throw w.code="INVALID_DECAY",w}u==null&&(u="triangle");let v=null;if(t.util.isArray(u)){if(u.length!==2||u[0].length===0||u[1].length===0||u[0].length!==u[1].length){let w=new TypeError("sound: oType array must be an array with two non empty arrays of equal length");throw w.code="INVALID_WAVE_TABLE",w}v=[];for(let w=0;w<u.length;w++){for(let E=0;E<u[w].length;E++)if(isNaN(u[w][E])){let N=new TypeError("sound: oType array must only contain numbers");throw N.code="INVALID_WAVE_VALUE",N}v.push(new Float32Array(u[w]))}u="custom"}else{if(typeof u!="string"){let E=new TypeError("sound: oType needs to be a string or an array");throw E.code="INVALID_TYPE",E}if(["triangle","sine","square","sawtooth"].indexOf(u)===-1){let E=new TypeError("sound: oType is not a valid type. oType must be one of the following: triangle, sine, square, sawtooth");throw E.code="INVALID_OSCILLATOR_TYPE",E}}if(!F){let w=window.AudioContext||window.webkitAudioContext;F=new w}let p=g+n+l;return c.commands.createSound("sound",F,e,d,g,n,l,p,u,v,a)}t._.addCommand("createSound",o,!0,!1,[]);function o(i,e,n,d,u,a,g,l,v,p,w){let E=e.createOscillator(),N=e.createGain(),T=e.createGain();if(T.gain.value=c.volume,E.frequency.value=n,v==="custom"){let H=p[0],U=p[1],B=e.createPeriodicWave(H,U);E.setPeriodicWave(B)}else E.type=v;u===0?N.gain.value=d:N.gain.value=0,E.connect(N),N.connect(T),T.connect(e.destination);let P=e.currentTime+w;u>0&&N.gain.setValueCurveAtTime(new Float32Array([0,d]),P,u),a>0&&N.gain.setValueCurveAtTime(new Float32Array([d,.8*d]),P+u,a),g>0&&N.gain.setValueCurveAtTime(new Float32Array([.8*d,.1*d,0]),P+u+a,g),E.start(P),E.stop(P+l);let R="sound_"+M;return M+=1,_[R]={oscillator:E,master:T,audioContext:e},setTimeout(()=>{delete _[R]},(P+l)*1e3),R}t._.addCommand("stopSound",s,!1,!1,["soundId"]);function s(i){let e=i[0];if(e==null){for(let n in _)_[n].oscillator.stop(0);return}_[e]&&_[e].oscillator.stop(0)}t._.addCommand("setVolume",r,!1,!1,["volume"]),t._.addSetting("volume",r,!1,["volume"]);function r(i){let e=i[0];if(isNaN(e)||e<0||e>1){let n=new RangeError("setVolume: volume needs to be a number between 0 and 1");throw n.code="INVALID_VOLUME",n}c.volume=e;for(let n in _)e===0?(_[n].master.gain.exponentialRampToValueAtTime(.01,_[n].audioContext.currentTime+.1),_[n].master.gain.setValueAtTime(0,_[n].audioContext.currentTime+.11)):_[n].master.gain.exponentialRampToValueAtTime(e,_[n].audioContext.currentTime+.1);for(let n in b)for(let d in b[n].pool){let u=b[n].pool[d];u.audio.volume=c.volume*u.volume}}}function He(t){let c=t._.data,I={A:[27.5,55,110,220,440,880,1760,3520,7040,14080],"A#":[29.14,58.27,116.541,233.082,466.164,932.328,1864.655,3729.31,7458.62,14917.24],B:[30.87,61.74,123.471,246.942,493.883,987.767,1975.533,3951.066,7902.132,15804.264],C:[16.35,32.7,65.41,130.813,261.626,523.251,1046.502,2093.005,4186.009,8372.018],"C#":[17.32,34.65,69.296,138.591,277.183,554.365,1108.731,2217.461,4434.922,8869.844],D:[18.35,36.71,73.416,146.832,293.665,587.33,1174.659,2349.318,4698.636,9397.272],"D#":[19.45,38.89,77.782,155.563,311.127,622.254,1244.508,2489.016,4978.032,9956.064],E:[20.6,41.2,82.407,164.814,329.628,659.255,1318.51,2637.021,5274.042,10548.084],F:[21.83,43.65,87.307,174.614,349.228,698.456,1396.913,2793.826,5587.652,11175.304],"F#":[23.12,46.25,92.499,184.997,369.994,739.989,1479.978,2959.955,5919.91,11839.82],G:[24.5,49,97.999,195.998,391.995,783.991,1567.982,3135.964,6271.928,12543.856],"G#":[25.96,51.91,103.826,207.652,415.305,830.609,1661.219,3322.438,6644.876,13289.752]},C={},b=[],L=0,F=[];t._.addCommand("play",_,!1,!1,["playString"]);function _(s){let r=s[0];if(typeof r!="string"){let d=new TypeError("play: playString needs to be a string");throw d.code="INVALID_PLAY_STRING",d}let i=M(r);if(!i)return null;F=[],S(i),F.sort((d,u)=>d.time-u.time);let e=window.AudioContext||window.webkitAudioContext,n=new e;for(let d=0;d<F.length;d++){let u=F[d];u.track.sounds.push(c.commands.createSound("play",n,u.frequency,u.volume,u.attackTime,u.sustainTime,u.decayTime,u.stopTime,u.oType,u.waveTables,u.time))}}function M(s){s=s.split(/\s+/).join("").toUpperCase();let r="track_"+L;L+=1;let i={id:r,notes:[],noteId:0,attackRate:.1,decayRate:.2,sustainRate:.65,fullNote:!1,tempo:60/120,noteLength:.25,pace:.875,octave:4,volume:1,type:"triangle",waveTables:null,sounds:[]};C[r]=i,b.push({id:r});let e=0;for(;e<s.length;){let n=s.charAt(e);if("ABCDEFG".indexOf(n)!==-1){let d=n,u=null,a=0;e++,e<s.length&&"#+- ".indexOf(s.charAt(e))!==-1&&(s.charAt(e)!==" "&&(d+=s.charAt(e)),e++);let g="";for(;e<s.length&&/\d/.test(s.charAt(e));)g+=s.charAt(e),e++;for(g&&(u=parseFloat(g));e<s.length&&s.charAt(e)===".";)a++,e++;i.notes.push({type:"note",note:d,length:u,dots:a});continue}if("PN".indexOf(n)!==-1){let d=n;e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;u&&i.notes.push({type:d==="P"?"pause":"noteNum",value:parseInt(u)});continue}if(n==="M"){if(e++,e<s.length){let d=s.charAt(e);if("LNSF".indexOf(d)!==-1){e++,d==="L"||d==="N"||d==="S"?i.notes.push({type:"musicStyle",value:d}):d==="F"&&i.notes.push({type:"fullNote"});continue}if("ATD".indexOf(d)!==-1){e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;if(u){let a=parseInt(u);if(a>=0&&a<=100){let g;d==="A"?g="attackRate":d==="T"?g="sustainRate":d==="D"&&(g="decayRate"),i.notes.push({type:g,value:a/100})}}continue}}continue}if("OLT".indexOf(n)!==-1){let d=n;e++;let u="";for(;e<s.length&&/\d/.test(s.charAt(e));)u+=s.charAt(e),e++;if(u){let a=parseFloat(u);d==="O"&&a>=0&&a<=7?i.notes.push({type:"octave",value:parseInt(a)}):d==="L"&&a>0?i.notes.push({type:"length",value:a}):d==="T"&&a>=32&&a<=255&&i.notes.push({type:"tempo",value:parseInt(a)})}continue}if(n==="V"){e++;let d="";for(;e<s.length&&/\d/.test(s.charAt(e));)d+=s.charAt(e),e++;if(d){let u=parseInt(d);u>=0&&u<=100&&i.notes.push({type:"volume",value:u/100})}continue}if(n==="<"){i.notes.push({type:"octaveDown"}),e++;continue}if(n===">"){i.notes.push({type:"octaveUp"}),e++;continue}if(e+6<=s.length&&s.substring(e,e+6)==="SQUARE"){i.notes.push({type:"waveform",value:"square"}),e+=6;continue}if(e+4<=s.length&&s.substring(e,e+4)==="SINE"){i.notes.push({type:"waveform",value:"sine"}),e+=4;continue}if(e+8<=s.length&&s.substring(e,e+8)==="TRIANGLE"){i.notes.push({type:"waveform",value:"triangle"}),e+=8;continue}if(e+8<=s.length&&s.substring(e,e+8)==="SAWTOOTH"){i.notes.push({type:"waveform",value:"sawtooth"}),e+=8;continue}if(n==="["){let d="",u=0;for(;e<s.length;){if(d+=s.charAt(e),s.charAt(e)==="[")u++;else if(s.charAt(e)==="]"&&(u--,u===0)){e++;break}e++}try{let a=JSON.parse(d);t.util.isArray(a)&&a.length===2&&i.notes.push({type:"wavetable",value:a})}catch{console.warn(`play: Invalid wavetable format: ${d}`)}continue}e++}return r}function S(s){let r=C[s];if(!r||r.noteId>=r.notes.length)return;let i=0;for(;r.noteId<r.notes.length;){let e=r.notes[r.noteId];switch(e.type){case"note":let n=x(r,e.note);if(n>0){let u=m(r,e.length,e.dots);y(r,n,i),i+=u}break;case"noteNum":if(e.value>0&&e.value<85){let u=h[e.value],a=m(r,null,0);y(r,u,i),i+=a}break;case"pause":let d=4/e.value*r.tempo;i+=d;break;case"octave":r.octave=e.value;break;case"octaveUp":r.octave<7&&r.octave++;break;case"octaveDown":r.octave>0&&r.octave--;break;case"length":r.noteLength=4/e.value;break;case"tempo":r.tempo=60/e.value;break;case"volume":r.volume=e.value;break;case"attackRate":r.attackRate=e.value;break;case"sustainRate":r.sustainRate=e.value;break;case"decayRate":r.decayRate=e.value;break;case"fullNote":r.fullNote=!0,r.pace=1;break;case"waveform":r.type=e.value;break;case"wavetable":r.waveTables=[new Float32Array(e.value[0]),new Float32Array(e.value[1])],r.type="custom";break;case"musicStyle":e.value==="L"?(r.pace=1,r.fullNote=!0):e.value==="N"?(r.pace=.875,r.fullNote=!1):e.value==="S"&&(r.pace=.75,r.fullNote=!1);break}r.noteId++}}function x(s,r){r=r.replace(/\+/g,"#"),r=r.replace("C-","B"),r=r.replace("D-","C#"),r=r.replace("E-","D#"),r=r.replace("F-","E"),r=r.replace("G-","F#"),r=r.replace("A-","G#"),r=r.replace("B-","A#");let i=I[r];if(!i)return 0;let e=s.octave;return e<0||e>=i.length?0:i[e]}function m(s,r,i){r==null?r=s.noteLength:r=4/r;let e=r*s.tempo*s.pace;if(i===1)e=e*1.5;else if(i===2)e=e*1.75;else if(i>2){let n=1,d=.5;for(let u=0;u<i;u++)n+=d,d=d/2;e=e*n}return e}function y(s,r,i){let e=s.volume,n=m(s,null,0),d=n*s.attackRate,u=n*s.sustainRate,a=n*s.decayRate,g;s.fullNote&&d+u+a>n?g=n:g=d+u+a;let l={frequency:r,volume:e,attackTime:d,sustainTime:u,decayTime:a,stopTime:g,oType:s.type,waveTables:s.waveTables,time:i,track:s};F.push(l)}let h=[0,16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87,32.7,34.65,36.71,38.89,41.2,43.65,46.25,49,51.91,55,58.27,61.74,65.406,69.296,73.416,77.782,82.407,87.307,92.499,97.999,103.826,110,116.541,123.471,130.813,138.591,146.832,155.563,164.814,174.614,184.997,195.998,207.652,220,233.082,246.942,261.626,277.183,293.665,311.127,329.628,349.228,369.994,391.995,415.305,440,466.164,493.883,523.251,554.365,587.33,622.254,659.255,698.456,739.989,783.991,830.609,880,932.328,987.767,1046.502,1108.731,1174.659,1244.508,1318.51,1396.913,1479.978,1567.982,1661.219,1760,1864.655,1975.533,2093.005,2217.461,2349.318,2489.016,2637.021,2793.826,2959.955,3135.964,3322.438,3520,3729.31,3951.066,4186.009,4434.922,4698.636,4978.032,5274.042,5587.652,5919.91,6271.928,6644.876,7040,7458.62,7902.132,8372.018,8869.844,9397.272,9956.064,10548.084,11175.304,11839.82,13289.752,14080,14917.24,15804.264];t._.addCommand("stopPlay",f,!1,!1,["trackId"]);function f(s){let r=s[0];if(r==null){for(let i=0;i<b.length;i++){let e=C[b[i].id];if(e){for(let n=0;n<e.sounds.length;n++){let d=e.sounds[n];c.commands.stopSound([d])}delete C[b[i].id]}}b=[];return}if(C[r]){let i=C[r];for(let e=0;e<i.sounds.length;e++){let n=i.sounds[e];c.commands.stopSound([n])}o(r)}}function o(s){for(let r=0;r<b.length;r++)if(b[r].id===s){b.splice(r,1);break}delete C[s]}}function Ye(t){let c=t._.data;t._.addCommand("draw",I,!1,!0,["drawString"]);function I(C,b){let L=b[0];if(typeof L!="string"){let h=new TypeError("draw: drawString must be a string");throw h.code="INVALID_DRAW_STRING",h}L=L.toUpperCase();let F=L.match(/(#[A-Z0-9]+)/g);if(F)for(let h=0;h<F.length;h++)L=L.replace("C"+F[h],"O"+h);L=L.replace(/(TA)/gi,"T"),L=L.split(/\s+/).join("");let _=/(?=C|C#|R|B|F|G|L|A|T|D|G|H|U|E|N|M|P|S)/,M=L.split(_),S=!1,x={x:C.x,y:C.y,angle:0},m=!1,y=!1;for(let h=0;h<M.length;h++){let f=M[h].split(/(\d+)/);switch(f[0]){case"C":let o=Number(f[1]);C.screenObj.setColor(o),m=!0;break;case"O":let s=F[f[1]];C.screenObj.setColor(s),m=!0;break;case"D":{let r=t.util.getInt(f[1],1),i=t.util.degreesToRadian(90)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"E":{let r=t.util.getInt(f[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(315)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"F":{let r=t.util.getInt(f[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(45)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"G":{let r=t.util.getInt(f[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(135)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"H":{let r=t.util.getInt(f[1],1);r=Math.sqrt(r*r+r*r);let i=t.util.degreesToRadian(225)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"L":{let r=t.util.getInt(f[1],1),i=t.util.degreesToRadian(180)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"R":{let r=t.util.getInt(f[1],1),i=t.util.degreesToRadian(0)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"U":{let r=t.util.getInt(f[1],1),i=t.util.degreesToRadian(270)+C.angle;C.x+=Math.round(Math.cos(i)*r),C.y+=Math.round(Math.sin(i)*r);break}case"P":case"S":{let r=t.util.getInt(f[1],0);C.screenObj.paint(C.x,C.y,r,f[0]==="S"),m=!0;break}case"A":{let r=t.util.getInt(f[1],1),i=t.util.getInt(f[3],1),e=t.util.getInt(f[5],1);y=!0,C._arcParams={radius:r,angle1:i,angle2:e};break}case"T":C.angle=t.util.degreesToRadian(t.util.getInt(f[1],1)),m=!0;break;case"M":C.x=t.util.getInt(f[1],1),C.y=t.util.getInt(f[3],1),m=!0;break;default:m=!0}if(!m)if(y&&C._arcParams){let o=C._arcParams;C.screenObj.arc(C.x,C.y,o.radius,o.angle1,o.angle2)}else C.screenObj.line(x.x,x.y,C.x,C.y);m=!1,y=!1,S&&(S=!1,C.x=x.x,C.y=x.y,C.angle=x.angle),f[0]==="N"?S=!0:x={x:C.x,y:C.y,angle:C.angle},f[0]==="B"&&(m=!0)}}}function $e(t){t.loadFont("0,14004,2602800,oidnrt,3po8cff,3vnhgs4,1uv77og,3hpuv70,73g00,3vjgoef,3o00000,0,71ji,k9o000,1sg,1ogoc3p,jp4ir8,19fvt51,31ovfn3,cevfh,31vrooc,1tv52h8,2g0kula,2d2hcsp,8r2jg0,3vvvj,f33opv,8efh0g,3ho84fj,2200idv,2c40237,3r4g000,87000i,3vv901h,3jptvvv,3vnjpsc,0,g8420,22h800,57p9,3p80ea7,237000i,889019,111cc02,0,88420g,g4211,28oc,140011o,1000000,11000,1s00000,400,3333100,sjam9o,1g8423,203i888,1s060ho,hg0654,2fgg1sg,1o2e01p,3p4e07,211hgg0,oi64hg,1h4e13,31g0c,o00100,gg444,41000v,v0010,1088803,2110080,sqb41o,1h4if4,20729oi,1o07421,1o0s94,19701sg,1sgf03p,3p0g03,384p4c0,14if4i8,1o8423,201o84i,s04ihg,2h40842,43o12r,1ul8g25,2blej03,28ka4s0,s97i10,1h4ib3,10729oi,140321g,ho0v21,21014i,14i6025,a4k404,1al9ok0,12a22i4,24k421,7g8og,1s06210,21g1gc3,30g0c2,42300g,2g00000,1v,o40000,1o2f3,10210s9,s003i1,1o0211,251g00c,14s700g,23gg800,6kjo4s,ge4i94,8021,g04,1884218,3180421,21000a,1ul8g01,3294i00,64i8o0,c5310,200ca30,2102ok8,g003j0,3jo0023,221000i,14i6g00,24k400,8lbsk0,a2118,14i70,2e01s44,u02230,20g0630,31g082,622019,1000001,74a5u0,sg83go,3i80i93,30110oi,1oe22jg,joqh07,17hlg4,1o2f39g,33g4u6j,2841o66,gkc971,34g0oie,e411h4,3gsi030,211osh6,423hg0,1g84720,230g8e9,c94jp4,1goi97i,133p0u8,u06pmr,1sjf94j,34i8c93,94hg0c,14i604l,3inbvgk,2603ooc,1tdvstn,3phsif4,2prfurv,2qc67i1,3ooe4n,42rp8k,gs473h,jh8ua3,561igo,ggc231,30gg842,e110oi,14c2229,i8o887,94i9si,1km94jh,301s003,2703o00,40108,3g000f4,u,40g951,108d0kc,630gg0,g84000,2a8i000,92a800,1404g28,2mkll5,1lbfvdv,2rv210g,10g8421,u10g9s,84u118,2hbka50,7oka,1s217g,11bka5e,252h8ka,ka0fg8,n8kat0,21fg0ka,lu000j,30g9s00,7g84,8421o0,g84vg,1v,84210g,1og8000,vg0084,9v210g,1og8722,252hcka,kb421s,u842,352nc00,3u00fo0,7cka5i,42p81v,vg1b,2o01r51,vg03u0,ka5fo0,3u00f,320001v,ka52h8,3o0043h,21o007,843h00,ua52,252nska,9v217s,10g84u0,7,84vvvv,3vvu000,vvvtgo,1goc60o,1goc63f,3vvo000,2e53g,hp5upf,287i90g,10g003s,2h81uh4,44no00,1ska200,18s880,etgg84,1sc94hh,3hh4u94,267k631,15jfk3p,2i9s0fb,1f0004u,2iuo01p,221so70,64i94i,3u0vg7s,gs40,e01088,1o0020g,23g0452,421042,425110,3g0800,5500kk,oi6000,400,c,1gg,12go062,252g1o2,88f000,1ose00",6,6,null,!0),t.loadFont("0,ugs,3gvtm2u,1tvmss7,vtskvf,2v710g0,g8efjg,21008e2,vfl8gs,g8e77p,311o003,f7hg00,3vvpoc7,vvu045,h8igg0,3v1mrdm,3efu71h,1ep4i8o,oi94hg,33oof4j,34233hg,u97i95,cq08mn,2pspiqc,21gsfn3,400233,2v3go40,gsv213,3jggka5,a50180,1val6h8,2h80e9j,94hj4s,3p,3jo08ef,24fjghv,gsvah0,2100842,lfjgg0,82fgg,2000044,v41000,8421,3g00098,1voa800,8477r,3g000vf,2e21000,0,8e7,4200g0,18ka000,kaf,2afih80,gug70b,33000p9,442ac0,gk4aki,1380844,0,ggg841,100g41,211100,k4fh1,1000021,fh0g00,0,2110000,f00000,0,210000g,2222200,1p2jamb,jg08ca,4213s0,1p21332,no0sh0,260k9o0,8ca97o,11o1ug8,u0k9o0,oggf4a,jg1uh1,442100,1p2h74a,jg0sh8,2f0g9o0,84000,2100042,10gg,888820,20g000f,2007o00,10820gg,2200sh0,22200g0,1p2nalq,3g08a8,2hfka40,3oi9729,ng0c98,g828o0,3oi94i9,ng1u94,e42bs0,3si8721,700c98,g9i8s0,252hfka,k80s42,4211o0,s4214i,1301ia5,c52j60,3gg8421,no12ra,2l8ka40,25il9ka,k80sh8,2h8k9o0,3oi9721,700sh8,2h8l9o3,3oi9731,1680sh8,e0k9o0,3ta4210,23g12h8,2h8k9o0,252h8k9,11012h8,2lal980,24ka22h,14812h5,4211o0,3t22222,no1og8,g843g0,210820g,g41o42,4213g0,gkh8g0,0,1v,g82000,7,17k9u0,30g8539,lg0007,h849o0,c216kq,1jc0007,hfk1o0,oi8e21,700006,2h8jo5s,30ga6i9,m80806,4211o0,4030ga,k9pg84,2a62h40,1g84210,23g000d,lalak0,mcka,k80007,h8k9o0,u4i9,323g006,2i93g8e,r6i1,700007,2g70bo0,10gu421,hg0008,2h8kpk0,h8k9,1100008,2lal980,h511,1480008,2h8jo5s,v111,7o0642,o210c0,g84010,2101g42,321300,15c0000,45,h8kbs0,1p2g8jg,309o0i0,i94hs0,o0e8nq,3g0sh6,274hs0,240c13i,13o0o06,274hs0,g0c13i,13o0007,g83gcc,1p2e8nq,3g1207,hfk1o0,1g0e8nq,3g1406,4211o0,1p2c210,23g0o06,4211o0,248a8nq,k80840,e8nq40,c0v43h,7o000c,267khk0,skifki,14o08a0,e8k9o0,12074a,jg0g40,e8k9o0,gk08ka,jg0g40,h8k9o0,1208k9,3g9p245,h8igg0,240h8ka,jg0847,2g83og8,oi8e22,ng12af,24fh0g0,3ome4it,if4c52,e212go,o0c13i,13o0c06,4211o0,88074a,jg0022,h8k9o0,1lc0f4a,k80qj0,pakq40,1p4i7g3,3g00oi9,c07g00,g04442,jg0000,v84000,fg8,g00iq6,r5cecv,15kbdiq,3s84080,842100,aaa2g,2g000k5,555000,1348p26,1268ll5,1l5d9ba,3ctreup,3erm842,4210g8,g84270,210g84e,4e10g8,ka52n8,2h8k000,fh8ka,s270,210ga5e,21eh8ka,ka52h8,2h8k00f,21eh8ka,kat0no,a52,25fg000,g8s270,0,e10g8,g8421s,842,4fo000,7s,210g842,43p0g8,7s,842,4fp0g8,g87i1s,210ga52,252p8ka,ka5i1s,3,342p8ka,katg7s,f,30ep8ka,ka5i1c,2h8k00f,30fo000,katg7c,2h8k84f,30fo000,ka52ns,f,30fp0g8,7s,2h8ka52,253o000,g87i1s,3,343p0g8,1s,2h8ka52,25fp8ka,g8vi7s,210g842,4e0000,1s,210hvvv,3vvvvvv,7v,3vvvose,se73ho,e73hos,1osfvvv,3vg0000,cqki,2i400e8,2u8ni10,1uh842,4000fq,252h8k0,3t28322,no0007,2ka5100,i94jl,2200cp,2210g80,3s8e8k9,313sc98,1voa8o0,oigoa9,mc0e83,f8c5s0,impdd,g00117,2iqbp10,oggf41,1g0sh8,2h8ka40,v07o1,3o0084f,24203s0,g41110,7o0888,8203s0,c94i10,210g842,4252go,oc0fo0,31g00cp,206co00,oi9300,0,630000,1g,721,216h8c,3h4i94g,oi2,8f0000,e73h,3000000",6,8,null,!0),t.loadFont("0,0,1v839c1,2upj0bu,1vfvmvv,31ufvru,1mftvnu,1u3g400,83gv7u,1u3g400,s7oe7u,3v7oe3s,810e3s,3v7oe3s,61s,u1g000,3vvvpu3,31ufvvv,3opi2,116cf00,3vs76dt,2upjgvv,7ge3rt,36cpj3o,u6cpj6,u1gvgo,vj6fpg,o71s70,1vm6vr3,1hmfpm0,2clkf77,3jjomkp,20e1u7u,3se1000,10sfnu,v0s0g0,c3ovgo,c7sf0o,1j6cpj6,1j00pg0,1vtnmrr,dhm6o0,v66e3c,1m3hj3o,0,1v7svg0,c3ovgo,1v3o67v,c3ovgo,c1g600,c1g60o,1v3o600,1g37u,61g000,30o7u,1g30000,1g60,30fs000,28pnv,1j28000,1gf3u,3vvu000,fvvru,u1g000,0,0,o7gu1g,o00c00,1m6or00,0,1m6pvjc,3v6or00,o7pg3o,6fgc00,cdj0o,o6dhg0,s6oe3m,3ecotg0,1g61g00,0,c30o30,1g30600,1g3060o,c30o00,6cf7v,u6c000,30c7s,o30000,0,30c30,7s,0,0,30c00,30o61g,1gc1000,1ucdjmu,3recv00,o70c1g,o31v00,1sco31o,1gcpv00,1sco31o,6cou00,e3or6c,3v0o7g0,3uc1u0c,6cou00,s61g7o,36cou00,3uco30o,o30c00,1scpj3o,36cou00,1scpj3s,61gs00,30c00,30c00,30c00,30c30,c30o60,1g30600,1v00,fo000,1g3060c,c30o00,1sco30o,o00c00,1ucdnmu,3fc0u00,o7hj6c,3ucpj00,3u6cpjs,1j6dv00,u6dg60,306cf00,3s6opj6,1j6pu00,3v64q3o,1k65vg0,3v64q3o,1k61s00,u6dg60,376cfg0,36cpj7s,36cpj00,1s30c1g,o30u00,f0o30c,36cou00,3j6cr3o,1m6dpg0,3o60o30,1h6dvg0,33etvnu,3bcdhg0,33edtmu,37cdhg0,s6phm6,336oe00,3u6cpjs,1g61s00,1scpj6c,3e7g700,3u6cpjs,1m6dpg0,1scpo3g,ecou00,3ub8c1g,o30u00,36cpj6c,36cpv00,36cpj6c,367gc00,33cdhmm,3vethg0,33ccr1o,s6phg0,36cpj3o,o30u00,3vcd30o,p6dvg0,1s60o30,1g60u00,3060c0o,60c0g0,1s1g60o,c1gu00,83gr66,0,0,7v,o30600,0,u0c,1ucotg0,3g60o3s,1j6dn00,u6c,30cou00,e0o33s,36cotg0,u6c,3uc0u00,s6oo7g,1g61s00,tmc,367o37o,3g60r3m,1j6dpg0,o00s1g,o30u00,60030c,6cpj3o,3g60pjc,1s6ppg0,1o30c1g,o30u00,1j7u,3vddhg0,1u6c,36cpj00,u6c,36cou00,1n36,1j7oo7g,tmc,367o30u,1n3m,1j61s00,v60,1s0pu00,830v1g,o38600,1j6c,36cotg0,1j6c,367gc00,1hmm,3vfsr00,1hjc,s6phg0,1j6c,367o37o,1v4o,o69v00,e30c70,o30700,c1g600,c1g600,3g30c0s,o31o00,1rdo000,0,10e3c,33cdvg0,1scpg6c,1s1g33o,co06c,36covg0,e00u6c,3uc0u00,1vc6f06,v6cfo0,3600u0c,1ucovg0,3g00u0c,1ucovg0,o30u0c,1ucovg0,u60,307g31o,1vc6f36,1v60f00,3600u6c,3uc0u00,3g00u6c,3uc0u00,3600s1g,o30u00,1ucce0o,c1gf00,3g00s1g,o30u00,333gr66,3vcdhg0,o3003o,36fpj00,e01v30,1s61v00,voc,1vsovo0,v6pj7u,36cpjg0,1sco03o,36cou00,co03o,36cou00,e003o,36cou00,1sco06c,36covg0,e006c,36covg0,co06c,367o37o,31hgf36,1j3o600,3601j6c,36cou00,c1gvm0,307s60o,s6op7g,1gedv00,36cou7s,ofoc1g,3scpj7q,33cvhm7,71m61s,c1hm3g,e00u0c,1ucovg0,s00s1g,o30u00,1o03o,36cou00,1o06c,36covg0,fg07o,36cpj00,3u01j7c,3udpj00,u6or1u,7s000,s6or1o,7o000,o00c30,30cou00,7s,30c0000,7s,60o000,31sdj6u,pmdj0f,31sdj6r,rmvjo3,c1g00o,c1g600,36pmc,1j36000,cophj,1jco000,h8g8k8,h8g8k8,1aqklda,1aqklda,3dnfmve,3dnfmve,c1g60o,c1g60o,c1g60o,3s1g60o,c1hu0o,3s1g60o,r3cdhm,3r3cdhm,0,3v3cdhm,1u0o,3s1g60o,r3dtg6,3r3cdhm,r3cdhm,r3cdhm,1vg6,3r3cdhm,r3dtg6,3v00000,r3cdhm,3v00000,c1hu0o,3s00000,0,3s1g60o,c1g60o,fg0000,c1g60o,3vg0000,0,3vhg60o,c1g60o,fhg60o,0,3vg0000,c1g60o,3vhg60o,c1g7oo,fhg60o,r3cdhm,rjcdhm,r3cdpg,vg0000,fpg,rjcdhm,r3dto0,3vg0000,1vo0,3rjcdhm,r3cdpg,rjcdhm,1vo0,3vg0000,r3dto0,3rjcdhm,c1hvo0,3vg0000,r3cdhm,3vg0000,1vo0,3vhg60o,0,3vjcdhm,r3cdhm,vg0000,c1g7oo,fg0000,7oo,fhg60o,0,vjcdhm,r3cdhm,3vjcdhm,c1hvoo,3vhg60o,c1g60o,3s00000,0,fhg60o,3vvvvvv,3vvvvvv,0,3vvvvvv,3of1s7g,3of1s7g,7gu3of,7gu3of,3vvvvvv,0,tms,34dotg0,7hj7o,36fhg60,fpj60,30c1g00,fsr3c,1m6or00,3ucoo1g,1gcpv00,vmo,3cdgs00,6cpj6,1j7oo60,7dn0o,c1g600,3u30u6c,367gc7s,s6phnu,336oe00,s6phm6,1m6prg0,e3063s,36cou00,vmr,3dns000,30ovmr,3dnso60,s61g7o,3060e00,1scpj6c,36cpj00,fo07s,fo000,o31v1g,o01v00,1g3061g,1g01v00,c30o1g,c01v00,71m6oo,c1g60o,c1g60o,cdhm3g,o3007s,30c00,7dn00,1rdo000,s6or1o,0,o,c00000,0,c00000,7go30c,3m6of0s,1s6or3c,1m00000,1o1gc30,1s00000,f1s,u3o000",6,8,null,!0),t.loadFont("0,0,0,0,1v839c1,20rr6c1,1v00000,vnv,3dvvvu3,3jvuvg0,0,6pvnu,3vfsv1o,800000,g,s7pvjs,s10000,0,c3of77,3jue60o,u00000,61s,1vfvvru,c1gf00,0,o,u3o600,0,3vvvvvv,3vufgu3,3jvvvvv,3vvu000,f36,1144phs,0,3vvvvvv,31pjfdt,2cs7vvv,3vvu000,f0s6hi,1scpj6c,1s00000,f36,1j6cf0o,1v1g600,0,vj6fpg,o30s7g,3g00000,vr3,1vm6or3,1jufpm0,0,c1hmps,3jjpmoo,c00000,1060,3gfhvno,3gc1000,0,10c3hu,3v3s3g6,100000,61s,1v1g60o,1v3o600,0,1j6cpj6,1j6c036,1j00000,vur,3dtmuor,dhm6o0,3s,3360e3c,33ccr1o,6ccv00,0,0,3vftvg0,0,c3ovgo,c1gvhs,c7s000,61s,1v1g60o,c1g600,0,c1g60o,c1gvhs,c00000,0,c0pvgc,c00000,0,c30,3v60c00,0,0,c1g60,3v00000,0,a3c,3v6oa00,0,g,s3gv3s,3vfs000,0,ftvjs,1u3ge0g,0,0,0,0,0,c3of1s,c1g00o,c00000,6cpj6,i00000,0,0,1m6pvjc,1m6pvjc,1m00000,c1gv66,31c0v06,23ccv0o,c00000,1gm6,61gc36,3300000,e3c,1m3gtms,36cotg0,1g,o30o00,0,0,30o,o30c1g,o1g300,0,o1g30c,60o30o,o00000,0,1j3pvps,1j00000,0,60o,1v1g600,0,0,0,c1g61g,0,0,3v00000,0,0,0,1g600,0,10c30o,o61g40,0,v66,37dttn6,33ccv00,0,c3gu0o,c1g60o,1v00000,v66,30o61g,1gcdvg0,0,1ucc1g6,u0c1m6,1u00000,30s,u6pj7u,60o7g0,0,3vc1g60,3u0c1m6,1u00000,e30,30c1v66,33ccv00,0,3vcc1gc,c30c1g,o00000,v66,33ccv66,33ccv00,0,1ucdhm6,1v0c1gc,1s00000,o,c00000,c1g000,0,1g600,60o,o00000,1gc,c30o1g,c0o1g0,0,3u,vg0,0,o1g,c0o1gc,c30o00,0,1ucdhgc,c1g00o,c00000,v66,33dtnmu,3ec0v00,0,83gr66,33fthm6,3300000,1v36,1j6cv36,1j6dv00,0,u6dgm0,30c1gj6,u00000,1u3c,1j6cpj6,1j6pu00,0,3v6coj8,1s6goj6,3v00000,1vj6,1h6gu38,1g61s00,0,u6dgm0,30dthj6,t00000,1hm6,33cdvm6,33cdhg0,0,u1g60o,c1g60o,u00000,7gc,60o30c,36cou00,0,3j6cr3c,1s6or36,3j00000,1s30,1g60o30,1h6dvg0,0,33etvnu,3bcdhm6,3300000,1hn6,3rftnme,33cdhg0,0,s6phm6,33cdhjc,s00000,1v36,1j6cv30,1g61s00,0,1ucdhm6,33ddnjs,60s000,1v36,1j6cv3c,1j6dpg0,0,1ucdhj0,s0phm6,1u00000,vju,1d1g60o,c1gf00,0,33cdhm6,33cdhm6,1u00000,1hm6,33cdhm6,1m3g400,0,33cdhm6,3bddvjs,1m00000,1hm6,1m3ge1o,1mcdhg0,0,1j6cpj6,u1g60o,u00000,1vm6,261gc30,31cdvg0,0,u30c1g,o30c1g,u00000,1060,3g70e0s,70c0g0,0,u0o30c,60o30c,u00000,83gr66,0,0,0,0,0,1vo0,o30600,0,0,0,3o,67pj6c,1r00000,1o30,1g7gr36,1j6cv00,0,3s,33c1g66,1u00000,70c,63or6c,36cotg0,0,3s,33ftg66,1u00000,e3c,1i61s30,1g61s00,0,3m,36cpj3s,6cou00,1o30,1g6otj6,1j6dpg0,0,c1g01o,c1g60o,u00000,1g6,s1g6,30cpj6,u00000,3g60o36,1m7gr36,3j00000,e0o,c1g60o,c1gf00,0,7c,3vddlmm,3300000,0,dopj6,1j6cpg0,0,3s,33cdhm6,1u00000,0,dopj6,1j7oo30,3o00000,3m,36cpj3s,60o7g0,0,dotj6,1g61s00,0,3s,3370766,1u00000,41g,ofoc1g,o3c700,0,6c,36cpj6c,1r00000,0,6cpj6,1j3o600,0,66,33ddlnu,1m00000,0,ccr1o,s6phg0,0,66,33cdhju,30pu00,0,ftj0o,o6dvg0,0,71g60o,1o1g60o,700000,60o,c1g00o,c1g600,0,1o1g60o,71g60o,1o00000,tms,0,0,0,41o,1mcdhnu,0,f36,31c1g62,1j3o306,1u00000,36co06c,36cpj6c,1r00000,o61g,7phnu,30ccv00,g,s6o03o,67pj6c,1r00000,1j6c,7g33s,36cotg0,30,o1g03o,67pj6c,1r00000,3gr1o,7g33s,36cotg0,0,f36,1g6cf0c,33o000,10e3c,7phnu,30ccv00,0,36co03s,33ftg66,1u00000,60c0o,7phnu,30ccv00,0,1j6c01o,c1g60o,u00000,1gf36,3g60o,c1gf00,30,o1g01o,c1g60o,u00000,cdhgg,s6phm6,3vcdhg0,e3c,s00e3c,33cdvm6,3300000,c30o00,3v6co3s,1g6dvg0,0,1j3m,r7tm6o,1n00000,fjc,36cpvmc,36cpjg0,g,s6o03s,33cdhm6,1u00000,1hm6,7phm6,33ccv00,30,o1g03s,33cdhm6,1u00000,30u6c,cpj6c,36cotg0,30,o1g06c,36cpj6c,1r00000,1hm6,cdhm6,337s1gc,1s00066,333gr66,33cdhjc,s00000,cdhg0,33cdhm6,33ccv00,o,c3opj0,1g6cf0o,c00000,3gr34,1gf0o30,1gedv00,0,1j6cf0o,1v1gvgo,c00000,fhj6c,3sc9j6u,36cphg0,e,dhg60o,1v1g60o,cdgs00,1gc30,7g33s,36cotg0,c,c3001o,c1g60o,u00000,1gc30,7phm6,33ccv00,o,o6006c,36cpj6c,1r00000,tms,dopj6,1j6cpg0,tms,cdpnm,3vdtjm6,3300000,3or3c,v00vg0,0,1o,1m6oe00,1u00000,0,c1g,30c30,33ccv00,0,0,3vc1g60,0,0,1vg6,30c000,60,30cdj6o,o61n46,61gfg0,c1g66,36dgc36,379sfg6,300000,c1g00o,c3of1s,c00000,0,r6pm3c,r00000,0,1m3c,r6pm00,0,8k84a4,8k84a4,8k84a4,8k8lda,1aqklda,1aqklda,1aqklda,3enfnbn,3enfnbn,3enfnbn,3ene60o,c1g60o,c1g60o,c1g60o,c1g60o,c1g67o,c1g60o,c1g60o,c1g67o,cfg60o,c1g60o,r3cdhm,r3cdnm,r3cdhm,r3c000,0,fsdhm,r3cdhm,0,fg67o,c1g60o,c1gdhm,r3cdnm,3fcdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3c000,7u,3fcdhm,r3cdhm,r3cdhm,rfc1nu,0,dhm,r3cdhm,rfs000,0,c1g60o,cfg67o,0,0,0,fg60o,c1g60o,c1g60o,c1g60v,0,60o,c1g60o,cfu000,0,0,7v,c1g60o,c1g60o,c1g60o,c1u60o,c1g60o,0,7v,0,60o,c1g60o,cfu60o,c1g60o,c1g60o,c1u60v,c1g60o,c1gdhm,r3cdhm,r3edhm,r3cdhm,r3cdhm,r3ec1v,0,0,1v,o3edhm,r3cdhm,r3cdhm,rfe07v,0,0,7v,fedhm,r3cdhm,r3cdhm,r3ec1n,r3cdhm,r3c000,7v,fu000,0,r3cdhm,rfe07n,r3cdhm,r3c60o,c1g67v,fu000,0,r3cdhm,r3cdnv,0,0,7v,fu60o,c1g60o,0,7v,r3cdhm,r3cdhm,r3cdhm,r3u000,0,c1g60o,c1u60v,0,0,v,c1u60o,c1g60o,0,1v,r3cdhm,r3cdhm,r3cdhm,rfudhm,r3cdhm,c1g60o,cfu67v,c1g60o,c1g60o,c1g60o,cfg000,0,0,v,c1g60o,c1hvvv,3vvvvvv,3vvvvvv,3vvvvvv,0,7v,3vvvvvv,3vvvs7g,3of1s7g,3of1s7g,3of1s7g,7gu3of,7gu3of,7gu3of,7gvvvv,3vvvvvv,3vg0000,0,0,7dn6o,3cdotg0,0,v66,3ucdhns,30c0g00,1vm6,33c1g60,30c1g00,0,1vjc,1m6or3c,1m00000,1vm6,1g3061g,1gcdvg0,0,3u,3cdhm6o,1o00000,0,1j6cpj6,1u60o60,0,tms,c1g60o,c00000,vgo,u6cpj6,u1gvg0,0,s6phm6,3vcdhjc,s00000,e3c,33cdhjc,1m6prg0,0,f3060c,v6cpj6,u00000,0,7tmur,1v00000,0,1gcvmr,3dv6vj0,3000000,71g,1g60v30,1g30700,0,7phm6,33cdhm6,3300000,7u,1vg0,fs000,0,1g63u,c1g000,3vg0000,c0o,60c30o,o00vg0,0,61gc30,o1g300,1v00000,3gr,dhg60o,c1g60o,c1g60o,c1g60o,c1hm6o,1o00000,o,c00vg0,c1g000,0,tms,7dn00,0,3gr3c,s00000,0,0,0,c1g000,0,0,o,0,f,60o30c,6eor1s,e00000,dgr3c,1m6or00,0,3g,3c30o68,3s00000,0,0,1u7ov3s,1u7o000,0",8,14,null,!0),t.loadFont("0,0,0,0,vk1,2io30dt,2co30bu,0,vnv,3dvvvu3,3jvvvru,0,0,1mftvnu,3v7oe0g,0,0,83gv7u,1u3g400,0,o,u3ppv7,3jhg61s,0,o,u7tvvv,1v1g61s,0,0,0,0,0,3vvvvvv,3vvvpu3,31ufvvv,3vvvvvv,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,vr3,1vm6or3,1hmfpv6,3000000,o,cdmf77,udm60o,0,81g70,3ofhvno,3oe1g40,0,41ge,f3tvhu,f0s1g2,0,61s,1v1g60o,1v3o600,0,pj6,1j6cpj6,1j00pj6,0,vur,3dtmuor,dhm6or,0,7phj0,s6phm6,1m3g366,1u00000,0,0,3vftvnu,0,61s,1v1g60o,1v3o63u,0,61s,1v1g60o,c1g60o,0,60o,c1g60o,c7sf0o,0,0,1g37u,61g000,0,0,30o7u,1g30000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61s,u3o60o,c0060o,0,6cpj6,i00000,0,0,3c,1mfsr3c,1mfsr3c,0,c1gv66,31c0v06,38dhjs,c1g000,0,31cc30o,o61hk6,0,e3c,1m3gtms,36cpj3m,0,30c1g,1g00000,0,0,30o,o30c1g,o3060c,0,c0o,60o30c,60o61g,0,0,6cf7v,u6c000,0,0,1g63u,c1g000,0,0,0,1g60o,o00000,0,7u,0,0,0,0,60o,0,0,10c30o,o61g40,0,f36,31s7mur,31s6phs,0,61o,1s1g60o,c1g63u,0,v66,30o61g,1gc1hnu,0,v66,30cf06,30dhjs,0,30s,u6pj7u,60o30u,0,1vm0,30c1v06,30dhjs,0,e30,30c1v66,33cdhjs,0,1vm6,30c30o,o30c1g,0,v66,33ccv66,33cdhjs,0,v66,33ccvg6,30c33o,0,0,c1g000,1g600,0,0,c1g000,1g61g,0,6,61gc30,o1g306,0,0,7s000,1v00000,0,30,o1g306,61gc30,0,v66,330o60o,c0060o,0,3s,33cdnmu,3fdpg3s,0,41o,1mcdhnu,33cdhm6,0,1v36,1j6cv36,1j6cpns,0,f36,31c1g60,30c4phs,0,1u3c,1j6cpj6,1j6cr7o,0,1vj6,1h6gu38,1g64pnu,0,1vj6,1h6gu38,1g60o7g,0,f36,31c1g6u,33ccphq,0,1hm6,33cdvm6,33cdhm6,0,f0o,c1g60o,c1g61s,0,7gc,60o30c,36cpj3o,0,1pj6,1j6ou3o,1m6cpn6,0,1s30,1g60o30,1g64pnu,0,1gv7,3vvvmu3,31s7gu3,0,1hn6,3rftnme,33cdhm6,0,v66,33cdhm6,33cdhjs,0,1v36,1j6cv30,1g60o7g,0,v66,33cdhm6,33ddnjs,60s000,1v36,1j6cv3c,1j6cpn6,0,v66,3360e0c,3cdhjs,0,1vur,2chg60o,c1g61s,0,1hm6,33cdhm6,33cdhjs,0,1gu3,31s7gu3,31mcf0o,0,1gu3,31s7gur,3dvupj6,0,1gu3,1j3o60o,u6dgu3,0,1gu3,31mcf0o,c1g61s,0,1vu3,230o61g,1gc3gvv,0,f1g,o30c1g,o30c1s,0,40,30e0s1o,e0s1g2,0,f0c,60o30c,60o31s,0,83gr66,0,0,0,0,0,0,fu000,o30600,0,0,0,0,7g33s,36cpj3m,0,1o30,1g7gr36,1j6cpjs,0,0,7phm0,30c1hjs,0,70c,63or6c,36cpj3m,0,0,7phnu,30c1hjs,0,e3c,1i61s30,1g60o7g,0,0,7dj6c,36cpj3s,6cou00,1o30,1g6otj6,1j6cpn6,0,60o,3g60o,c1g61s,0,1g6,s1g6,30c1g6,1j6cf00,1o30,1g6cr3o,1s6opn6,0,e0o,c1g60o,c1g61s,0,0,edvur,3dtnmur,0,0,dopj6,1j6cpj6,0,0,7phm6,33cdhjs,0,0,dopj6,1j6cpjs,1g61s00,0,7dj6c,36cpj3s,60o7g0,0,dotj6,1g60o7g,0,0,7phj0,s0phjs,0,41g,ofoc1g,o30dgs,0,0,cpj6c,36cpj3m,0,0,c7gu3,31mcf0o,0,0,c7gu3,3dtnvr6,0,0,c6phs,c3opm3,0,0,cdhm6,33cdhju,30pu00,0,ftj0o,o61hnu,0,3go,c1gs0o,c1g60e,0,60o,c1g00o,c1g60o,0,s0o,c1g3go,c1g63g,0,tms,0,0,0,0,83gr66,33cdvg0,0,f36,31c1g60,316cf0c,37o000,1j00,cpj6c,36cpj3m,0,o61g,7phnu,30c1hjs,0,10e3c,7g33s,36cpj3m,0,1j00,7g33s,36cpj3m,0,60c0o,7g33s,36cpj3m,0,3gr1o,7g33s,36cpj3m,0,0,u6co30,1j3o306,u00000,10e3c,7phnu,30c1hjs,0,1hg0,7phnu,30c1hjs,0,60c0o,7phnu,30c1hjs,0,pg0,3g60o,c1g61s,0,1gf36,3g60o,c1g61s,0,60c0o,3g60o,c1g61s,0,cc00g,s6phm6,3vcdhm6,0,s6oe00,s6phm6,3vcdhm6,0,c30o00,3v6co3s,1g60pnu,0,0,6seor,1vdhn3n,0,fjc,36cpvmc,36cpj6e,0,10e3c,7phm6,33cdhjs,0,1hg0,7phm6,33cdhjs,0,60c0o,7phm6,33cdhjs,0,30u6c,cpj6c,36cpj3m,0,60c0o,cpj6c,36cpj3m,0,1hg0,cdhm6,33cdhju,30ou00,cc03s,33cdhm6,33cdhjs,0,cc066,33cdhm6,33cdhjs,0,1g63u,31s1g60,31ns60o,0,3gr34,1gf0o30,1g61pns,0,1gr6,u1hvoo,3vhg60o,0,fopj6,1u64pjf,1j6cpnj,0,s6oo,c1gvgo,c1g60o,3c70000,1gc30,7g33s,36cpj3m,0,o61g,3g60o,c1g61s,0,1gc30,7phm6,33cdhjs,0,1gc30,cpj6c,36cpj3m,0,tms,dopj6,1j6cpj6,0,1rdo066,3jfdvmu,37cdhm6,0,3or3c,v00vg0,0,0,3gr3c,s00v00,0,0,c1g,30c30,30cdhjs,0,0,1vm0,30c1g00,0,0,1vg6,30c1g0,0,c1g62,33co61g,1gct6o6,61u000,c1g62,33co61g,1jct5hu,30c000,60o,1g60o,u3of0o,0,0,3cr6o,1m3c000,0,0,dgr1m,1mdg000,0,8k84a4,8k84a4,8k84a4,8k84a4,1aqklda,1aqklda,1aqklda,1aqklda,3enfnbn,3enfnbn,3enfnbn,3enfnbn,c1g60o,c1g60o,c1g60o,c1g60o,c1g60o,c1g67o,c1g60o,c1g60o,c1g60o,cfg67o,c1g60o,c1g60o,r3cdhm,r3cdnm,r3cdhm,r3cdhm,0,7u,r3cdhm,r3cdhm,0,fg67o,c1g60o,c1g60o,r3cdhm,rfc1nm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,r3cdhm,0,fs1nm,r3cdhm,r3cdhm,r3cdhm,rfc1nu,0,0,r3cdhm,r3cdnu,0,0,c1g60o,cfg67o,0,0,0,7o,c1g60o,c1g60o,c1g60o,c1g60v,0,0,c1g60o,c1g67v,0,0,0,7v,c1g60o,c1g60o,c1g60o,c1g60v,c1g60o,c1g60o,0,7v,0,0,c1g60o,c1g67v,c1g60o,c1g60o,c1g60o,c1u60v,c1g60o,c1g60o,r3cdhm,r3cdhn,r3cdhm,r3cdhm,r3cdhm,r3ec1v,0,0,0,3uc1n,r3cdhm,r3cdhm,r3cdhm,rfe07v,0,0,0,fu07n,r3cdhm,r3cdhm,r3cdhm,r3ec1n,r3cdhm,r3cdhm,0,fu07v,0,0,r3cdhm,rfe07n,r3cdhm,r3cdhm,c1g60o,cfu07v,0,0,r3cdhm,r3cdnv,0,0,0,fu07v,c1g60o,c1g60o,0,7v,r3cdhm,r3cdhm,r3cdhm,r3cdhv,0,0,c1g60o,c1u60v,0,0,0,1u60v,c1g60o,c1g60o,0,1v,r3cdhm,r3cdhm,r3cdhm,r3cdnv,r3cdhm,r3cdhm,c1g60o,cfu67v,c1g60o,c1g60o,c1g60o,c1g67o,0,0,0,v,c1g60o,c1g60o,3vvvvvv,3vvvvvv,3vvvvvv,3vvvvvv,0,7v,3vvvvvv,3vvvvvv,3of1s7g,3of1s7g,3of1s7g,3of1s7g,7gu3of,7gu3of,7gu3of,7gu3of,3vvvvvv,3vvvvo0,0,0,0,7dn6o,3cdhn3m,0,u6c,36cpm6c,33cdhmc,0,1vm6,33c1g60,30c1g60,0,0,3v6or3c,1m6or3c,0,7u,3360c0o,o61hnu,0,0,7tm6o,3cdhm3g,0,0,1j6cpj6,1j7oo30,3000000,0,1rdo60o,c1g60o,0,3u,c3opj6,1j3o63u,0,1o,1mcdhnu,33ccr1o,0,e3c,33cdhjc,1m6or7e,0,7hg,c0ofj6,1j6cphs,0,0,7tmur,3dns000,0,3,37tmur,3pnso60,0,71g,1g60v30,1g60c0s,0,3s,33cdhm6,33cdhm6,0,0,3v0007u,1vg0,0,0,c1gvgo,c0007v,0,1g,c0o1gc,c3003u,0,c,c30o1g,c0o03u,0,3gr,dhg60o,c1g60o,c1g60o,c1g60o,c1g60o,3cdhm3g,0,0,c1g03u,1g600,0,0,7dn00,1rdo000,0,3gr3c,s00000,0,0,0,o,c00000,0,0,0,c00000,0,u30c,60o37c,1m6of0s,0,dgr3c,1m6or00,0,0,71m1g,1gchu00,0,0,0,1u7ov3s,1u7ov00,0",8,16,null,!0),t.setDefaultFont(1)}var Kt="2.0.0-alpha.0",de=0,ye=!1,ue=[],ae=0;function Gt(){de++,ye=!0}function Ut(){de--,de===0&&Ce()}function Ce(){if(document.readyState!=="loading"&&de===0){ye=!1;let t=ue.slice();ue.length=0;for(let c of t)c()}else clearTimeout(ae),ae=setTimeout(Ce,10)}var K={version:Kt,_:{data:G,addCommand:ce,addCommands:Ae,addSetting:Ne,addPen:_e,addBlendCommand:je,parseOptions:oe,wait:Gt,resume:Ut},util:se};ce("ready",Ht,!1,!1,["fn"]);function Ht(t){let c=t[0];he(c)&&(ye?ue.push(c):document.readyState==="loading"?(ue.push(c),clearTimeout(ae),ae=setTimeout(Ce,10)):c())}ke(K);Fe(K);Me(K);Se(K);Pe(K);Re(K);Oe(K);Ve(K);Be(K);qe(K);ze(K);We(K);Ke(K);Ge(K);Ue(K);He(K);Ye(K);Te(K);G.commands.setDefaultPal([Ie]);G.commands.setDefaultColor([7]);Le(K);typeof window<"u"&&(window.pi=K,window.$===void 0&&(window.$=K));typeof window<"u"&&$e(K);var eo=K;})();
/**
 * Pi.js - Main Entry Point
 * 
 * Graphics and sound library for retro-style games and demos.
 * Modernized architecture with legacy API compatibility.
 * 
 * @module pi.js
 * @author Andy Stubbs
 * @license Apache-2.0
 */
//# sourceMappingURL=pi.min.js.map
