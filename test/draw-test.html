<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>DRAW Command Test</title>
	<style>
		body {
			margin: 0;
			padding: 20px;
			font-family: monospace;
			background: #222;
			color: #fff;
		}
		h1 {
			color: #4CAF50;
		}
		.info {
			background: #333;
			padding: 15px;
			border-radius: 5px;
			margin: 20px 0;
		}
		button {
			background: #4CAF50;
			color: white;
			border: none;
			padding: 10px 20px;
			margin: 5px;
			border-radius: 3px;
			cursor: pointer;
			font-family: monospace;
		}
		button:hover {
			background: #45a049;
		}
		canvas {
			display: block;
			margin: 20px 0;
		}
	</style>
</head>
<body>
	<h1>DRAW Command Test (QBasic-Style Turtle Graphics)</h1>
	<div id="container" style="width: 640px; height: 480px;"></div>

	<div class="info">
		<h3>DRAW Command Tests:</h3>
		<button id="square">Draw Square (U50 R50 D50 L50)</button>
		<button id="star">Draw Star</button>
		<button id="spiral">Draw Spiral</button>
		<button id="colorTest">Color Test</button>
		<button id="diagonal">Diagonal Moves (E/F/G/H)</button>
		<button id="blindMove">Blind Move (B)</button>
		<button id="turnAngle">Turn Angle (TA)</button>
		<button id="clear">Clear</button>
	</div>

	<div class="info">
		<h3>DRAW Command Syntax:</h3>
		<p><strong>U/D/L/R</strong> - Move Up/Down/Left/Right + number (pixels)</p>
		<p><strong>E/F/G/H</strong> - Move diagonally (NE/SE/SW/NW)</p>
		<p><strong>M x,y</strong> - Move to absolute position</p>
		<p><strong>C n</strong> - Change color (palette index)</p>
		<p><strong>C#RRGGBB</strong> - Change color (hex)</p>
		<p><strong>B</strong> - Blind move (don't draw next move)</p>
		<p><strong>N</strong> - Return to position after next move</p>
		<p><strong>TA n</strong> or <strong>T n</strong> - Turn angle (degrees)</p>
		<p><strong>P n</strong> - Paint/flood fill</p>
		<p><strong>A radius,start,end</strong> - Draw arc</p>
	</div>

	<script src="../build/pi.js"></script>
	<script>
		const $ = window.$ || window.pi;

		try {
			// Create screen
			const screen = $.screen( "640x480", "container" );
			screen.cls();
			screen.setColor( 15 );

			// Test 1: Square
			document.getElementById( "square" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 14 );

				// Move to starting position
				screen.draw( "M 100,100" );

				// Draw square using relative moves
				screen.draw( "U50 R50 D50 L50" );

				screen.render();
			} );

			// Test 2: Star
			document.getElementById( "star" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 11 );

				// Move to center
				screen.draw( "M 320,240" );

				// Draw 5-pointed star
				screen.draw( "TA 18 U100 TA 162 U100 TA 162 U100 TA 162 U100 TA 162 U100" );

				screen.render();
			} );

			// Test 3: Spiral
			document.getElementById( "spiral" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 10 );

				// Start at center
				screen.draw( "M 320,240" );

				// Draw expanding spiral
				let drawStr = "";
				for( let i = 1; i <= 20; i++ ) {
					const len = i * 5;
					drawStr += `U${len} R${len} D${len} L${len} `;
				}

				screen.draw( drawStr );
				screen.render();
			} );

			// Test 4: Color test
			document.getElementById( "colorTest" ).addEventListener( "click", () => {
				screen.cls();

				// Move to start
				screen.draw( "M 50,100" );

				// Draw lines with different colors
				screen.draw( "C14 R100" );  // Yellow
				screen.draw( "C12 D100" );  // Red
				screen.draw( "C10 L100" );  // Green
				screen.draw( "C9 U100" );   // Blue

				// Test hex color
				screen.draw( "M 300,100 C#FF00FF R100 D100 L100 U100" );

				screen.render();
			} );

			// Test 5: Diagonal moves
			document.getElementById( "diagonal" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 13 );

				// Move to center
				screen.draw( "M 320,240" );

				// Draw 8-directional lines
				screen.draw( "E50 N F50 N G50 N H50 N U50 N D50 N L50 N R50" );

				screen.render();
			} );

			// Test 6: Blind move
			document.getElementById( "blindMove" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 14 );

				// Start at left
				screen.draw( "M 100,240" );

				// Draw line, blind move, draw line
				screen.draw( "R100 B R50 R100" );

				screen.render();
			} );

			// Test 7: Turn angle
			document.getElementById( "turnAngle" ).addEventListener( "click", () => {
				screen.cls();
				screen.setColor( 11 );

				// Start at center
				screen.draw( "M 320,240" );

				// Draw with angle turns
				screen.draw( "TA 0 U50 TA 45 U50 TA 90 U50 TA 135 U50" );
				screen.draw( "TA 180 U50 TA 225 U50 TA 270 U50 TA 315 U50" );

				screen.render();
			} );

			// Clear button
			document.getElementById( "clear" ).addEventListener( "click", () => {
				screen.cls();
				screen.render();
			} );

			// Initial display
			screen.locate( 0, 0 );
			screen.print( "DRAW Command Test - QBasic Turtle Graphics", true, true );
			screen.locate( 2, 0 );
			screen.setColor( 11 );
			screen.print( "Click buttons above to test DRAW commands", false );

			// Draw a simple demo
			screen.setColor( 14 );
			screen.draw( "M 320,300" );
			screen.draw( "C14 U50 R50 D50 L50" );

			screen.render();

			console.log( "âœ… DRAW command initialized!" );
			console.log( "Try: screen.draw('U50 R50 D50 L50')" );

		} catch( e ) {
			document.body.innerHTML += `
				<div class="info" style="background: #f44336;">
					<strong>Error:</strong> ${e.message}
					<pre>${e.stack}</pre>
				</div>
			`;
			console.error( "Test failed:", e );
			throw e;
		}
	</script>
</body>
</html>

