<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pi.js Example Plugin Test (IIFE)</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 20px;
			background: linear-gradient( 135deg, #667eea 0%, #764ba2 100% );
			min-height: 100vh;
		}
		.container {
			max-width: 1200px;
			margin: 0 auto;
			background: white;
			border-radius: 12px;
			padding: 30px;
			box-shadow: 0 10px 40px rgba( 0, 0, 0, 0.3 );
		}
		h1 {
			color: #333;
			text-align: center;
			margin: 0 0 10px 0;
		}
		.subtitle {
			text-align: center;
			color: #666;
			margin-bottom: 30px;
		}
		.controls {
			display: grid;
			grid-template-columns: repeat( auto-fit, minmax( 200px, 1fr ) );
			gap: 10px;
			margin-bottom: 20px;
		}
		button {
			padding: 12px 20px;
			background: linear-gradient( 135deg, #667eea 0%, #764ba2 100% );
			color: white;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 14px;
			font-weight: bold;
			transition: transform 0.2s, box-shadow 0.2s;
		}
		button:hover {
			transform: translateY( -2px );
			box-shadow: 0 4px 12px rgba( 0, 0, 0, 0.2 );
		}
		button:active {
			transform: translateY( 0 );
		}
		#canvas-container {
			background: #000;
			border-radius: 8px;
			overflow: hidden;
			height: 500px;
			margin: 20px 0;
			box-shadow: 0 4px 12px rgba( 0, 0, 0, 0.2 );
		}
		.console {
			background: #1e1e1e;
			color: #d4d4d4;
			padding: 20px;
			border-radius: 8px;
			font-family: "Courier New", monospace;
			font-size: 13px;
			max-height: 300px;
			overflow-y: auto;
			white-space: pre-wrap;
		}
		.console .success { color: #4ec9b0; }
		.console .error { color: #f48771; }
		.console .info { color: #9cdcfe; }
		.console .command { color: #dcdcaa; }
	</style>
</head>
<body>
	<div class="container">
		<h1>üé® Pi.js Example Plugin</h1>
		<p class="subtitle">Testing plugin system with IIFE build (auto-registration)</p>
		
		<div class="controls">
			<button onclick="testHello()">üëã Say Hello</button>
			<button onclick="testLibraryInfo()">‚ÑπÔ∏è Library Info</button>
			<button onclick="testPluginList()">üì¶ Plugin List</button>
			<button onclick="drawCircle()">‚≠ï Draw Circle</button>
			<button onclick="drawMultipleCircles()">üéØ Draw Multiple</button>
			<button onclick="trackClick()">üñ±Ô∏è Track Click</button>
			<button onclick="animateCircles()">‚ú® Animate</button>
			<button onclick="clearScreen()">üßπ Clear</button>
		</div>
		
		<div id="canvas-container"></div>
		
		<div class="console" id="console"></div>
	</div>

	<!-- Load Pi.js IIFE build -->
	<script src="../build/pi.min.js"></script>
	
	<!-- Load Example Plugin IIFE build (auto-registers) -->
	<script src="../plugins/example-plugin/example-plugin.js"></script>

	<script>
		// Console output
		function log( message, type = "" ) {
			const console = document.getElementById( "console" );
			const className = type ? ` class="${type}"` : "";
			console.innerHTML += `<span${className}>${message}</span>\n`;
			console.scrollTop = console.scrollHeight;
		}
		
		// Initialize
		pi.ready( () => {
			pi.screen( {
				"aspect": "16:9",
				"container": "canvas-container"
			} );
			
			// Initial screen setup
			pi.color( 20, 20, 30 );
			pi.clear();
			
			pi.color( 100, 200, 255 );
			pi.print( "Pi.js Plugin System Demo", pi.width() / 2 - 110, pi.height() / 2 - 40 );
			pi.print( "Click buttons above to test", pi.width() / 2 - 110, pi.height() / 2 - 20 );
			pi.print( "plugin functionality", pi.width() / 2 - 85, pi.height() / 2 );
			
			log( "=".repeat( 60 ), "info" );
			log( "Pi.js initialized successfully!", "success" );
			log( `Screen size: ${pi.width()}x${pi.height()}`, "info" );
			log( "=".repeat( 60 ), "info" );
			log( "" );
		} );
		
		// Test functions
		function testHello() {
			log( "> pi.hello( \"Plugin User\" )", "command" );
			const result = pi.hello( "Plugin User" );
			log( `  ${result}`, "success" );
			log( "" );
		}
		
		function testLibraryInfo() {
			log( "> pi.getLibraryInfo()", "command" );
			const info = pi.getLibraryInfo();
			log( `  Version: ${info.version}`, "info" );
			log( `  Plugin System: ${info.pluginSystem}`, "info" );
			log( "" );
		}
		
		function testPluginList() {
			log( "> pi.getPlugins()", "command" );
			const plugins = pi.getPlugins();
			log( `  Found ${plugins.length} plugin(s):`, "success" );
			plugins.forEach( p => {
				log( `    - ${p.name} v${p.version}`, "info" );
				if( p.description ) {
					log( `      "${p.description}"`, "info" );
				}
			} );
			log( "" );
		}
		
		function drawCircle() {
			const x = pi.width() / 2;
			const y = pi.height() / 2;
			const r = 50 + Math.random() * 50;
			
			log( `> pi.drawRandomCircle( ${Math.floor( x )}, ${Math.floor( y )}, ${Math.floor( r )} )`, "command" );
			pi.drawRandomCircle( x, y, r );
			log( `  Drew circle with random color`, "success" );
			log( "" );
		}
		
		function drawMultipleCircles() {
			log( "> Drawing 15 random circles...", "command" );
			
			for( let i = 0; i < 15; i++ ) {
				const x = Math.random() * pi.width();
				const y = Math.random() * pi.height();
				const r = 10 + Math.random() * 40;
				pi.drawRandomCircle( x, y, r );
			}
			
			log( `  Drew 15 circles with random colors and sizes`, "success" );
			log( "" );
		}
		
		function trackClick() {
			const x = Math.floor( Math.random() * pi.width() );
			const y = Math.floor( Math.random() * pi.height() );
			
			log( `> pi.trackClick( ${x}, ${y} )`, "command" );
			const count = pi.trackClick( x, y );
			log( `  Click #${count} tracked at (${x}, ${y})`, "success" );
			log( "" );
		}
		
		function clearScreen() {
			log( "> pi.clear()", "command" );
			pi.color( 20, 20, 30 );
			pi.clear();
			
			pi.color( 100, 200, 255 );
			pi.print( "Screen Cleared!", pi.width() / 2 - 60, pi.height() / 2 );
			
			log( `  Screen cleared`, "success" );
			log( "" );
		}
		
		let animating = false;
		function animateCircles() {
			if( animating ) {
				return;
			}
			
			animating = true;
			log( "> Starting animation...", "command" );
			
			pi.color( 20, 20, 30 );
			pi.clear();
			
			let frame = 0;
			const maxFrames = 60;
			
			function animate() {
				if( frame >= maxFrames ) {
					animating = false;
					log( `  Animation complete (${maxFrames} frames)`, "success" );
					log( "" );
					return;
				}
				
				// Draw a circle
				const x = ( pi.width() / 2 ) + Math.cos( frame * 0.1 ) * 100;
				const y = ( pi.height() / 2 ) + Math.sin( frame * 0.1 ) * 100;
				const r = 20 + Math.sin( frame * 0.2 ) * 10;
				
				pi.drawRandomCircle( x, y, r );
				
				frame++;
				requestAnimationFrame( animate );
			}
			
			animate();
		}
	</script>
</body>
</html>

