<!DOCTYPE html>
<html>
	<head>
		<title>Screen No Container Test</title>
		<script type="text/toml">
			[[TOML_START]]
			file = "screen_comprehensive_02"
			name = "Screen Comprehensive Test 2"
			width = 800
			height = 600
			delay = 100
			[[TOML_END]]
		</script>
		<script src="../../../build/pi.js"></script>
		<style>
			html, body {
				background-color: #222;
				margin: 0;
				padding: 0;
			}
		</style>
	</head>
<body>
<script>
	$.ready( function () {

		let resizeCount = 0;

		// Test 1: Fullscreen with 4:3 aspect ratio and resize callback
		const s1 = $.screen( "4:3" );

		// Draw test pattern
		$.setColor( 12 );
		$.setFont( 1 );
		$.print( "No Container Tests" );
		$.print( "" );
		$.print( "1: Fullscreen 4:3" );
		$.print( "w=" + $.width() + " h=" + $.height() );
		
		// Draw border
		$.setColor( 11 );
		$.rect( 0, 0, $.width() - 1, $.height() - 1 );
		
		// Draw diagonal lines
		$.setColor( 14 );
		$.line( 0, 0, $.width() - 1, $.height() - 1 );
		$.line( $.width() - 1, 0, 0, $.height() - 1 );
		
		// Draw quarter markers
		$.setColor( 10 );
		const qw = Math.floor( $.width() / 4 );
		const qh = Math.floor( $.height() / 4 );
		for( let i = 1; i < 4; i++ ) {
			$.line( qw * i, 0, qw * i, 10 );
			$.line( qw * i, $.height() - 11, qw * i, $.height() - 1 );
			$.line( 0, qh * i, 10, qh * i );
			$.line( $.width() - 11, qh * i, $.width() - 1, qh * i );
		}
		
		// Test multiple render calls
		$.render();
		$.render(); // Second render should not cause issues
		
		// Test 2: Fullscreen without aspect ratio (fills viewport)
		const s2 = $.screen();

		// Set to transparent so background color so we can see other canvas
		s2.setBgColor( "rgba(0, 0, 0, 0)" );
		$.setColor( 9 );
		$.setFont( 1 );
		$.print( "2: Fullscreen no aspect" );
		$.print( "w=" + $.width() + " h=" + $.height() );
		$.print( "" );
		
		// Draw pattern
		$.setColor( 6 );
		for( let i = 0; i < $.width(); i += 40 ) {
			$.line( i, 0, i, $.height() - 1 );
		}
		for( let i = 0; i < $.height(); i += 40 ) {
			$.line( 0, i, $.width() - 1, i );
		}
		
		// Corner markers
		$.setColor( 13 );
		$.circle( 20, 20, 15 );
		$.circle( $.width() - 21, 20, 15 );
		$.circle( 20, $.height() - 21, 15 );
		$.circle( $.width() - 21, $.height() - 21, 15 );
		
		// Test 3: Multiple screens - switch back to first
		$.setScreen( s1 );
		$.setColor( 15 );
		$.setPos( $.width() / 2 - 30, $.height() / 2 - 8 );
		$.print( "Switched" );
		$.setPos( $.width() / 2 - 30, $.height() / 2 );
		$.print( "Back!" );
		
		// Draw center indicator
		$.setColor( 3 );
		$.circle( $.width() / 2, $.height() / 2, 50 );
		$.setColor( 0 );
		$.setPos( $.width() / 2 - 25, $.height() / 2 - 8 );
		$.print( "Switched" );
		$.setPos( $.width() / 2 - 15, $.height() / 2 );
		$.print( "Back!" );
		
		// Final render
		$.render();
	} );
</script>
</body>
</html>

