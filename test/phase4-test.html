<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Phase 4 - Pixel Drawing Test</title>
	<style>
		body {
			margin: 20px;
			font-family: monospace;
			background: #222;
			color: #fff;
		}
		h1 {
			color: #4CAF50;
		}
		.status {
			margin: 20px 0;
			padding: 15px;
			background: #333;
			border-radius: 5px;
		}
		canvas {
			border: 2px solid #4CAF50;
			margin: 20px 0;
		}
	</style>
</head>
<body>
	<h1>Phase 4: Pixel-Mode Drawing Test</h1>
	<div class="status" id="status">Loading Pi.js...</div>
	<div id="container"></div>

	<script src="../build/pi.js"></script>
	<script>
		const status = document.getElementById( "status" );

		try {
			// Use $ alias (pi.js loaded as IIFE)
			const $ = window.$;

			status.innerHTML = `
				<div>âœ“ Pi.js v${$.version} loaded</div>
				<div>âœ“ Using unminified build/pi.js for debugging</div>
				<div>Testing pixel-mode drawing commands...</div>
			`;

			// Set up a simple palette
			$.setDefaultPal( [
				"#000000", // 0 - black (transparent)
				"#FFFFFF", // 1 - white
				"#FF0000", // 2 - red
				"#00FF00", // 3 - green
				"#0000FF", // 4 - blue
				"#FFFF00", // 5 - yellow
				"#FF00FF", // 6 - magenta
				"#00FFFF"  // 7 - cyan
			] );

			// Create a test screen
			const screen = $.screen( "320x200", "container" );

			status.innerHTML += `<div>âœ“ Screen created: ${screen.width()}x${screen.height()}</div>`;

			// Clear screen
			screen.cls();
			status.innerHTML += `<div>âœ“ Screen cleared</div>`;

			// Draw some pixels
			screen.pset( 10, 10 );
			screen.pset( 11, 10 );
			screen.pset( 12, 10 );
			status.innerHTML += `<div>âœ“ Drew pixels</div>`;

			// Draw a line
			screen.line( 20, 20, 100, 80 );
			status.innerHTML += `<div>âœ“ Drew line (Bresenham algorithm)</div>`;

			// Draw another line
			screen.line( 100, 20, 20, 80 );

			// Draw diagonal lines
			screen.line( 0, 0, 319, 199 );
			screen.line( 0, 199, 319, 0 );

			// Draw a box
			screen.line( 150, 50, 250, 50 );
			screen.line( 250, 50, 250, 150 );
			screen.line( 250, 150, 150, 150 );
			screen.line( 150, 150, 150, 50 );

			status.innerHTML += `<div>âœ“ Drew multiple lines</div>`;

			// Draw a circle
			$.setDefaultColor( 7 ); // Cyan
			screen.circle( 200, 100, 30 );
			status.innerHTML += `<div>âœ“ Drew circle (Midpoint algorithm)</div>`;

			// Draw filled circle
			screen.circle( 100, 150, 20, 2 ); // Red fill
			status.innerHTML += `<div>âœ“ Drew filled circle</div>`;

			// Draw rectangles
			$.setDefaultColor( 5 ); // Yellow
			screen.rect( 230, 10, 80, 40 );
			status.innerHTML += `<div>âœ“ Drew rectangle</div>`;

			// Draw filled rectangle
			screen.rect( 230, 60, 80, 40, 4 ); // Blue fill
			status.innerHTML += `<div>âœ“ Drew filled rectangle</div>`;

			// Render to canvas
			screen.render();

			status.innerHTML += `
				<div style="color: #4CAF50; font-weight: bold; margin-top: 15px;">
					âœ“ Phase 4 Complete - Pixel-Mode Drawing Working!
				</div>
				<div style="margin-top: 10px;">
					Commands tested:
					<ul>
						<li>$.screen() - Create screen âœ“</li>
						<li>screen.cls() - Clear screen âœ“</li>
						<li>screen.pset() - Set pixel âœ“</li>
						<li>screen.line() - Bresenham line âœ“</li>
						<li>screen.circle() - Midpoint circle âœ“</li>
						<li>screen.circle() - Filled circle âœ“</li>
						<li>screen.rect() - Rectangle âœ“</li>
						<li>screen.rect() - Filled rectangle âœ“</li>
						<li>$.setDefaultPal() - Set palette âœ“</li>
						<li>$.setDefaultColor() - Set color âœ“</li>
						<li>screen.render() - Render to canvas âœ“</li>
					</ul>
				</div>
				<div style="margin-top: 10px; color: #FFC107;">
					ðŸŽ¨ Pixel-perfect retro graphics working!<br>
					All shapes use manual pixel algorithms (Bresenham, Midpoint)
				</div>
			`;

		} catch( e ) {
			status.innerHTML = `
				<div style="color: #f44336;">âœ— Error: ${e.message}</div>
				<pre style="color: #f44336;">${e.stack}</pre>
			`;
			console.error( e );
		}
	</script>
</body>
</html>
